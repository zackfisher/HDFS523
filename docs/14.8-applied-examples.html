<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>14.8 Applied Examples | HDFS 523: Strategies for Data Analysis in Developmental Research</title>
  <meta name="description" content="Course notes for HDFS 523" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="14.8 Applied Examples | HDFS 523: Strategies for Data Analysis in Developmental Research" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/images/image1.png" />
  <meta property="og:description" content="Course notes for HDFS 523" />
  <meta name="github-repo" content="zackfisher/HDFS523" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="14.8 Applied Examples | HDFS 523: Strategies for Data Analysis in Developmental Research" />
  
  <meta name="twitter:description" content="Course notes for HDFS 523" />
  <meta name="twitter:image" content="/images/image1.png" />

<meta name="author" content="Zachary F. Fisher" />


<meta name="date" content="2022-04-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="null" type="image/x-icon" />
<link rel="prev" href="14.7-issues-in-clustering.html"/>
<link rel="next" href="14.9-reference-1.html"/>
<script src="libs/header-attrs-2.11.15/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Course notes for HDFS 523</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About This Book<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="1.1-why-this-book.html"><a href="1.1-why-this-book.html"><i class="fa fa-check"></i><b>1.1</b> Why this book?<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="1.2-code-folding.html"><a href="1.2-code-folding.html"><i class="fa fa-check"></i><b>1.2</b> Code Folding<span></span></a></li>
<li class="chapter" data-level="1.3" data-path="1.3-acknowledgements.html"><a href="1.3-acknowledgements.html"><i class="fa fa-check"></i><b>1.3</b> Acknowledgements<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-chapter-2.html"><a href="2-chapter-2.html"><i class="fa fa-check"></i><b>2</b> Data Cleaning<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="2.1-example-data.html"><a href="2.1-example-data.html"><i class="fa fa-check"></i><b>2.1</b> Example Data<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="2.2-reading-in-repeated-measures-data.html"><a href="2.2-reading-in-repeated-measures-data.html"><i class="fa fa-check"></i><b>2.2</b> Reading in Repeated Measures Data<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="2.3-familiarize-yourself-with-the-data.html"><a href="2.3-familiarize-yourself-with-the-data.html"><i class="fa fa-check"></i><b>2.3</b> Familiarize Yourself with the Data<span></span></a></li>
<li class="chapter" data-level="2.4" data-path="2.4-look-for-duplicated-ids.html"><a href="2.4-look-for-duplicated-ids.html"><i class="fa fa-check"></i><b>2.4</b> Look for Duplicated IDs<span></span></a></li>
<li class="chapter" data-level="2.5" data-path="2.5-using-table-to-spot-irregularities.html"><a href="2.5-using-table-to-spot-irregularities.html"><i class="fa fa-check"></i><b>2.5</b> Using <code>table()</code> to Spot Irregularities<span></span></a></li>
<li class="chapter" data-level="2.6" data-path="2.6-missing-data.html"><a href="2.6-missing-data.html"><i class="fa fa-check"></i><b>2.6</b> Missing Data<span></span></a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="2.6-missing-data.html"><a href="2.6-missing-data.html#generating-example-data"><i class="fa fa-check"></i><b>2.6.1</b> Generating Example Data<span></span></a></li>
<li class="chapter" data-level="2.6.2" data-path="2.6-missing-data.html"><a href="2.6-missing-data.html#recoding-values-with-na"><i class="fa fa-check"></i><b>2.6.2</b> Recoding Values with <code>NA</code><span></span></a></li>
<li class="chapter" data-level="2.6.3" data-path="2.6-missing-data.html"><a href="2.6-missing-data.html#missing-data-visualization"><i class="fa fa-check"></i><b>2.6.3</b> Missing Data Visualization<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="2.7-exporting-data.html"><a href="2.7-exporting-data.html"><i class="fa fa-check"></i><b>2.7</b> Exporting Data<span></span></a></li>
<li class="chapter" data-level="2.8" data-path="2.8-reshaping-repeated-measures-data.html"><a href="2.8-reshaping-repeated-measures-data.html"><i class="fa fa-check"></i><b>2.8</b> Reshaping Repeated Measures Data<span></span></a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="2.8-reshaping-repeated-measures-data.html"><a href="2.8-reshaping-repeated-measures-data.html#reshape-wide-to-long"><i class="fa fa-check"></i><b>2.8.1</b> Reshape Wide to Long<span></span></a></li>
<li class="chapter" data-level="2.8.2" data-path="2.8-reshaping-repeated-measures-data.html"><a href="2.8-reshaping-repeated-measures-data.html#reshape-long-to-wide"><i class="fa fa-check"></i><b>2.8.2</b> Reshape Long to Wide<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-chapter-3.html"><a href="3-chapter-3.html"><i class="fa fa-check"></i><b>3</b> Describing Longitudinal Data<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="3.1-example-data-1.html"><a href="3.1-example-data-1.html"><i class="fa fa-check"></i><b>3.1</b> Example Data<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="3.2-describing-means-and-variances.html"><a href="3.2-describing-means-and-variances.html"><i class="fa fa-check"></i><b>3.2</b> Describing Means and Variances<span></span></a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="3.2-describing-means-and-variances.html"><a href="3.2-describing-means-and-variances.html#verbal-ability-all-persons-and-occasions"><i class="fa fa-check"></i><b>3.2.1</b> Verbal Ability (All Persons and Occasions)<span></span></a></li>
<li class="chapter" data-level="3.2.2" data-path="3.2-describing-means-and-variances.html"><a href="3.2-describing-means-and-variances.html#verbal-ability-across-time"><i class="fa fa-check"></i><b>3.2.2</b> Verbal Ability (Across Time)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="3.3-describing-covariances.html"><a href="3.3-describing-covariances.html"><i class="fa fa-check"></i><b>3.3</b> Describing Covariances<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="3.4-individual-level-descriptives.html"><a href="3.4-individual-level-descriptives.html"><i class="fa fa-check"></i><b>3.4</b> Individual-Level Descriptives<span></span></a></li>
<li class="chapter" data-level="3.5" data-path="3.5-references.html"><a href="3.5-references.html"><i class="fa fa-check"></i><b>3.5</b> References<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-chapter-4.html"><a href="4-chapter-4.html"><i class="fa fa-check"></i><b>4</b> Matrix Algebra<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="4.1-types-of-matrices.html"><a href="4.1-types-of-matrices.html"><i class="fa fa-check"></i><b>4.1</b> Types of matrices<span></span></a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="4.1-types-of-matrices.html"><a href="4.1-types-of-matrices.html#square"><i class="fa fa-check"></i><b>4.1.1</b> Square<span></span></a></li>
<li class="chapter" data-level="4.1.2" data-path="4.1-types-of-matrices.html"><a href="4.1-types-of-matrices.html#symmetric"><i class="fa fa-check"></i><b>4.1.2</b> Symmetric<span></span></a></li>
<li class="chapter" data-level="4.1.3" data-path="4.1-types-of-matrices.html"><a href="4.1-types-of-matrices.html#diagonal"><i class="fa fa-check"></i><b>4.1.3</b> Diagonal<span></span></a></li>
<li class="chapter" data-level="4.1.4" data-path="4.1-types-of-matrices.html"><a href="4.1-types-of-matrices.html#identity"><i class="fa fa-check"></i><b>4.1.4</b> Identity<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="4.2-operations-on-matrices.html"><a href="4.2-operations-on-matrices.html"><i class="fa fa-check"></i><b>4.2</b> Operations on Matrices<span></span></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="4.2-operations-on-matrices.html"><a href="4.2-operations-on-matrices.html#matrix-transpose"><i class="fa fa-check"></i><b>4.2.1</b> Matrix Transpose<span></span></a></li>
<li class="chapter" data-level="4.2.2" data-path="4.2-operations-on-matrices.html"><a href="4.2-operations-on-matrices.html#matrix-trace"><i class="fa fa-check"></i><b>4.2.2</b> Matrix Trace<span></span></a></li>
<li class="chapter" data-level="4.2.3" data-path="4.2-operations-on-matrices.html"><a href="4.2-operations-on-matrices.html#addition"><i class="fa fa-check"></i><b>4.2.3</b> Addition<span></span></a></li>
<li class="chapter" data-level="4.2.4" data-path="4.2-operations-on-matrices.html"><a href="4.2-operations-on-matrices.html#subtraction"><i class="fa fa-check"></i><b>4.2.4</b> Subtraction<span></span></a></li>
<li class="chapter" data-level="4.2.5" data-path="4.2-operations-on-matrices.html"><a href="4.2-operations-on-matrices.html#matrix-multiplication"><i class="fa fa-check"></i><b>4.2.5</b> Matrix Multiplication<span></span></a></li>
<li class="chapter" data-level="4.2.6" data-path="4.2-operations-on-matrices.html"><a href="4.2-operations-on-matrices.html#matrix-division"><i class="fa fa-check"></i><b>4.2.6</b> Matrix Division<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-chapter-5.html"><a href="5-chapter-5.html"><i class="fa fa-check"></i><b>5</b> Ordinary Least Squares<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="5.1-linear-regression-model.html"><a href="5.1-linear-regression-model.html"><i class="fa fa-check"></i><b>5.1</b> Linear Regression Model<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="5.2-ordinary-least-squares-ols.html"><a href="5.2-ordinary-least-squares-ols.html"><i class="fa fa-check"></i><b>5.2</b> Ordinary Least Squares (OLS)<span></span></a></li>
<li class="chapter" data-level="5.3" data-path="5.3-assumptions-of-ols.html"><a href="5.3-assumptions-of-ols.html"><i class="fa fa-check"></i><b>5.3</b> Assumptions of OLS<span></span></a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="5.3-assumptions-of-ols.html"><a href="5.3-assumptions-of-ols.html#assumption-1.-mathbbeepsilon_i-0"><i class="fa fa-check"></i><b>5.3.1</b> Assumption 1. <span class="math inline">\(\mathbb{E}(\epsilon_{i}) = 0\)</span><span></span></a></li>
<li class="chapter" data-level="5.3.2" data-path="5.3-assumptions-of-ols.html"><a href="5.3-assumptions-of-ols.html#assumption-2.-homoscedasticity"><i class="fa fa-check"></i><b>5.3.2</b> Assumption 2. Homoscedasticity<span></span></a></li>
<li class="chapter" data-level="5.3.3" data-path="5.3-assumptions-of-ols.html"><a href="5.3-assumptions-of-ols.html#mathbbeepsilon_iepsilon_j-0"><i class="fa fa-check"></i><b>5.3.3</b> 3. <span class="math inline">\(\mathbb{E}(\epsilon_{i}\epsilon_{j}) = 0\)</span><span></span></a></li>
<li class="chapter" data-level="5.3.4" data-path="5.3-assumptions-of-ols.html"><a href="5.3-assumptions-of-ols.html#no-perfect-collinearity"><i class="fa fa-check"></i><b>5.3.4</b> 4. No Perfect Collinearity<span></span></a></li>
<li class="chapter" data-level="5.3.5" data-path="5.3-assumptions-of-ols.html"><a href="5.3-assumptions-of-ols.html#mathbbcepsilon_ix_ki-0"><i class="fa fa-check"></i><b>5.3.5</b> 5. <span class="math inline">\(\mathbb{C}(\epsilon_{i},x_{ki}) = 0\)</span><span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="5.4-properties-of-the-ols-estimator.html"><a href="5.4-properties-of-the-ols-estimator.html"><i class="fa fa-check"></i><b>5.4</b> Properties of the OLS Estimator<span></span></a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="5.4-properties-of-the-ols-estimator.html"><a href="5.4-properties-of-the-ols-estimator.html#consistentcy-of-boldsymbolbeta"><i class="fa fa-check"></i><b>5.4.1</b> 1. Consistentcy of <span class="math inline">\(\boldsymbol{{\beta}}\)</span><span></span></a></li>
<li class="chapter" data-level="5.4.2" data-path="5.4-properties-of-the-ols-estimator.html"><a href="5.4-properties-of-the-ols-estimator.html#asymptotic-normality"><i class="fa fa-check"></i><b>5.4.2</b> 2. Asymptotic Normality<span></span></a></li>
<li class="chapter" data-level="5.4.3" data-path="5.4-properties-of-the-ols-estimator.html"><a href="5.4-properties-of-the-ols-estimator.html#variance-of-hatbeta"><i class="fa fa-check"></i><b>5.4.3</b> Variance of <span class="math inline">\(\hat{\beta}\)</span><span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="5.5-failure-to-meet-assumptions.html"><a href="5.5-failure-to-meet-assumptions.html"><i class="fa fa-check"></i><b>5.5</b> Failure to Meet Assumptions<span></span></a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="5.5-failure-to-meet-assumptions.html"><a href="5.5-failure-to-meet-assumptions.html#failure-of-assumption-1."><i class="fa fa-check"></i><b>5.5.1</b> Failure of Assumption 1.<span></span></a></li>
<li class="chapter" data-level="5.5.2" data-path="5.5-failure-to-meet-assumptions.html"><a href="5.5-failure-to-meet-assumptions.html#failure-of-assumption-2-or-3."><i class="fa fa-check"></i><b>5.5.2</b> Failure of Assumption 2 or 3.<span></span></a></li>
<li class="chapter" data-level="5.5.3" data-path="5.5-failure-to-meet-assumptions.html"><a href="5.5-failure-to-meet-assumptions.html#failure-of-assumption-5."><i class="fa fa-check"></i><b>5.5.3</b> Failure of Assumption 5.<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="5.6-regression-and-matrix-notation.html"><a href="5.6-regression-and-matrix-notation.html"><i class="fa fa-check"></i><b>5.6</b> Regression and Matrix Notation<span></span></a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="5.6-regression-and-matrix-notation.html"><a href="5.6-regression-and-matrix-notation.html#an-intercept-only-model"><i class="fa fa-check"></i><b>5.6.1</b> An Intercept-Only Model<span></span></a></li>
<li class="chapter" data-level="5.6.2" data-path="5.6-regression-and-matrix-notation.html"><a href="5.6-regression-and-matrix-notation.html#intercept-only-model-in-matrix-form"><i class="fa fa-check"></i><b>5.6.2</b> Intercept-Only Model in Matrix Form<span></span></a></li>
<li class="chapter" data-level="5.6.3" data-path="5.6-regression-and-matrix-notation.html"><a href="5.6-regression-and-matrix-notation.html#simple-regression-in-matrix-form"><i class="fa fa-check"></i><b>5.6.3</b> Simple Regression in Matrix Form<span></span></a></li>
<li class="chapter" data-level="5.6.4" data-path="5.6-regression-and-matrix-notation.html"><a href="5.6-regression-and-matrix-notation.html#multiple-regression-in-matrix-form"><i class="fa fa-check"></i><b>5.6.4</b> Multiple Regression in Matrix Form<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="5.7-solving-the-regression-equation.html"><a href="5.7-solving-the-regression-equation.html"><i class="fa fa-check"></i><b>5.7</b> Solving the Regression Equation<span></span></a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="5.7-solving-the-regression-equation.html"><a href="5.7-solving-the-regression-equation.html#matrix-multiplication-and-transpose"><i class="fa fa-check"></i><b>5.7.1</b> Matrix Multiplication and Transpose<span></span></a></li>
<li class="chapter" data-level="5.7.2" data-path="5.7-solving-the-regression-equation.html"><a href="5.7-solving-the-regression-equation.html#matrix-inverse"><i class="fa fa-check"></i><b>5.7.2</b> Matrix Inverse<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="5.8-the-linear-probability-model.html"><a href="5.8-the-linear-probability-model.html"><i class="fa fa-check"></i><b>5.8</b> The Linear Probability Model<span></span></a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="5.8-the-linear-probability-model.html"><a href="5.8-the-linear-probability-model.html#advantages-of-the-lpm"><i class="fa fa-check"></i><b>5.8.1</b> Advantages of the LPM<span></span></a></li>
<li class="chapter" data-level="5.8.2" data-path="5.8-the-linear-probability-model.html"><a href="5.8-the-linear-probability-model.html#disadvantages-of-the-lpm"><i class="fa fa-check"></i><b>5.8.2</b> Disadvantages of the LPM<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-chapter-6.html"><a href="6-chapter-6.html"><i class="fa fa-check"></i><b>6</b> Linear Regression<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="6.1-example-data-2.html"><a href="6.1-example-data-2.html"><i class="fa fa-check"></i><b>6.1</b> Example Data<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="6.2-intercept-only-model.html"><a href="6.2-intercept-only-model.html"><i class="fa fa-check"></i><b>6.2</b> Intercept-Only Model<span></span></a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="6.2-intercept-only-model.html"><a href="6.2-intercept-only-model.html#intercept-only-equation"><i class="fa fa-check"></i><b>6.2.1</b> Intercept-Only Equation<span></span></a></li>
<li class="chapter" data-level="6.2.2" data-path="6.2-intercept-only-model.html"><a href="6.2-intercept-only-model.html#intercept-only-model-in-r"><i class="fa fa-check"></i><b>6.2.2</b> Intercept-Only Model in R<span></span></a></li>
<li class="chapter" data-level="6.2.3" data-path="6.2-intercept-only-model.html"><a href="6.2-intercept-only-model.html#intercept-as-mean-of-outcome"><i class="fa fa-check"></i><b>6.2.3</b> Intercept as Mean of Outcome<span></span></a></li>
<li class="chapter" data-level="6.2.4" data-path="6.2-intercept-only-model.html"><a href="6.2-intercept-only-model.html#intercept-only-model-r2"><i class="fa fa-check"></i><b>6.2.4</b> Intercept-Only Model <span class="math inline">\(R^2\)</span><span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="6.3-simple-linear-regression.html"><a href="6.3-simple-linear-regression.html"><i class="fa fa-check"></i><b>6.3</b> Simple Linear Regression<span></span></a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="6.3-simple-linear-regression.html"><a href="6.3-simple-linear-regression.html#regression-equation-and-model-fitting"><i class="fa fa-check"></i><b>6.3.1</b> Regression Equation and Model Fitting<span></span></a></li>
<li class="chapter" data-level="6.3.2" data-path="6.3-simple-linear-regression.html"><a href="6.3-simple-linear-regression.html#path-diagram"><i class="fa fa-check"></i><b>6.3.2</b> Path Diagram<span></span></a></li>
<li class="chapter" data-level="6.3.3" data-path="6.3-simple-linear-regression.html"><a href="6.3-simple-linear-regression.html#interpreting-model-parameters"><i class="fa fa-check"></i><b>6.3.3</b> Interpreting Model Parameters<span></span></a></li>
<li class="chapter" data-level="6.3.4" data-path="6.3-simple-linear-regression.html"><a href="6.3-simple-linear-regression.html#plotting-regression-line"><i class="fa fa-check"></i><b>6.3.4</b> Plotting Regression Line<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="6.4-mean-centering-predictors.html"><a href="6.4-mean-centering-predictors.html"><i class="fa fa-check"></i><b>6.4</b> Mean Centering Predictors<span></span></a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="6.4-mean-centering-predictors.html"><a href="6.4-mean-centering-predictors.html#interpreting-model-parameters-1"><i class="fa fa-check"></i><b>6.4.1</b> Interpreting Model Parameters<span></span></a></li>
<li class="chapter" data-level="6.4.2" data-path="6.4-mean-centering-predictors.html"><a href="6.4-mean-centering-predictors.html#plotting-regression-line-1"><i class="fa fa-check"></i><b>6.4.2</b> Plotting Regression Line<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="6.5-multiple-linear-regression.html"><a href="6.5-multiple-linear-regression.html"><i class="fa fa-check"></i><b>6.5</b> Multiple Linear Regression<span></span></a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="6.5-multiple-linear-regression.html"><a href="6.5-multiple-linear-regression.html#regression-equation"><i class="fa fa-check"></i><b>6.5.1</b> Regression Equation<span></span></a></li>
<li class="chapter" data-level="6.5.2" data-path="6.5-multiple-linear-regression.html"><a href="6.5-multiple-linear-regression.html#fit-model-in-r"><i class="fa fa-check"></i><b>6.5.2</b> Fit Model in R<span></span></a></li>
<li class="chapter" data-level="6.5.3" data-path="6.5-multiple-linear-regression.html"><a href="6.5-multiple-linear-regression.html#path-diagram-1"><i class="fa fa-check"></i><b>6.5.3</b> Path Diagram<span></span></a></li>
<li class="chapter" data-level="6.5.4" data-path="6.5-multiple-linear-regression.html"><a href="6.5-multiple-linear-regression.html#a-note-on-interpretation"><i class="fa fa-check"></i><b>6.5.4</b> A Note on Interpretation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="6.6-categorical-variable-interaction.html"><a href="6.6-categorical-variable-interaction.html"><i class="fa fa-check"></i><b>6.6</b> Categorical Variable Interaction<span></span></a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="6.6-categorical-variable-interaction.html"><a href="6.6-categorical-variable-interaction.html#interaction-as-moderation"><i class="fa fa-check"></i><b>6.6.1</b> Interaction as Moderation<span></span></a></li>
<li class="chapter" data-level="6.6.2" data-path="6.6-categorical-variable-interaction.html"><a href="6.6-categorical-variable-interaction.html#moderation-by-categorical-variable"><i class="fa fa-check"></i><b>6.6.2</b> Moderation by Categorical Variable<span></span></a></li>
<li class="chapter" data-level="6.6.3" data-path="6.6-categorical-variable-interaction.html"><a href="6.6-categorical-variable-interaction.html#interpretation"><i class="fa fa-check"></i><b>6.6.3</b> Interpretation<span></span></a></li>
<li class="chapter" data-level="6.6.4" data-path="6.6-categorical-variable-interaction.html"><a href="6.6-categorical-variable-interaction.html#fit-regression-model-in-r"><i class="fa fa-check"></i><b>6.6.4</b> Fit Regression Model in R<span></span></a></li>
<li class="chapter" data-level="6.6.5" data-path="6.6-categorical-variable-interaction.html"><a href="6.6-categorical-variable-interaction.html#path-diagram-2"><i class="fa fa-check"></i><b>6.6.5</b> Path Diagram<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-chapter-7.html"><a href="7-chapter-7.html"><i class="fa fa-check"></i><b>7</b> Logistic Regression<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="7.1-categorical-data-in-the-social-sciences.html"><a href="7.1-categorical-data-in-the-social-sciences.html"><i class="fa fa-check"></i><b>7.1</b> Categorical Data in the Social Sciences<span></span></a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="7.1-categorical-data-in-the-social-sciences.html"><a href="7.1-categorical-data-in-the-social-sciences.html#examples-of-categorical-data"><i class="fa fa-check"></i><b>7.1.1</b> Examples of Categorical Data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="7.2-introduction-to-glms.html"><a href="7.2-introduction-to-glms.html"><i class="fa fa-check"></i><b>7.2</b> Introduction to GLMs<span></span></a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="7.2-introduction-to-glms.html"><a href="7.2-introduction-to-glms.html#linear-regression-as-glm"><i class="fa fa-check"></i><b>7.2.1</b> Linear Regression as GLM<span></span></a></li>
<li class="chapter" data-level="7.2.2" data-path="7.2-introduction-to-glms.html"><a href="7.2-introduction-to-glms.html#logistic-regression-as-glm"><i class="fa fa-check"></i><b>7.2.2</b> Logistic Regression as GLM<span></span></a></li>
<li class="chapter" data-level="7.2.3" data-path="7.2-introduction-to-glms.html"><a href="7.2-introduction-to-glms.html#poisson-regression-as-glm"><i class="fa fa-check"></i><b>7.2.3</b> Poisson Regression as GLM<span></span></a></li>
<li class="chapter" data-level="7.2.4" data-path="7.2-introduction-to-glms.html"><a href="7.2-introduction-to-glms.html#additional-remarks"><i class="fa fa-check"></i><b>7.2.4</b> Additional Remarks<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="7.3-binary-logistic-regression.html"><a href="7.3-binary-logistic-regression.html"><i class="fa fa-check"></i><b>7.3</b> Binary Logistic Regression<span></span></a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="7.3-binary-logistic-regression.html"><a href="7.3-binary-logistic-regression.html#overcoming-lpm"><i class="fa fa-check"></i><b>7.3.1</b> Overcoming LPM<span></span></a></li>
<li class="chapter" data-level="7.3.2" data-path="7.3-binary-logistic-regression.html"><a href="7.3-binary-logistic-regression.html#model"><i class="fa fa-check"></i><b>7.3.2</b> Model<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="7.4-example-data-3.html"><a href="7.4-example-data-3.html"><i class="fa fa-check"></i><b>7.4</b> Example Data<span></span></a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="7.4-example-data-3.html"><a href="7.4-example-data-3.html#variables"><i class="fa fa-check"></i><b>7.4.1</b> Variables<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="7.5-intercept-only-model-1.html"><a href="7.5-intercept-only-model-1.html"><i class="fa fa-check"></i><b>7.5</b> Intercept-Only Model<span></span></a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="7.5-intercept-only-model-1.html"><a href="7.5-intercept-only-model-1.html#intercept-only-model-in-r-1"><i class="fa fa-check"></i><b>7.5.1</b> Intercept-Only Model in R<span></span></a></li>
<li class="chapter" data-level="7.5.2" data-path="7.5-intercept-only-model-1.html"><a href="7.5-intercept-only-model-1.html#interpretation-1"><i class="fa fa-check"></i><b>7.5.2</b> Interpretation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="7.6-single-predictor-model.html"><a href="7.6-single-predictor-model.html"><i class="fa fa-check"></i><b>7.6</b> Single Predictor Model<span></span></a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="7.6-single-predictor-model.html"><a href="7.6-single-predictor-model.html#overdispersion"><i class="fa fa-check"></i><b>7.6.1</b> Overdispersion<span></span></a></li>
<li class="chapter" data-level="7.6.2" data-path="7.6-single-predictor-model.html"><a href="7.6-single-predictor-model.html#coefficients"><i class="fa fa-check"></i><b>7.6.2</b> Coefficients<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="7.7-marginal-effects.html"><a href="7.7-marginal-effects.html"><i class="fa fa-check"></i><b>7.7</b> Marginal Effects<span></span></a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="7.7-marginal-effects.html"><a href="7.7-marginal-effects.html#a-definition-of-marginal-effects"><i class="fa fa-check"></i><b>7.7.1</b> A Definition of Marginal Effects<span></span></a></li>
<li class="chapter" data-level="7.7.2" data-path="7.7-marginal-effects.html"><a href="7.7-marginal-effects.html#a-few-observations"><i class="fa fa-check"></i><b>7.7.2</b> A Few Observations<span></span></a></li>
<li class="chapter" data-level="7.7.3" data-path="7.7-marginal-effects.html"><a href="7.7-marginal-effects.html#types-of-marginal-effects"><i class="fa fa-check"></i><b>7.7.3</b> Types of Marginal Effects<span></span></a></li>
<li class="chapter" data-level="7.7.4" data-path="7.7-marginal-effects.html"><a href="7.7-marginal-effects.html#example-model"><i class="fa fa-check"></i><b>7.7.4</b> Example Model<span></span></a></li>
<li class="chapter" data-level="7.7.5" data-path="7.7-marginal-effects.html"><a href="7.7-marginal-effects.html#marginal-effects-at-representative-values-mer"><i class="fa fa-check"></i><b>7.7.5</b> Marginal Effects at Representative Values (MER)<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-chapter-8.html"><a href="8-chapter-8.html"><i class="fa fa-check"></i><b>8</b> Poisson Regression<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="8.1-poisson-regression.html"><a href="8.1-poisson-regression.html"><i class="fa fa-check"></i><b>8.1</b> Poisson Regression<span></span></a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="8.1-poisson-regression.html"><a href="8.1-poisson-regression.html#poisson-regression-as-glm-1"><i class="fa fa-check"></i><b>8.1.1</b> Poisson Regression as GLM<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="8.2-poisson-distribution.html"><a href="8.2-poisson-distribution.html"><i class="fa fa-check"></i><b>8.2</b> Poisson Distribution<span></span></a></li>
<li class="chapter" data-level="8.3" data-path="8.3-notes-on-interpretation.html"><a href="8.3-notes-on-interpretation.html"><i class="fa fa-check"></i><b>8.3</b> Notes on Interpretation<span></span></a></li>
<li class="chapter" data-level="8.4" data-path="8.4-example-data-4.html"><a href="8.4-example-data-4.html"><i class="fa fa-check"></i><b>8.4</b> Example Data<span></span></a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="8.4-example-data-4.html"><a href="8.4-example-data-4.html#dependent-variable"><i class="fa fa-check"></i><b>8.4.1</b> Dependent variable<span></span></a></li>
<li class="chapter" data-level="8.4.2" data-path="8.4-example-data-4.html"><a href="8.4-example-data-4.html#explanatory-variables"><i class="fa fa-check"></i><b>8.4.2</b> Explanatory Variables<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="8.5-single-predictor-model-1.html"><a href="8.5-single-predictor-model-1.html"><i class="fa fa-check"></i><b>8.5</b> Single Predictor Model<span></span></a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="8.5-single-predictor-model-1.html"><a href="8.5-single-predictor-model-1.html#deviance-and-goodness-of-fit"><i class="fa fa-check"></i><b>8.5.1</b> Deviance and Goodness of Fit<span></span></a></li>
<li class="chapter" data-level="8.5.2" data-path="8.5-single-predictor-model-1.html"><a href="8.5-single-predictor-model-1.html#interpretation-2"><i class="fa fa-check"></i><b>8.5.2</b> Interpretation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="8.6-multiple-predictor-model.html"><a href="8.6-multiple-predictor-model.html"><i class="fa fa-check"></i><b>8.6</b> Multiple Predictor Model<span></span></a></li>
<li class="chapter" data-level="8.7" data-path="8.7-revisisting-overdispersion.html"><a href="8.7-revisisting-overdispersion.html"><i class="fa fa-check"></i><b>8.7</b> Revisisting Overdispersion<span></span></a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="8.7-revisisting-overdispersion.html"><a href="8.7-revisisting-overdispersion.html#quassi-poisson-family"><i class="fa fa-check"></i><b>8.7.1</b> Quassi-Poisson Family<span></span></a></li>
<li class="chapter" data-level="8.7.2" data-path="8.7-revisisting-overdispersion.html"><a href="8.7-revisisting-overdispersion.html#negative-binomial-regression"><i class="fa fa-check"></i><b>8.7.2</b> Negative Binomial Regression<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-chapter-9.html"><a href="9-chapter-9.html"><i class="fa fa-check"></i><b>9</b> Two-Occassion change<span></span></a>
<ul>
<li class="chapter" data-level="9.1" data-path="9.1-example-data-5.html"><a href="9.1-example-data-5.html"><i class="fa fa-check"></i><b>9.1</b> Example Data<span></span></a></li>
<li class="chapter" data-level="9.2" data-path="9.2-inroduction.html"><a href="9.2-inroduction.html"><i class="fa fa-check"></i><b>9.2</b> Inroduction<span></span></a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="9.2-inroduction.html"><a href="9.2-inroduction.html#a-thought-experiment"><i class="fa fa-check"></i><b>9.2.1</b> A Thought Experiment<span></span></a></li>
<li class="chapter" data-level="9.2.2" data-path="9.2-inroduction.html"><a href="9.2-inroduction.html#examples-of-equivalent-models"><i class="fa fa-check"></i><b>9.2.2</b> Examples of Equivalent Models<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="9.3-residualized-change.html"><a href="9.3-residualized-change.html"><i class="fa fa-check"></i><b>9.3</b> Residualized Change<span></span></a></li>
<li class="chapter" data-level="9.4" data-path="9.4-raw-change.html"><a href="9.4-raw-change.html"><i class="fa fa-check"></i><b>9.4</b> Raw Change<span></span></a></li>
<li class="chapter" data-level="9.5" data-path="9.5-autoregressive-models.html"><a href="9.5-autoregressive-models.html"><i class="fa fa-check"></i><b>9.5</b> Autoregressive Models<span></span></a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="9.5-autoregressive-models.html"><a href="9.5-autoregressive-models.html#autoregressive-residuals"><i class="fa fa-check"></i><b>9.5.1</b> Autoregressive Residuals<span></span></a></li>
<li class="chapter" data-level="9.5.2" data-path="9.5-autoregressive-models.html"><a href="9.5-autoregressive-models.html#autoregressive-model-in-r"><i class="fa fa-check"></i><b>9.5.2</b> Autoregressive Model in R<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="9.6-difference-score-model.html"><a href="9.6-difference-score-model.html"><i class="fa fa-check"></i><b>9.6</b> Difference Score Model<span></span></a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="9.6-difference-score-model.html"><a href="9.6-difference-score-model.html#calculating-difference-scores"><i class="fa fa-check"></i><b>9.6.1</b> Calculating Difference Scores<span></span></a></li>
<li class="chapter" data-level="9.6.2" data-path="9.6-difference-score-model.html"><a href="9.6-difference-score-model.html#comparison-to-residualized-change"><i class="fa fa-check"></i><b>9.6.2</b> Comparison to Residualized Change<span></span></a></li>
<li class="chapter" data-level="9.6.3" data-path="9.6-difference-score-model.html"><a href="9.6-difference-score-model.html#a-difference-score-regression-model"><i class="fa fa-check"></i><b>9.6.3</b> A Difference Score Regression Model<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="9.7-critique-of-residualized-change.html"><a href="9.7-critique-of-residualized-change.html"><i class="fa fa-check"></i><b>9.7</b> Critique of Residualized Change<span></span></a></li>
<li class="chapter" data-level="9.8" data-path="9.8-critique-of-difference-scores.html"><a href="9.8-critique-of-difference-scores.html"><i class="fa fa-check"></i><b>9.8</b> Critique of Difference Scores<span></span></a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="9.8-critique-of-difference-scores.html"><a href="9.8-critique-of-difference-scores.html#alternative-interpretation"><i class="fa fa-check"></i><b>9.8.1</b> Alternative Interpretation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="9.9-comparing-models.html"><a href="9.9-comparing-models.html"><i class="fa fa-check"></i><b>9.9</b> Comparing Models<span></span></a></li>
<li class="chapter" data-level="9.10" data-path="9.10-closing-thoughts.html"><a href="9.10-closing-thoughts.html"><i class="fa fa-check"></i><b>9.10</b> Closing Thoughts<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-chapter-10.html"><a href="10-chapter-10.html"><i class="fa fa-check"></i><b>10</b> Introduction to Growth<span></span></a>
<ul>
<li class="chapter" data-level="10.1" data-path="10.1-example-data-6.html"><a href="10.1-example-data-6.html"><i class="fa fa-check"></i><b>10.1</b> Example Data<span></span></a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="10.1-example-data-6.html"><a href="10.1-example-data-6.html#data-preparation-and-description"><i class="fa fa-check"></i><b>10.1.1</b> Data Preparation and Description<span></span></a></li>
<li class="chapter" data-level="10.1.2" data-path="10.1-example-data-6.html"><a href="10.1-example-data-6.html#sample-moments"><i class="fa fa-check"></i><b>10.1.2</b> Sample Moments<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="10.2-a-general-model.html"><a href="10.2-a-general-model.html"><i class="fa fa-check"></i><b>10.2</b> A General Model<span></span></a></li>
<li class="chapter" data-level="10.3" data-path="10.3-unconditional-means-model.html"><a href="10.3-unconditional-means-model.html"><i class="fa fa-check"></i><b>10.3</b> Unconditional Means Model<span></span></a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="10.3-unconditional-means-model.html"><a href="10.3-unconditional-means-model.html#leve-l"><i class="fa fa-check"></i><b>10.3.1</b> Leve l<span></span></a></li>
<li class="chapter" data-level="10.3.2" data-path="10.3-unconditional-means-model.html"><a href="10.3-unconditional-means-model.html#level-2"><i class="fa fa-check"></i><b>10.3.2</b> Level 2<span></span></a></li>
<li class="chapter" data-level="10.3.3" data-path="10.3-unconditional-means-model.html"><a href="10.3-unconditional-means-model.html#single-equation"><i class="fa fa-check"></i><b>10.3.3</b> Single Equation<span></span></a></li>
<li class="chapter" data-level="10.3.4" data-path="10.3-unconditional-means-model.html"><a href="10.3-unconditional-means-model.html#model-elaboration"><i class="fa fa-check"></i><b>10.3.4</b> Model Elaboration<span></span></a></li>
<li class="chapter" data-level="10.3.5" data-path="10.3-unconditional-means-model.html"><a href="10.3-unconditional-means-model.html#estimated-quantities"><i class="fa fa-check"></i><b>10.3.5</b> Estimated Quantities<span></span></a></li>
<li class="chapter" data-level="10.3.6" data-path="10.3-unconditional-means-model.html"><a href="10.3-unconditional-means-model.html#more-notation"><i class="fa fa-check"></i><b>10.3.6</b> More Notation<span></span></a></li>
<li class="chapter" data-level="10.3.7" data-path="10.3-unconditional-means-model.html"><a href="10.3-unconditional-means-model.html#unconditional-means-model-in-r"><i class="fa fa-check"></i><b>10.3.7</b> Unconditional Means Model in R<span></span></a></li>
<li class="chapter" data-level="10.3.8" data-path="10.3-unconditional-means-model.html"><a href="10.3-unconditional-means-model.html#intra-class-correlation"><i class="fa fa-check"></i><b>10.3.8</b> Intra-Class Correlation<span></span></a></li>
<li class="chapter" data-level="10.3.9" data-path="10.3-unconditional-means-model.html"><a href="10.3-unconditional-means-model.html#model-impled-moments"><i class="fa fa-check"></i><b>10.3.9</b> Model-Impled Moments<span></span></a></li>
<li class="chapter" data-level="10.3.10" data-path="10.3-unconditional-means-model.html"><a href="10.3-unconditional-means-model.html#model-residuals"><i class="fa fa-check"></i><b>10.3.10</b> Model Residuals<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="10.4-repeated-measures-anova.html"><a href="10.4-repeated-measures-anova.html"><i class="fa fa-check"></i><b>10.4</b> Repeated Measures ANOVA<span></span></a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="10.4-repeated-measures-anova.html"><a href="10.4-repeated-measures-anova.html#intra-class-correlation-1"><i class="fa fa-check"></i><b>10.4.1</b> Intra-Class Correlation<span></span></a></li>
<li class="chapter" data-level="10.4.2" data-path="10.4-repeated-measures-anova.html"><a href="10.4-repeated-measures-anova.html#model-implied-mean-vector"><i class="fa fa-check"></i><b>10.4.2</b> Model-Implied Mean Vector<span></span></a></li>
<li class="chapter" data-level="10.4.3" data-path="10.4-repeated-measures-anova.html"><a href="10.4-repeated-measures-anova.html#model-implied-covariance-matrix-1"><i class="fa fa-check"></i><b>10.4.3</b> Model-Implied Covariance Matrix<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="10.5-repeated-measures-manova.html"><a href="10.5-repeated-measures-manova.html"><i class="fa fa-check"></i><b>10.5</b> Repeated Measures MANOVA<span></span></a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="10.5-repeated-measures-manova.html"><a href="10.5-repeated-measures-manova.html#model-implied-mean-vector-1"><i class="fa fa-check"></i><b>10.5.1</b> Model-Implied Mean Vector<span></span></a></li>
<li class="chapter" data-level="10.5.2" data-path="10.5-repeated-measures-manova.html"><a href="10.5-repeated-measures-manova.html#model-implied-covariance-matrix-2"><i class="fa fa-check"></i><b>10.5.2</b> Model-Implied Covariance Matrix<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="10.6-repeated-measures-manova-unstructed.html"><a href="10.6-repeated-measures-manova-unstructed.html"><i class="fa fa-check"></i><b>10.6</b> Repeated Measures MANOVA (Unstructed)<span></span></a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="10.6-repeated-measures-manova-unstructed.html"><a href="10.6-repeated-measures-manova-unstructed.html#model-implied-mean-vector-2"><i class="fa fa-check"></i><b>10.6.1</b> Model-Implied Mean Vector<span></span></a></li>
<li class="chapter" data-level="10.6.2" data-path="10.6-repeated-measures-manova-unstructed.html"><a href="10.6-repeated-measures-manova-unstructed.html#model-implied-covariance-matrix-3"><i class="fa fa-check"></i><b>10.6.2</b> Model-Implied Covariance Matrix<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="11-chapter-11.html"><a href="11-chapter-11.html"><i class="fa fa-check"></i><b>11</b> Growth Curve Modeling<span></span></a>
<ul>
<li class="chapter" data-level="11.1" data-path="11.1-introduction.html"><a href="11.1-introduction.html"><i class="fa fa-check"></i><b>11.1</b> Introduction<span></span></a></li>
<li class="chapter" data-level="11.2" data-path="11.2-data-preparation-and-description-1.html"><a href="11.2-data-preparation-and-description-1.html"><i class="fa fa-check"></i><b>11.2</b> Data Preparation and Description<span></span></a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="11.2-data-preparation-and-description-1.html"><a href="11.2-data-preparation-and-description-1.html#loading-libraries-used-in-this-script."><i class="fa fa-check"></i><b>11.2.1</b> Loading libraries used in this script.<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="11.3-individual-growth-models.html"><a href="11.3-individual-growth-models.html"><i class="fa fa-check"></i><b>11.3</b> Individual Growth Models<span></span></a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="11.3-individual-growth-models.html"><a href="11.3-individual-growth-models.html#visualizing-individual-change"><i class="fa fa-check"></i><b>11.3.1</b> Visualizing Individual Change<span></span></a></li>
<li class="chapter" data-level="11.3.2" data-path="11.3-individual-growth-models.html"><a href="11.3-individual-growth-models.html#multiple-individuals"><i class="fa fa-check"></i><b>11.3.2</b> Multiple Individuals<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="11.4-unconditional-means-model-1.html"><a href="11.4-unconditional-means-model-1.html"><i class="fa fa-check"></i><b>11.4</b> Unconditional Means Model<span></span></a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="11.4-unconditional-means-model-1.html"><a href="11.4-unconditional-means-model-1.html#predicted-trajectories"><i class="fa fa-check"></i><b>11.4.1</b> Predicted Trajectories<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="11.5-linear-growth-model.html"><a href="11.5-linear-growth-model.html"><i class="fa fa-check"></i><b>11.5</b> Linear Growth Model<span></span></a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="11.5-linear-growth-model.html"><a href="11.5-linear-growth-model.html#random-intercept-model"><i class="fa fa-check"></i><b>11.5.1</b> Random Intercept Model<span></span></a></li>
<li class="chapter" data-level="11.5.2" data-path="11.5-linear-growth-model.html"><a href="11.5-linear-growth-model.html#random-intercept-and-slopes-model"><i class="fa fa-check"></i><b>11.5.2</b> Random Intercept and Slopes Model<span></span></a></li>
<li class="chapter" data-level="11.5.3" data-path="11.5-linear-growth-model.html"><a href="11.5-linear-growth-model.html#model-comparison"><i class="fa fa-check"></i><b>11.5.3</b> Model Comparison<span></span></a></li>
<li class="chapter" data-level="11.5.4" data-path="11.5-linear-growth-model.html"><a href="11.5-linear-growth-model.html#mlm-and-individual-models"><i class="fa fa-check"></i><b>11.5.4</b> MLM and Individual Models<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="11.6-quadratic-growth-model.html"><a href="11.6-quadratic-growth-model.html"><i class="fa fa-check"></i><b>11.6</b> Quadratic Growth Model<span></span></a></li>
<li class="chapter" data-level="11.7" data-path="11.7-conditional-growth-model.html"><a href="11.7-conditional-growth-model.html"><i class="fa fa-check"></i><b>11.7</b> Conditional Growth Model<span></span></a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="11.7-conditional-growth-model.html"><a href="11.7-conditional-growth-model.html#conditional-growth-equation"><i class="fa fa-check"></i><b>11.7.1</b> Conditional Growth Equation<span></span></a></li>
<li class="chapter" data-level="11.7.2" data-path="11.7-conditional-growth-model.html"><a href="11.7-conditional-growth-model.html#conditional-growth-model-1"><i class="fa fa-check"></i><b>11.7.2</b> Conditional Growth Model 1<span></span></a></li>
<li class="chapter" data-level="11.7.3" data-path="11.7-conditional-growth-model.html"><a href="11.7-conditional-growth-model.html#conditional-growth-model-1-1"><i class="fa fa-check"></i><b>11.7.3</b> Conditional Growth Model 1<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="11.8-alternative-time-metrics.html"><a href="11.8-alternative-time-metrics.html"><i class="fa fa-check"></i><b>11.8</b> Alternative Time Metrics<span></span></a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="11.8-alternative-time-metrics.html"><a href="11.8-alternative-time-metrics.html#recentering-time-metrics"><i class="fa fa-check"></i><b>11.8.1</b> Recentering time metrics<span></span></a></li>
<li class="chapter" data-level="11.8.2" data-path="11.8-alternative-time-metrics.html"><a href="11.8-alternative-time-metrics.html#rescaling-time-metric"><i class="fa fa-check"></i><b>11.8.2</b> Rescaling time metric<span></span></a></li>
<li class="chapter" data-level="11.8.3" data-path="11.8-alternative-time-metrics.html"><a href="11.8-alternative-time-metrics.html#remapping-time"><i class="fa fa-check"></i><b>11.8.3</b> Remapping Time<span></span></a></li>
<li class="chapter" data-level="11.8.4" data-path="11.8-alternative-time-metrics.html"><a href="11.8-alternative-time-metrics.html#compare-growth-metrics"><i class="fa fa-check"></i><b>11.8.4</b> Compare Growth Metrics<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="12-chapter-12.html"><a href="12-chapter-12.html"><i class="fa fa-check"></i><b>12</b> Nonlinear Growth Curves<span></span></a>
<ul>
<li class="chapter" data-level="12.1" data-path="12.1-review-of-linear-growth.html"><a href="12.1-review-of-linear-growth.html"><i class="fa fa-check"></i><b>12.1</b> Review of Linear Growth<span></span></a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="12.1-review-of-linear-growth.html"><a href="12.1-review-of-linear-growth.html#theory-of-linear-growth"><i class="fa fa-check"></i><b>12.1.1</b> Theory of Linear Growth<span></span></a></li>
<li class="chapter" data-level="12.1.2" data-path="12.1-review-of-linear-growth.html"><a href="12.1-review-of-linear-growth.html#characteristics-of-linear-growth"><i class="fa fa-check"></i><b>12.1.2</b> Characteristics of Linear Growth<span></span></a></li>
<li class="chapter" data-level="12.1.3" data-path="12.1-review-of-linear-growth.html"><a href="12.1-review-of-linear-growth.html#no-growth-model"><i class="fa fa-check"></i><b>12.1.3</b> No Growth Model<span></span></a></li>
<li class="chapter" data-level="12.1.4" data-path="12.1-review-of-linear-growth.html"><a href="12.1-review-of-linear-growth.html#random-intercept-model-1"><i class="fa fa-check"></i><b>12.1.4</b> Random Intercept Model<span></span></a></li>
<li class="chapter" data-level="12.1.5" data-path="12.1-review-of-linear-growth.html"><a href="12.1-review-of-linear-growth.html#linear-growth-model-1"><i class="fa fa-check"></i><b>12.1.5</b> Linear Growth Model<span></span></a></li>
<li class="chapter" data-level="12.1.6" data-path="12.1-review-of-linear-growth.html"><a href="12.1-review-of-linear-growth.html#quadratic-growth-model-1"><i class="fa fa-check"></i><b>12.1.6</b> Quadratic Growth Model<span></span></a></li>
<li class="chapter" data-level="12.1.7" data-path="12.1-review-of-linear-growth.html"><a href="12.1-review-of-linear-growth.html#quadratic-growth-equations"><i class="fa fa-check"></i><b>12.1.7</b> Quadratic Growth Equations<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="12.2-introducing-nonlinear-growth.html"><a href="12.2-introducing-nonlinear-growth.html"><i class="fa fa-check"></i><b>12.2</b> Introducing Nonlinear Growth<span></span></a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="12.2-introducing-nonlinear-growth.html"><a href="12.2-introducing-nonlinear-growth.html#types-of-nonlinearity"><i class="fa fa-check"></i><b>12.2.1</b> Types of Nonlinearity<span></span></a></li>
<li class="chapter" data-level="12.2.2" data-path="12.2-introducing-nonlinear-growth.html"><a href="12.2-introducing-nonlinear-growth.html#flexibility-of-nonlinear-growth"><i class="fa fa-check"></i><b>12.2.2</b> Flexibility of Nonlinear Growth<span></span></a></li>
<li class="chapter" data-level="12.2.3" data-path="12.2-introducing-nonlinear-growth.html"><a href="12.2-introducing-nonlinear-growth.html#utility-of-nonlinear-growth"><i class="fa fa-check"></i><b>12.2.3</b> Utility of Nonlinear Growth<span></span></a></li>
<li class="chapter" data-level="12.2.4" data-path="12.2-introducing-nonlinear-growth.html"><a href="12.2-introducing-nonlinear-growth.html#some-nonlinear-growth-models"><i class="fa fa-check"></i><b>12.2.4</b> Some Nonlinear Growth Models<span></span></a></li>
<li class="chapter" data-level="12.2.5" data-path="12.2-introducing-nonlinear-growth.html"><a href="12.2-introducing-nonlinear-growth.html#need-for-nonlinear-models"><i class="fa fa-check"></i><b>12.2.5</b> Need for Nonlinear Models<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="12.3-example-data-ram-grimm-2007.html"><a href="12.3-example-data-ram-grimm-2007.html"><i class="fa fa-check"></i><b>12.3</b> Example Data (Ram &amp; Grimm, 2007)<span></span></a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="12.3-example-data-ram-grimm-2007.html"><a href="12.3-example-data-ram-grimm-2007.html#read-in-cortisol-data"><i class="fa fa-check"></i><b>12.3.1</b> Read in Cortisol Data<span></span></a></li>
<li class="chapter" data-level="12.3.2" data-path="12.3-example-data-ram-grimm-2007.html"><a href="12.3-example-data-ram-grimm-2007.html#reshaping-data"><i class="fa fa-check"></i><b>12.3.2</b> Reshaping Data<span></span></a></li>
<li class="chapter" data-level="12.3.3" data-path="12.3-example-data-ram-grimm-2007.html"><a href="12.3-example-data-ram-grimm-2007.html#descriptives"><i class="fa fa-check"></i><b>12.3.3</b> Descriptives<span></span></a></li>
<li class="chapter" data-level="12.3.4" data-path="12.3-example-data-ram-grimm-2007.html"><a href="12.3-example-data-ram-grimm-2007.html#density-plots"><i class="fa fa-check"></i><b>12.3.4</b> Density Plots<span></span></a></li>
<li class="chapter" data-level="12.3.5" data-path="12.3-example-data-ram-grimm-2007.html"><a href="12.3-example-data-ram-grimm-2007.html#individual-level-trajectories"><i class="fa fa-check"></i><b>12.3.5</b> Individual-level Trajectories<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="12.4-linear-growth-cortisol.html"><a href="12.4-linear-growth-cortisol.html"><i class="fa fa-check"></i><b>12.4</b> Linear Growth (Cortisol)<span></span></a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="12.4-linear-growth-cortisol.html"><a href="12.4-linear-growth-cortisol.html#equation"><i class="fa fa-check"></i><b>12.4.1</b> Equation<span></span></a></li>
<li class="chapter" data-level="12.4.2" data-path="12.4-linear-growth-cortisol.html"><a href="12.4-linear-growth-cortisol.html#fit-model"><i class="fa fa-check"></i><b>12.4.2</b> Fit Model<span></span></a></li>
<li class="chapter" data-level="12.4.3" data-path="12.4-linear-growth-cortisol.html"><a href="12.4-linear-growth-cortisol.html#predicted-trajectories-1"><i class="fa fa-check"></i><b>12.4.3</b> Predicted Trajectories<span></span></a></li>
<li class="chapter" data-level="12.4.4" data-path="12.4-linear-growth-cortisol.html"><a href="12.4-linear-growth-cortisol.html#interpretation-4"><i class="fa fa-check"></i><b>12.4.4</b> Interpretation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="12.5-quadratic-growth-cortisol.html"><a href="12.5-quadratic-growth-cortisol.html"><i class="fa fa-check"></i><b>12.5</b> Quadratic Growth (Cortisol)<span></span></a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="12.5-quadratic-growth-cortisol.html"><a href="12.5-quadratic-growth-cortisol.html#equation-1"><i class="fa fa-check"></i><b>12.5.1</b> Equation<span></span></a></li>
<li class="chapter" data-level="12.5.2" data-path="12.5-quadratic-growth-cortisol.html"><a href="12.5-quadratic-growth-cortisol.html#fit-model-1"><i class="fa fa-check"></i><b>12.5.2</b> Fit Model<span></span></a></li>
<li class="chapter" data-level="12.5.3" data-path="12.5-quadratic-growth-cortisol.html"><a href="12.5-quadratic-growth-cortisol.html#predicted-trajectories-2"><i class="fa fa-check"></i><b>12.5.3</b> Predicted Trajectories<span></span></a></li>
<li class="chapter" data-level="12.5.4" data-path="12.5-quadratic-growth-cortisol.html"><a href="12.5-quadratic-growth-cortisol.html#interpretation-5"><i class="fa fa-check"></i><b>12.5.4</b> Interpretation<span></span></a></li>
<li class="chapter" data-level="12.5.5" data-path="12.5-quadratic-growth-cortisol.html"><a href="12.5-quadratic-growth-cortisol.html#interpretational-caution"><i class="fa fa-check"></i><b>12.5.5</b> Interpretational Caution<span></span></a></li>
<li class="chapter" data-level="12.5.6" data-path="12.5-quadratic-growth-cortisol.html"><a href="12.5-quadratic-growth-cortisol.html#nonlinear-or-linear-model"><i class="fa fa-check"></i><b>12.5.6</b> Nonlinear or Linear Model?<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="12.6-latent-basis-cortisol.html"><a href="12.6-latent-basis-cortisol.html"><i class="fa fa-check"></i><b>12.6</b> Latent Basis (Cortisol)<span></span></a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="12.6-latent-basis-cortisol.html"><a href="12.6-latent-basis-cortisol.html#equation-2"><i class="fa fa-check"></i><b>12.6.1</b> Equation<span></span></a></li>
<li class="chapter" data-level="12.6.2" data-path="12.6-latent-basis-cortisol.html"><a href="12.6-latent-basis-cortisol.html#fit-model-2"><i class="fa fa-check"></i><b>12.6.2</b> Fit Model<span></span></a></li>
<li class="chapter" data-level="12.6.3" data-path="12.6-latent-basis-cortisol.html"><a href="12.6-latent-basis-cortisol.html#predicted-trajectories-3"><i class="fa fa-check"></i><b>12.6.3</b> Predicted Trajectories<span></span></a></li>
<li class="chapter" data-level="12.6.4" data-path="12.6-latent-basis-cortisol.html"><a href="12.6-latent-basis-cortisol.html#interpretation-6"><i class="fa fa-check"></i><b>12.6.4</b> Interpretation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="12.7-exponential-growth-cortisol.html"><a href="12.7-exponential-growth-cortisol.html"><i class="fa fa-check"></i><b>12.7</b> Exponential Growth (Cortisol)<span></span></a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="12.7-exponential-growth-cortisol.html"><a href="12.7-exponential-growth-cortisol.html#fit-model-3"><i class="fa fa-check"></i><b>12.7.1</b> Fit Model<span></span></a></li>
<li class="chapter" data-level="12.7.2" data-path="12.7-exponential-growth-cortisol.html"><a href="12.7-exponential-growth-cortisol.html#predicted-trajectories-4"><i class="fa fa-check"></i><b>12.7.2</b> Predicted Trajectories<span></span></a></li>
<li class="chapter" data-level="12.7.3" data-path="12.7-exponential-growth-cortisol.html"><a href="12.7-exponential-growth-cortisol.html#interpretation-7"><i class="fa fa-check"></i><b>12.7.3</b> Interpretation<span></span></a></li>
<li class="chapter" data-level="12.7.4" data-path="12.7-exponential-growth-cortisol.html"><a href="12.7-exponential-growth-cortisol.html#nonlinear-or-linear-model-1"><i class="fa fa-check"></i><b>12.7.4</b> Nonlinear or Linear Model?<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="12.8-multiphase-growth-cortisol.html"><a href="12.8-multiphase-growth-cortisol.html"><i class="fa fa-check"></i><b>12.8</b> Multiphase Growth (Cortisol)<span></span></a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="12.8-multiphase-growth-cortisol.html"><a href="12.8-multiphase-growth-cortisol.html#equation-3"><i class="fa fa-check"></i><b>12.8.1</b> Equation<span></span></a></li>
<li class="chapter" data-level="12.8.2" data-path="12.8-multiphase-growth-cortisol.html"><a href="12.8-multiphase-growth-cortisol.html#fit-model-4"><i class="fa fa-check"></i><b>12.8.2</b> Fit Model<span></span></a></li>
<li class="chapter" data-level="12.8.3" data-path="12.8-multiphase-growth-cortisol.html"><a href="12.8-multiphase-growth-cortisol.html#predicted-trajectories-5"><i class="fa fa-check"></i><b>12.8.3</b> Predicted Trajectories<span></span></a></li>
<li class="chapter" data-level="12.8.4" data-path="12.8-multiphase-growth-cortisol.html"><a href="12.8-multiphase-growth-cortisol.html#interpretation-8"><i class="fa fa-check"></i><b>12.8.4</b> Interpretation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="12.9-bilinear-spline-cortisol.html"><a href="12.9-bilinear-spline-cortisol.html"><i class="fa fa-check"></i><b>12.9</b> Bilinear Spline (Cortisol)<span></span></a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="12.9-bilinear-spline-cortisol.html"><a href="12.9-bilinear-spline-cortisol.html#equation-4"><i class="fa fa-check"></i><b>12.9.1</b> Equation<span></span></a></li>
<li class="chapter" data-level="12.9.2" data-path="12.9-bilinear-spline-cortisol.html"><a href="12.9-bilinear-spline-cortisol.html#fit-model-5"><i class="fa fa-check"></i><b>12.9.2</b> Fit Model<span></span></a></li>
<li class="chapter" data-level="12.9.3" data-path="12.9-bilinear-spline-cortisol.html"><a href="12.9-bilinear-spline-cortisol.html#predicted-trajectories-6"><i class="fa fa-check"></i><b>12.9.3</b> Predicted Trajectories<span></span></a></li>
<li class="chapter" data-level="12.9.4" data-path="12.9-bilinear-spline-cortisol.html"><a href="12.9-bilinear-spline-cortisol.html#interpretation-9"><i class="fa fa-check"></i><b>12.9.4</b> Interpretation<span></span></a></li>
<li class="chapter" data-level="12.9.5" data-path="12.9-bilinear-spline-cortisol.html"><a href="12.9-bilinear-spline-cortisol.html#fit-model-6"><i class="fa fa-check"></i><b>12.9.5</b> Fit Model<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="12.10-references-1.html"><a href="12.10-references-1.html"><i class="fa fa-check"></i><b>12.10</b> References<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="13-chapter-13.html"><a href="13-chapter-13.html"><i class="fa fa-check"></i><b>13</b> Dyadic Data Analysis<span></span></a>
<ul>
<li class="chapter" data-level="13.1" data-path="13.1-introduction-1.html"><a href="13.1-introduction-1.html"><i class="fa fa-check"></i><b>13.1</b> Introduction<span></span></a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="13.1-introduction-1.html"><a href="13.1-introduction-1.html#interpersonal-phenomena"><i class="fa fa-check"></i><b>13.1.1</b> Interpersonal Phenomena<span></span></a></li>
<li class="chapter" data-level="13.1.2" data-path="13.1-introduction-1.html"><a href="13.1-introduction-1.html#dyadic-measurement"><i class="fa fa-check"></i><b>13.1.2</b> Dyadic Measurement<span></span></a></li>
<li class="chapter" data-level="13.1.3" data-path="13.1-introduction-1.html"><a href="13.1-introduction-1.html#discussion-question"><i class="fa fa-check"></i><b>13.1.3</b> Discussion question<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="13.2-interdependence.html"><a href="13.2-interdependence.html"><i class="fa fa-check"></i><b>13.2</b> Interdependence<span></span></a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="13.2-interdependence.html"><a href="13.2-interdependence.html#definition"><i class="fa fa-check"></i><b>13.2.1</b> Definition<span></span></a></li>
<li class="chapter" data-level="13.2.2" data-path="13.2-interdependence.html"><a href="13.2-interdependence.html#ignoring-interdependence"><i class="fa fa-check"></i><b>13.2.2</b> Ignoring Interdependence<span></span></a></li>
<li class="chapter" data-level="13.2.3" data-path="13.2-interdependence.html"><a href="13.2-interdependence.html#linkage-types"><i class="fa fa-check"></i><b>13.2.3</b> Linkage Types<span></span></a></li>
<li class="chapter" data-level="13.2.4" data-path="13.2-interdependence.html"><a href="13.2-interdependence.html#sources-of-interdependence"><i class="fa fa-check"></i><b>13.2.4</b> Sources of Interdependence<span></span></a></li>
<li class="chapter" data-level="13.2.5" data-path="13.2-interdependence.html"><a href="13.2-interdependence.html#discussion-question-1"><i class="fa fa-check"></i><b>13.2.5</b> Discussion Question<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="13.3-basic-definitions.html"><a href="13.3-basic-definitions.html"><i class="fa fa-check"></i><b>13.3</b> Basic Definitions<span></span></a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="13.3-basic-definitions.html"><a href="13.3-basic-definitions.html#distinguishability"><i class="fa fa-check"></i><b>13.3.1</b> Distinguishability<span></span></a></li>
<li class="chapter" data-level="13.3.2" data-path="13.3-basic-definitions.html"><a href="13.3-basic-definitions.html#variable-types"><i class="fa fa-check"></i><b>13.3.2</b> Variable Types<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="13.4-dyadic-designs.html"><a href="13.4-dyadic-designs.html"><i class="fa fa-check"></i><b>13.4</b> Dyadic Designs<span></span></a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="13.4-dyadic-designs.html"><a href="13.4-dyadic-designs.html#standard-dyadic-design"><i class="fa fa-check"></i><b>13.4.1</b> Standard Dyadic Design<span></span></a></li>
<li class="chapter" data-level="13.4.2" data-path="13.4-dyadic-designs.html"><a href="13.4-dyadic-designs.html#social-relations-model"><i class="fa fa-check"></i><b>13.4.2</b> Social Relations Model<span></span></a></li>
<li class="chapter" data-level="13.4.3" data-path="13.4-dyadic-designs.html"><a href="13.4-dyadic-designs.html#one-with-many-design"><i class="fa fa-check"></i><b>13.4.3</b> One-with-many Design<span></span></a></li>
<li class="chapter" data-level="13.4.4" data-path="13.4-dyadic-designs.html"><a href="13.4-dyadic-designs.html#discussion-question-3"><i class="fa fa-check"></i><b>13.4.4</b> Discussion Question:<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="13.5-actor-partner-interdependence-model-apim.html"><a href="13.5-actor-partner-interdependence-model-apim.html"><i class="fa fa-check"></i><b>13.5</b> Actor Partner Interdependence Model (APIM)<span></span></a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="13.5-actor-partner-interdependence-model-apim.html"><a href="13.5-actor-partner-interdependence-model-apim.html#model-1"><i class="fa fa-check"></i><b>13.5.1</b> Model<span></span></a></li>
<li class="chapter" data-level="13.5.2" data-path="13.5-actor-partner-interdependence-model-apim.html"><a href="13.5-actor-partner-interdependence-model-apim.html#conceptual-interpretations"><i class="fa fa-check"></i><b>13.5.2</b> Conceptual Interpretations<span></span></a></li>
<li class="chapter" data-level="13.5.3" data-path="13.5-actor-partner-interdependence-model-apim.html"><a href="13.5-actor-partner-interdependence-model-apim.html#actor-partner-interactions"><i class="fa fa-check"></i><b>13.5.3</b> Actor-Partner Interactions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="13.6-longitudinal-apim.html"><a href="13.6-longitudinal-apim.html"><i class="fa fa-check"></i><b>13.6</b> Longitudinal APIM<span></span></a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="13.6-longitudinal-apim.html"><a href="13.6-longitudinal-apim.html#model-2"><i class="fa fa-check"></i><b>13.6.1</b> Model<span></span></a></li>
<li class="chapter" data-level="13.6.2" data-path="13.6-longitudinal-apim.html"><a href="13.6-longitudinal-apim.html#estimated-parameters"><i class="fa fa-check"></i><b>13.6.2</b> Estimated Parameters<span></span></a></li>
<li class="chapter" data-level="13.6.3" data-path="13.6-longitudinal-apim.html"><a href="13.6-longitudinal-apim.html#parameter-covariation"><i class="fa fa-check"></i><b>13.6.3</b> Parameter Covariation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="13.7-data-example.html"><a href="13.7-data-example.html"><i class="fa fa-check"></i><b>13.7</b> Data Example<span></span></a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="13.7-data-example.html"><a href="13.7-data-example.html#preliminaries"><i class="fa fa-check"></i><b>13.7.1</b> Preliminaries<span></span></a></li>
<li class="chapter" data-level="13.7.2" data-path="13.7-data-example.html"><a href="13.7-data-example.html#modeling-scenario"><i class="fa fa-check"></i><b>13.7.2</b> Modeling Scenario<span></span></a></li>
<li class="chapter" data-level="13.7.3" data-path="13.7-data-example.html"><a href="13.7-data-example.html#descriptives-1"><i class="fa fa-check"></i><b>13.7.3</b> Descriptives<span></span></a></li>
<li class="chapter" data-level="13.7.4" data-path="13.7-data-example.html"><a href="13.7-data-example.html#dyadic-data-prep"><i class="fa fa-check"></i><b>13.7.4</b> Dyadic Data Prep<span></span></a></li>
<li class="chapter" data-level="13.7.5" data-path="13.7-data-example.html"><a href="13.7-data-example.html#apim"><i class="fa fa-check"></i><b>13.7.5</b> APIM<span></span></a></li>
<li class="chapter" data-level="13.7.6" data-path="13.7-data-example.html"><a href="13.7-data-example.html#null-model"><i class="fa fa-check"></i><b>13.7.6</b> Null Model<span></span></a></li>
<li class="chapter" data-level="13.7.7" data-path="13.7-data-example.html"><a href="13.7-data-example.html#full-apim"><i class="fa fa-check"></i><b>13.7.7</b> Full APIM<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="13.8-data-example-2.html"><a href="13.8-data-example-2.html"><i class="fa fa-check"></i><b>13.8</b> Data Example 2<span></span></a>
<ul>
<li class="chapter" data-level="13.8.1" data-path="13.8-data-example-2.html"><a href="13.8-data-example-2.html#overview"><i class="fa fa-check"></i><b>13.8.1</b> Overview<span></span></a></li>
<li class="chapter" data-level="13.8.2" data-path="13.8-data-example-2.html"><a href="13.8-data-example-2.html#outline"><i class="fa fa-check"></i><b>13.8.2</b> Outline<span></span></a></li>
<li class="chapter" data-level="13.8.3" data-path="13.8-data-example-2.html"><a href="13.8-data-example-2.html#the-modeling-enterprise."><i class="fa fa-check"></i><b>13.8.3</b> The Modeling Enterprise.<span></span></a></li>
<li class="chapter" data-level="13.8.4" data-path="13.8-data-example-2.html"><a href="13.8-data-example-2.html#the-data."><i class="fa fa-check"></i><b>13.8.4</b> The Data.<span></span></a></li>
<li class="chapter" data-level="13.8.5" data-path="13.8-data-example-2.html"><a href="13.8-data-example-2.html#plotting-the-data."><i class="fa fa-check"></i><b>13.8.5</b> Plotting the Data.<span></span></a></li>
<li class="chapter" data-level="13.8.6" data-path="13.8-data-example-2.html"><a href="13.8-data-example-2.html#the-multilevel-model."><i class="fa fa-check"></i><b>13.8.6</b> The Multilevel Model.<span></span></a></li>
<li class="chapter" data-level="13.8.7" data-path="13.8-data-example-2.html"><a href="13.8-data-example-2.html#fit-male-model"><i class="fa fa-check"></i><b>13.8.7</b> Fit Male Model<span></span></a></li>
<li class="chapter" data-level="13.8.8" data-path="13.8-data-example-2.html"><a href="13.8-data-example-2.html#fit-female-model"><i class="fa fa-check"></i><b>13.8.8</b> Fit Female Model<span></span></a></li>
<li class="chapter" data-level="13.8.9" data-path="13.8-data-example-2.html"><a href="13.8-data-example-2.html#fit-full-model"><i class="fa fa-check"></i><b>13.8.9</b> Fit Full Model<span></span></a></li>
<li class="chapter" data-level="13.8.10" data-path="13.8-data-example-2.html"><a href="13.8-data-example-2.html#conclusion"><i class="fa fa-check"></i><b>13.8.10</b> Conclusion<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13.9" data-path="13.9-reference.html"><a href="13.9-reference.html"><i class="fa fa-check"></i><b>13.9</b> Reference<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="14-chapter-14.html"><a href="14-chapter-14.html"><i class="fa fa-check"></i><b>14</b> Cluster Analysis<span></span></a>
<ul>
<li class="chapter" data-level="14.1" data-path="14.1-introduction-2.html"><a href="14.1-introduction-2.html"><i class="fa fa-check"></i><b>14.1</b> Introduction<span></span></a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="14.1-introduction-2.html"><a href="14.1-introduction-2.html#supervised-learning"><i class="fa fa-check"></i><b>14.1.1</b> Supervised Learning<span></span></a></li>
<li class="chapter" data-level="14.1.2" data-path="14.1-introduction-2.html"><a href="14.1-introduction-2.html#unsupervised-learning"><i class="fa fa-check"></i><b>14.1.2</b> Unsupervised Learning<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="14.2-cluster-analysis.html"><a href="14.2-cluster-analysis.html"><i class="fa fa-check"></i><b>14.2</b> Cluster Analysis<span></span></a></li>
<li class="chapter" data-level="14.3" data-path="14.3-clustering-algorithms.html"><a href="14.3-clustering-algorithms.html"><i class="fa fa-check"></i><b>14.3</b> Clustering Algorithms<span></span></a></li>
<li class="chapter" data-level="14.4" data-path="14.4-hierarchical-clustering-1.html"><a href="14.4-hierarchical-clustering-1.html"><i class="fa fa-check"></i><b>14.4</b> Hierarchical Clustering<span></span></a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="14.4-hierarchical-clustering-1.html"><a href="14.4-hierarchical-clustering-1.html#distances"><i class="fa fa-check"></i><b>14.4.1</b> Distances<span></span></a></li>
<li class="chapter" data-level="14.4.2" data-path="14.4-hierarchical-clustering-1.html"><a href="14.4-hierarchical-clustering-1.html#distance-between-clusters"><i class="fa fa-check"></i><b>14.4.2</b> Distance Between Clusters<span></span></a></li>
<li class="chapter" data-level="14.4.3" data-path="14.4-hierarchical-clustering-1.html"><a href="14.4-hierarchical-clustering-1.html#linkages-applied-example"><i class="fa fa-check"></i><b>14.4.3</b> Linkages Applied Example<span></span></a></li>
<li class="chapter" data-level="14.4.4" data-path="14.4-hierarchical-clustering-1.html"><a href="14.4-hierarchical-clustering-1.html#dendograms"><i class="fa fa-check"></i><b>14.4.4</b> Dendograms<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="14.5-k-means-clustering-1.html"><a href="14.5-k-means-clustering-1.html"><i class="fa fa-check"></i><b>14.5</b> K-Means Clustering<span></span></a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="14.5-k-means-clustering-1.html"><a href="14.5-k-means-clustering-1.html#within-cluster-variation"><i class="fa fa-check"></i><b>14.5.1</b> Within-Cluster Variation<span></span></a></li>
<li class="chapter" data-level="14.5.2" data-path="14.5-k-means-clustering-1.html"><a href="14.5-k-means-clustering-1.html#k-means-algorithm"><i class="fa fa-check"></i><b>14.5.2</b> K-Means Algorithm<span></span></a></li>
<li class="chapter" data-level="14.5.3" data-path="14.5-k-means-clustering-1.html"><a href="14.5-k-means-clustering-1.html#k-means-example"><i class="fa fa-check"></i><b>14.5.3</b> K-means Example<span></span></a></li>
<li class="chapter" data-level="14.5.4" data-path="14.5-k-means-clustering-1.html"><a href="14.5-k-means-clustering-1.html#choosing-k"><i class="fa fa-check"></i><b>14.5.4</b> Choosing K<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="14.6-dbscan.html"><a href="14.6-dbscan.html"><i class="fa fa-check"></i><b>14.6</b> DBSCAN<span></span></a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="14.6-dbscan.html"><a href="14.6-dbscan.html#example-of-dbscan"><i class="fa fa-check"></i><b>14.6.1</b> Example of DBSCAN<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="14.7-issues-in-clustering.html"><a href="14.7-issues-in-clustering.html"><i class="fa fa-check"></i><b>14.7</b> Issues in Clustering<span></span></a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="14.7-issues-in-clustering.html"><a href="14.7-issues-in-clustering.html#recommendations"><i class="fa fa-check"></i><b>14.7.1</b> Recommendations<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="14.8-applied-examples.html"><a href="14.8-applied-examples.html"><i class="fa fa-check"></i><b>14.8</b> Applied Examples<span></span></a>
<ul>
<li class="chapter" data-level="14.8.1" data-path="14.8-applied-examples.html"><a href="14.8-applied-examples.html#preliminaries-1"><i class="fa fa-check"></i><b>14.8.1</b> Preliminaries<span></span></a></li>
<li class="chapter" data-level="14.8.2" data-path="14.8-applied-examples.html"><a href="14.8-applied-examples.html#preparing-data"><i class="fa fa-check"></i><b>14.8.2</b> Preparing Data<span></span></a></li>
<li class="chapter" data-level="14.8.3" data-path="14.8-applied-examples.html"><a href="14.8-applied-examples.html#scaling"><i class="fa fa-check"></i><b>14.8.3</b> Scaling<span></span></a></li>
<li class="chapter" data-level="14.8.4" data-path="14.8-applied-examples.html"><a href="14.8-applied-examples.html#plotting"><i class="fa fa-check"></i><b>14.8.4</b> Plotting<span></span></a></li>
<li class="chapter" data-level="14.8.5" data-path="14.8-applied-examples.html"><a href="14.8-applied-examples.html#distances-1"><i class="fa fa-check"></i><b>14.8.5</b> Distances<span></span></a></li>
<li class="chapter" data-level="14.8.6" data-path="14.8-applied-examples.html"><a href="14.8-applied-examples.html#k-means"><i class="fa fa-check"></i><b>14.8.6</b> K-Means<span></span></a></li>
<li class="chapter" data-level="14.8.7" data-path="14.8-applied-examples.html"><a href="14.8-applied-examples.html#hierarchical-clustering-2"><i class="fa fa-check"></i><b>14.8.7</b> Hierarchical Clustering<span></span></a></li>
<li class="chapter" data-level="14.8.8" data-path="14.8-applied-examples.html"><a href="14.8-applied-examples.html#two-step-approach"><i class="fa fa-check"></i><b>14.8.8</b> Two-step Approach<span></span></a></li>
<li class="chapter" data-level="14.8.9" data-path="14.8-applied-examples.html"><a href="14.8-applied-examples.html#final-thoughts"><i class="fa fa-check"></i><b>14.8.9</b> Final Thoughts<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14.9" data-path="14.9-reference-1.html"><a href="14.9-reference-1.html"><i class="fa fa-check"></i><b>14.9</b> Reference<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="15-chapter-15.html"><a href="15-chapter-15.html"><i class="fa fa-check"></i><b>15</b> Vector Autoregressive Models<span></span></a>
<ul>
<li class="chapter" data-level="15.1" data-path="15.1-introduction-3.html"><a href="15.1-introduction-3.html"><i class="fa fa-check"></i><b>15.1</b> Introduction<span></span></a></li>
<li class="chapter" data-level="15.2" data-path="15.2-the-n1-ar-model.html"><a href="15.2-the-n1-ar-model.html"><i class="fa fa-check"></i><b>15.2</b> The N=1 AR Model<span></span></a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="15.2-the-n1-ar-model.html"><a href="15.2-the-n1-ar-model.html#random-shocks"><i class="fa fa-check"></i><b>15.2.1</b> Random Shocks<span></span></a></li>
<li class="chapter" data-level="15.2.2" data-path="15.2-the-n1-ar-model.html"><a href="15.2-the-n1-ar-model.html#autoregressive-parameter"><i class="fa fa-check"></i><b>15.2.2</b> Autoregressive Parameter<span></span></a></li>
<li class="chapter" data-level="15.2.3" data-path="15.2-the-n1-ar-model.html"><a href="15.2-the-n1-ar-model.html#ar1-model-example"><i class="fa fa-check"></i><b>15.2.3</b> AR(1) Model Example<span></span></a></li>
<li class="chapter" data-level="15.2.4" data-path="15.2-the-n1-ar-model.html"><a href="15.2-the-n1-ar-model.html#fitting-an-ar1-model-in-r"><i class="fa fa-check"></i><b>15.2.4</b> Fitting an AR(1) Model in R<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="15.3-the-n1-var-model.html"><a href="15.3-the-n1-var-model.html"><i class="fa fa-check"></i><b>15.3</b> The N=1 VAR Model<span></span></a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="15.3-the-n1-var-model.html"><a href="15.3-the-n1-var-model.html#fitting-an-var1-model-in-r"><i class="fa fa-check"></i><b>15.3.1</b> Fitting an VAR(1) Model in R<span></span></a></li>
<li class="chapter" data-level="15.3.2" data-path="15.3-the-n1-var-model.html"><a href="15.3-the-n1-var-model.html#a-note-on-path-diagrams"><i class="fa fa-check"></i><b>15.3.2</b> A Note on path Diagrams<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="15.4-introducing-the-multi-level-var.html"><a href="15.4-introducing-the-multi-level-var.html"><i class="fa fa-check"></i><b>15.4</b> Introducing the Multi-level VAR<span></span></a></li>
<li class="chapter" data-level="15.5" data-path="15.5-reference-2.html"><a href="15.5-reference-2.html"><i class="fa fa-check"></i><b>15.5</b> Reference<span></span></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/zackfisher/HDFS523" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">HDFS 523: Strategies for Data Analysis in Developmental Research</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="applied-examples" class="section level2 hasAnchor" number="14.8">
<h2><span class="header-section-number">14.8</span> Applied Examples<a href="14.8-applied-examples.html#applied-examples" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The applied examples for this chapter were adapted from a more detailed tutorial on the QuantDev website (<a href="https://quantdev.ssri.psu.edu/tutorials/cluster-analysis-example" class="uri">https://quantdev.ssri.psu.edu/tutorials/cluster-analysis-example</a>).</p>
<p>Cluster analysis is an exploratory, descriptive, bottom-up approach to structure heterogeneity. A key underpinning of cluster analysis is an assumption that a sample is NOT homogeneous. The method is used to examine and describe distinct sub-populations in the sample.
The goal is to identify <em>groups of individuals (observations)</em> whose members (a) are similar on group-defining variables, and (b) differ from members of other groups?</p>
<div id="preliminaries-1" class="section level3 hasAnchor" number="14.8.1">
<h3><span class="header-section-number">14.8.1</span> Preliminaries<a href="14.8-applied-examples.html#preliminaries-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Libraries used in this script. There are two main libraries that we will use <code>cluster</code> (namesake) and <code>fpc</code> (Flexible Procedures for Clustering). Some other functions are in the base package.</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="14.8-applied-examples.html#cb527-1" aria-hidden="true" tabindex="-1"></a><span class="co">#general packages</span></span>
<span id="cb527-2"><a href="14.8-applied-examples.html#cb527-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb527-3"><a href="14.8-applied-examples.html#cb527-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb527-4"><a href="14.8-applied-examples.html#cb527-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-5"><a href="14.8-applied-examples.html#cb527-5" aria-hidden="true" tabindex="-1"></a><span class="co">#cluster packages</span></span>
<span id="cb527-6"><a href="14.8-applied-examples.html#cb527-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster) <span class="co">#clustering</span></span>
<span id="cb527-7"><a href="14.8-applied-examples.html#cb527-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fpc) <span class="co">#flexible procedures for clustering</span></span>
<span id="cb527-8"><a href="14.8-applied-examples.html#cb527-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(clusterCrit) <span class="co">#cluster criteria</span></span></code></pre></div>
<p>Our example makes use of one our experience sampling data sets, but treats these data as though they are cross-sectional. Getting the data and doing a bit of data management (new id variable)</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="14.8-applied-examples.html#cb528-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set filepath for data file</span></span>
<span id="cb528-2"><a href="14.8-applied-examples.html#cb528-2" aria-hidden="true" tabindex="-1"></a>filepath <span class="ot">&lt;-</span> <span class="st">&quot;https://quantdev.ssri.psu.edu/sites/qdev/files/AMIBbrief_raw_daily1.csv&quot;</span></span>
<span id="cb528-3"><a href="14.8-applied-examples.html#cb528-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb528-4"><a href="14.8-applied-examples.html#cb528-4" aria-hidden="true" tabindex="-1"></a><span class="co">#read in the .csv file using the url() function</span></span>
<span id="cb528-5"><a href="14.8-applied-examples.html#cb528-5" aria-hidden="true" tabindex="-1"></a>daily <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="fu">url</span>(filepath),<span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb528-6"><a href="14.8-applied-examples.html#cb528-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb528-7"><a href="14.8-applied-examples.html#cb528-7" aria-hidden="true" tabindex="-1"></a><span class="co">#clean-up of variable names so that they are all lowercase</span></span>
<span id="cb528-8"><a href="14.8-applied-examples.html#cb528-8" aria-hidden="true" tabindex="-1"></a>var.names.daily <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">colnames</span>(daily))</span>
<span id="cb528-9"><a href="14.8-applied-examples.html#cb528-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(daily)<span class="ot">&lt;-</span>var.names.daily</span>
<span id="cb528-10"><a href="14.8-applied-examples.html#cb528-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb528-11"><a href="14.8-applied-examples.html#cb528-11" aria-hidden="true" tabindex="-1"></a><span class="co">#creating a new &quot;id&quot; variable</span></span>
<span id="cb528-12"><a href="14.8-applied-examples.html#cb528-12" aria-hidden="true" tabindex="-1"></a><span class="co">#(we had repeated measures nested in people, now they all get different ids)</span></span>
<span id="cb528-13"><a href="14.8-applied-examples.html#cb528-13" aria-hidden="true" tabindex="-1"></a>daily<span class="sc">$</span>id <span class="ot">&lt;-</span> daily<span class="sc">$</span>id<span class="sc">*</span><span class="dv">10</span><span class="sc">+</span>daily<span class="sc">$</span>day</span>
<span id="cb528-14"><a href="14.8-applied-examples.html#cb528-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb528-15"><a href="14.8-applied-examples.html#cb528-15" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(daily)</span></code></pre></div>
<pre><code>##  [1] &quot;id&quot;      &quot;day&quot;     &quot;date&quot;    &quot;slphrs&quot;  &quot;weath&quot;   &quot;lteq&quot;    &quot;pss&quot;    
##  [8] &quot;se&quot;      &quot;swls&quot;    &quot;evalday&quot; &quot;posaff&quot;  &quot;negaff&quot;  &quot;temp&quot;    &quot;hum&quot;    
## [15] &quot;wind&quot;    &quot;bar&quot;     &quot;prec&quot;</code></pre>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="14.8-applied-examples.html#cb530-1" aria-hidden="true" tabindex="-1"></a><span class="co">#reducing down to variable set</span></span>
<span id="cb530-2"><a href="14.8-applied-examples.html#cb530-2" aria-hidden="true" tabindex="-1"></a>daily <span class="ot">&lt;-</span> daily[ ,<span class="fu">c</span>(<span class="st">&quot;id&quot;</span>,<span class="st">&quot;slphrs&quot;</span>,<span class="st">&quot;weath&quot;</span>,<span class="st">&quot;lteq&quot;</span>,<span class="st">&quot;pss&quot;</span>,<span class="st">&quot;se&quot;</span>,<span class="st">&quot;swls&quot;</span>,<span class="st">&quot;evalday&quot;</span>, <span class="st">&quot;posaff&quot;</span>,<span class="st">&quot;negaff&quot;</span>,<span class="st">&quot;temp&quot;</span>,<span class="st">&quot;hum&quot;</span>,<span class="st">&quot;wind&quot;</span>,<span class="st">&quot;bar&quot;</span>,<span class="st">&quot;prec&quot;</span>)]</span>
<span id="cb530-3"><a href="14.8-applied-examples.html#cb530-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb530-4"><a href="14.8-applied-examples.html#cb530-4" aria-hidden="true" tabindex="-1"></a><span class="co">#names of variables</span></span>
<span id="cb530-5"><a href="14.8-applied-examples.html#cb530-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(daily)</span></code></pre></div>
<pre><code>##  [1] &quot;id&quot;      &quot;slphrs&quot;  &quot;weath&quot;   &quot;lteq&quot;    &quot;pss&quot;     &quot;se&quot;      &quot;swls&quot;   
##  [8] &quot;evalday&quot; &quot;posaff&quot;  &quot;negaff&quot;  &quot;temp&quot;    &quot;hum&quot;     &quot;wind&quot;    &quot;bar&quot;    
## [15] &quot;prec&quot;</code></pre>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="14.8-applied-examples.html#cb532-1" aria-hidden="true" tabindex="-1"></a><span class="co">#looking at data    </span></span>
<span id="cb532-2"><a href="14.8-applied-examples.html#cb532-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(daily,<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##      id slphrs weath lteq  pss se swls evalday posaff negaff temp  hum wind
## 1  1010    6.0     1   10 2.50  2  3.8       1    3.9    3.0 28.0 0.79 11.0
## 2  1011    2.0     2   10 2.75  3  4.2       0    3.8    2.3 20.8 0.62  3.6
## 3  1012    9.0     3   10 3.50  4  5.0       1    5.1    1.0 29.1 0.51  1.9
## 4  1013    7.5     2    9 3.00  4  5.0       1    5.6    1.3 30.2 0.58  2.7
## 5  1014    8.0     1   18 2.75  3  4.0       1    4.3    1.1 22.7 0.55  2.4
## 6  1015    8.0     2   19 2.75  3  4.2       1    3.9    1.0 21.4 0.54  0.7
## 7  1016    8.0     3   21 3.50  4  4.6       1    5.1    1.2 31.4 0.49  1.0
## 8  1017    7.0    NA   14 2.75  3  4.6       1    4.8    1.1 45.3 0.52  1.1
## 9  1020    7.0     0   12 3.50  5  5.6       0    6.3    1.4 28.0 0.79 11.0
## 10 1021    6.0     0   20 4.00  5  6.6       0    7.0    1.6 20.8 0.62  3.6
##      bar prec
## 1  29.40 0.20
## 2  30.17 0.00
## 3  30.35 0.02
## 4  30.23 0.00
## 5  30.46 0.00
## 6  30.54 0.00
## 7  30.51 0.00
## 8  30.30 0.00
## 9  29.40 0.20
## 10 30.17 0.00</code></pre>
</div>
<div id="preparing-data" class="section level3 hasAnchor" number="14.8.2">
<h3><span class="header-section-number">14.8.2</span> Preparing Data<a href="14.8-applied-examples.html#preparing-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Note that cluster analysis does NOT generally work with missing data. Here we simply delete incomplete cases. Other possibilities include imputation, and calculation of distances using most complete subsets.</p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="14.8-applied-examples.html#cb534-1" aria-hidden="true" tabindex="-1"></a><span class="co">#removing observations with NA</span></span>
<span id="cb534-2"><a href="14.8-applied-examples.html#cb534-2" aria-hidden="true" tabindex="-1"></a>dailysub <span class="ot">&lt;-</span> daily[<span class="fu">complete.cases</span>(daily), ] </span>
<span id="cb534-3"><a href="14.8-applied-examples.html#cb534-3" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(dailysub)</span></code></pre></div>
<pre><code>##         vars    n    mean      sd  median trimmed     mad     min     max
## id         1 1376 3276.28 1279.88 3271.50 3302.24 1497.43 1010.00 5327.00
## slphrs     2 1376    7.20    1.81    7.00    7.20    1.48    0.00   18.00
## weath      3 1376    2.00    1.29    2.00    2.00    1.48    0.00    4.00
## lteq       4 1376   12.50   10.42    9.00   11.24    8.90    0.00   58.00
## pss        5 1376    2.62    0.68    2.75    2.64    0.74    0.00    4.00
## se         6 1376    3.43    0.99    3.00    3.46    1.48    1.00    5.00
## swls       7 1376    4.11    1.27    4.20    4.15    1.19    1.00    7.00
## evalday    8 1376    0.68    0.46    1.00    0.73    0.00    0.00    1.00
## posaff     9 1376    4.11    1.10    4.20    4.14    1.19    1.00    7.00
## negaff    10 1376    2.45    1.04    2.20    2.34    1.04    1.00    6.90
## temp      11 1376   40.18    7.88   42.00   40.51    8.90   20.80   56.00
## hum       12 1376    0.62    0.20    0.66    0.63    0.21    0.24    0.90
## wind      13 1376    7.36    4.45    7.00    6.81    4.45    0.70   20.00
## bar       14 1376   30.02    0.33   30.00   30.04    0.43   29.32   30.54
## prec      15 1376    0.05    0.09    0.00    0.03    0.00    0.00    0.30
##           range  skew kurtosis    se
## id      4317.00 -0.10    -1.04 34.50
## slphrs    18.00  0.12     1.93  0.05
## weath      4.00 -0.06    -1.06  0.03
## lteq      58.00  1.07     0.95  0.28
## pss        4.00 -0.37     0.17  0.02
## se         4.00 -0.40    -0.12  0.03
## swls       6.00 -0.28    -0.22  0.03
## evalday    1.00 -0.79    -1.37  0.01
## posaff     6.00 -0.24    -0.37  0.03
## negaff     5.90  0.95     0.67  0.03
## temp      35.20 -0.37    -0.24  0.21
## hum        0.66 -0.36    -1.10  0.01
## wind      19.30  0.97     0.86  0.12
## bar        1.22 -0.39    -0.90  0.01
## prec       0.30  1.85     1.98  0.00</code></pre>
</div>
<div id="scaling" class="section level3 hasAnchor" number="14.8.3">
<h3><span class="header-section-number">14.8.3</span> Scaling<a href="14.8-applied-examples.html#scaling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The unit of distance may be different for different variables. For example, one year of difference in age seems like it should be a larger difference than one dollar difference in income.</p>
<p>Different variables will be weighted differently in the distance calculation. To alleviate this, a common approach is to rescale each variable into a standardized, <em>z-score</em> variable (i.e., by subtracting the mean and dividing by the standard deviation).</p>
<p>Thus, all the variables would then have mean = 0, with differences scales in standard deviation units. Note that this scales everything in relation to the observed sample (which has plusses and minuses).</p>
<p>The R function <code>scale()</code> makes it all very easy.</p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="14.8-applied-examples.html#cb536-1" aria-hidden="true" tabindex="-1"></a><span class="co">#scaling all the variables</span></span>
<span id="cb536-2"><a href="14.8-applied-examples.html#cb536-2" aria-hidden="true" tabindex="-1"></a>dailyscale <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">scale</span>(dailysub, <span class="at">center=</span><span class="cn">TRUE</span>, <span class="at">scale=</span><span class="cn">TRUE</span>))</span>
<span id="cb536-3"><a href="14.8-applied-examples.html#cb536-3" aria-hidden="true" tabindex="-1"></a><span class="co">#checking and fixing the id variable (which we did not want standardized)</span></span>
<span id="cb536-4"><a href="14.8-applied-examples.html#cb536-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dailyscale<span class="sc">$</span>id)</span></code></pre></div>
<pre><code>##  num [1:1376] -1.77 -1.77 -1.77 -1.77 -1.77 ...</code></pre>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="14.8-applied-examples.html#cb538-1" aria-hidden="true" tabindex="-1"></a>dailyscale<span class="sc">$</span>id <span class="ot">&lt;-</span> dailysub<span class="sc">$</span>id</span>
<span id="cb538-2"><a href="14.8-applied-examples.html#cb538-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dailyscale<span class="sc">$</span>id)</span></code></pre></div>
<pre><code>##  num [1:1376] 1010 1011 1012 1013 1014 ...</code></pre>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="14.8-applied-examples.html#cb540-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(dailyscale)</span></code></pre></div>
<pre><code>##         vars    n    mean      sd  median trimmed     mad     min     max
## id         1 1376 3276.28 1279.88 3271.50 3302.24 1497.43 1010.00 5327.00
## slphrs     2 1376    0.00    1.00   -0.11    0.00    0.82   -3.98    5.98
## weath      3 1376    0.00    1.00    0.00    0.00    1.15   -1.55    1.54
## lteq       4 1376    0.00    1.00   -0.34   -0.12    0.85   -1.20    4.37
## pss        5 1376    0.00    1.00    0.19    0.03    1.08   -3.83    2.02
## se         6 1376    0.00    1.00   -0.43    0.04    1.49   -2.45    1.58
## swls       7 1376    0.00    1.00    0.07    0.03    0.93   -2.45    2.27
## evalday    8 1376    0.00    1.00    0.68    0.10    0.00   -1.47    0.68
## posaff     9 1376    0.00    1.00    0.08    0.03    1.08   -2.82    2.63
## negaff    10 1376    0.00    1.00   -0.24   -0.11    1.00   -1.40    4.28
## temp      11 1376    0.00    1.00    0.23    0.04    1.13   -2.46    2.01
## hum       12 1376    0.00    1.00    0.20    0.05    1.06   -1.94    1.42
## wind      13 1376    0.00    1.00   -0.08   -0.12    1.00   -1.50    2.84
## bar       14 1376    0.00    1.00   -0.05    0.06    1.29   -2.09    1.56
## prec      15 1376    0.00    1.00   -0.53   -0.26    0.00   -0.53    2.68
##           range  skew kurtosis    se
## id      4317.00 -0.10    -1.04 34.50
## slphrs     9.97  0.12     1.93  0.03
## weath      3.09 -0.06    -1.06  0.03
## lteq       5.57  1.07     0.95  0.03
## pss        5.85 -0.37     0.17  0.03
## se         4.03 -0.40    -0.12  0.03
## swls       4.72 -0.28    -0.22  0.03
## evalday    2.15 -0.79    -1.37  0.03
## posaff     5.45 -0.24    -0.37  0.03
## negaff     5.68  0.95     0.67  0.03
## temp       4.47 -0.37    -0.24  0.03
## hum        3.36 -0.36    -1.10  0.03
## wind       4.33  0.97     0.86  0.03
## bar        3.65 -0.39    -0.90  0.03
## prec       3.21  1.85     1.98  0.03</code></pre>
</div>
<div id="plotting" class="section level3 hasAnchor" number="14.8.4">
<h3><span class="header-section-number">14.8.4</span> Plotting<a href="14.8-applied-examples.html#plotting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We choose a small subset of variables for easy visualization in a bivariate space. We use <code>lteq</code>, a measure of physical activity (Leisure Time Exercise Questionnaire), and <code>posaff</code>, a measure of positive affect.</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="14.8-applied-examples.html#cb542-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dailyscale,<span class="fu">aes</span>(<span class="at">x=</span>lteq,<span class="at">y=</span>posaff)) <span class="sc">+</span></span>
<span id="cb542-2"><a href="14.8-applied-examples.html#cb542-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-298-1.png" width="672" /></p>
<p>This is a good toy data set for class purposes, but keep in mind the original nature of the data which might not be the best for cluster analytic purposes.</p>
</div>
<div id="distances-1" class="section level3 hasAnchor" number="14.8.5">
<h3><span class="header-section-number">14.8.5</span> Distances<a href="14.8-applied-examples.html#distances-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Each individual is conceptualized as a point in a multivariate space. For example, lets look at the first three individuals.</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="14.8-applied-examples.html#cb543-1" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> dailyscale[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">12</span>),<span class="fu">c</span>(<span class="st">&quot;id&quot;</span>,<span class="st">&quot;lteq&quot;</span>,<span class="st">&quot;posaff&quot;</span>)]</span>
<span id="cb543-2"><a href="14.8-applied-examples.html#cb543-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data1,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##      id       lteq     posaff
## 1  1010 -0.2399597 -0.1889168
## 3  1012 -0.2399597  0.9016850
## 14 1025 -0.4318716  0.5381510</code></pre>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="14.8-applied-examples.html#cb545-1" aria-hidden="true" tabindex="-1"></a>labels.abc <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>)</span>
<span id="cb545-2"><a href="14.8-applied-examples.html#cb545-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data1,<span class="fu">aes</span>(<span class="at">x=</span>lteq,<span class="at">y=</span>posaff)) <span class="sc">+</span></span>
<span id="cb545-3"><a href="14.8-applied-examples.html#cb545-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">fill=</span><span class="st">&quot;blue&quot;</span>,<span class="at">alpha=</span>.<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb545-4"><a href="14.8-applied-examples.html#cb545-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb545-5"><a href="14.8-applied-examples.html#cb545-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span>lteq<span class="fl">-.1</span>,<span class="at">label=</span>labels.abc)) <span class="sc">+</span></span>
<span id="cb545-6"><a href="14.8-applied-examples.html#cb545-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-299-1.png" width="672" /></p>
<p>Lets look at the distances. Euclidean Distance is calculated as</p>
<p><span class="math display">\[
EuclideanDistance_{A,B} = \sqrt{(x_{a} - x_{b})^2 + (y_{a} - y_{b})^2}
\]</span></p>
<p>and easily implemented using the <code>dist()</code> function.</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="14.8-applied-examples.html#cb546-1" aria-hidden="true" tabindex="-1"></a>dist.abc <span class="ot">&lt;-</span> <span class="fu">dist</span>(data1[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>],<span class="at">method=</span><span class="st">&quot;euclidean&quot;</span>,<span class="at">diag=</span><span class="cn">TRUE</span>,<span class="at">upper=</span><span class="cn">FALSE</span>)</span>
<span id="cb546-2"><a href="14.8-applied-examples.html#cb546-2" aria-hidden="true" tabindex="-1"></a>dist.abc</span></code></pre></div>
<pre><code>##            1         3        14
## 1  0.0000000                    
## 3  1.0906017 0.0000000          
## 14 0.7519693 0.4110804 0.0000000</code></pre>
<p>Might also use a different distance measure, such as Manhattan Distance  The distance between two points in a grid based on a strictly horizontal and/or vertical path (that is, along the grid lines), as opposed to the diagonal or as the crow flies distance.</p>
<p>The Manhattan distance is the simple sum of the horizontal and vertical components, whereas the diagonal distance might be computed by applying the Pythagorean theorem.</p>
<p><span class="math display">\[
ManhattanDistance_{A,B} = |x_{a} - x_{b}| + |y_{a} - y_{b}|$
\]</span></p>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="14.8-applied-examples.html#cb548-1" aria-hidden="true" tabindex="-1"></a>dist.abc2 <span class="ot">&lt;-</span> <span class="fu">dist</span>(data1[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>],<span class="at">method=</span><span class="st">&quot;manhattan&quot;</span>,<span class="at">diag=</span><span class="cn">TRUE</span>,<span class="at">upper=</span><span class="cn">FALSE</span>)</span>
<span id="cb548-2"><a href="14.8-applied-examples.html#cb548-2" aria-hidden="true" tabindex="-1"></a>dist.abc2</span></code></pre></div>
<pre><code>##            1         3        14
## 1  0.0000000                    
## 3  1.0906017 0.0000000          
## 14 0.9189797 0.5554458 0.0000000</code></pre>
<p>The great thing about the distances is that they scale up to distance in many dimensions.</p>
</div>
<div id="k-means" class="section level3 hasAnchor" number="14.8.6">
<h3><span class="header-section-number">14.8.6</span> K-Means<a href="14.8-applied-examples.html#k-means" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Basic clustering in the social sciences often makes use of the <em>K-means</em> procedure.</p>
<p>The k-means algorithm is a traditional and widely used clustering algorithm.</p>
<p>In brief, the algorithm begins by specifying the number of clusters we are interested in. This is the <em>k</em>. Each of the <em>k</em> clusters is identified by the vector of the average (i.e., the mean) value of each of the variables for observations within a cluster. A random clustering is constructed (random set of mean vectors).</p>
<p>The <em>k</em> means are calculated. Then, using the distance measure, we gravitate each observation to its nearest mean. The means are then recalculated and the points re-gravitate. And so on until there is no further change to the means.</p>
<p>Lets see an example where we chose <span class="math inline">\(K=4\)</span>.</p>
<p>We use the R function <code>kmeans()</code>.</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="14.8-applied-examples.html#cb550-1" aria-hidden="true" tabindex="-1"></a><span class="co">#there are random starts involved so we set a seed</span></span>
<span id="cb550-2"><a href="14.8-applied-examples.html#cb550-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb550-3"><a href="14.8-applied-examples.html#cb550-3" aria-hidden="true" tabindex="-1"></a><span class="co">#running a cluster analysis</span></span>
<span id="cb550-4"><a href="14.8-applied-examples.html#cb550-4" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(dailyscale[,<span class="fu">c</span>(<span class="st">&quot;lteq&quot;</span>,<span class="st">&quot;posaff&quot;</span>)], <span class="at">centers=</span><span class="dv">4</span>)</span>
<span id="cb550-5"><a href="14.8-applied-examples.html#cb550-5" aria-hidden="true" tabindex="-1"></a>model</span></code></pre></div>
<pre><code>## K-means clustering with 4 clusters of sizes 377, 578, 240, 181
## 
## Cluster means:
##         lteq     posaff
## 1 -0.6558537 -1.0705106
## 2 -0.4408363  0.6996343
## 3  0.7763740 -0.5678819
## 4  1.7443674  0.7485388
## 
## Clustering vector:
##    1    2    3    4    5    6    7    9   10   11   13   14   15   17   18   19 
##    2    1    2    2    3    3    4    2    4    2    2    2    1    2    2    2 
##   20   21   22   23   27   28   29   30   31   32   37   38   39   40   41   42 
##    1    1    1    4    1    1    1    1    2    2    2    2    2    2    1    2 
##   43   44   47   48   49   51   52   53   54   55   56   57   58   59   60   61 
##    2    1    2    2    2    2    2    2    2    1    3    3    1    1    1    3 
##   62   63   64   66   67   68   70   71   72   73   74   75   76   77   78   79 
##    3    2    4    3    1    3    2    2    2    2    2    2    2    1    2    3 
##   81   84   85   86   87   88   89   90   91   92   93   95   96   97   98   99 
##    2    1    3    1    2    2    2    4    4    4    4    2    2    2    2    4 
##  101  102  103  105  106  107  108  110  111  112  113  114  115  116  117  118 
##    4    3    2    3    4    4    3    2    4    4    4    4    4    2    4    4 
##  119  120  121  122  123  124  125  126  127  128  129  130  131  132  133  134 
##    4    3    1    1    1    1    1    1    1    2    2    2    2    2    2    2 
##  135  136  137  138  140  141  143  144  145  146  147  149  150  151  152  153 
##    2    4    4    2    3    3    3    4    3    4    4    4    4    4    1    3 
##  154  155  156  157  158  159  160  161  162  163  164  165  166  167  168  169 
##    2    3    2    3    3    2    2    2    2    2    2    2    2    2    2    2 
##  170  171  172  173  174  175  176  177  178  179  180  181  182  183  184  185 
##    1    2    3    1    1    1    1    1    1    1    1    2    2    2    3    3 
##  186  187  188  189  190  191  192  193  194  196  197  198  199  201  202  203 
##    2    4    4    4    3    3    4    1    1    2    2    2    2    2    4    4 
##  204  205  206  208  209  210  211  212  213  214  215  216  217  218  219  220 
##    2    2    4    4    4    2    2    2    2    2    2    1    2    3    3    1 
##  221  222  223  224  225  226  228  229  230  231  232  233  234  235  236  237 
##    1    3    3    3    3    2    2    2    1    1    2    3    3    2    3    1 
##  238  239  240  241  242  243  244  245  246  247  248  249  250  251  252  253 
##    2    2    1    1    3    3    2    3    3    2    3    2    3    3    3    3 
##  254  255  256  257  258  259  260  261  262  263  264  265  266  267  268  269 
##    3    4    3    3    2    2    2    2    1    2    2    2    2    1    2    1 
##  270  271  272  273  274  275  276  277  278  279  280  281  282  283  285  286 
##    3    3    2    2    2    2    1    1    1    2    1    1    1    3    3    1 
##  287  288  289  290  291  292  293  294  295  296  297  298  299  300  301  302 
##    1    2    2    1    1    1    1    1    1    2    2    2    3    1    2    1 
##  303  304  305  306  307  308  309  312  313  314  315  316  317  318  319  320 
##    3    2    2    2    2    2    1    2    2    2    2    3    3    1    1    2 
##  321  323  324  325  326  327  328  329  330  331  332  333  334  335  343  344 
##    2    2    2    2    2    2    2    4    2    2    2    2    2    2    3    2 
##  345  346  347  348  349  350  352  353  354  355  356  358  359  360  361  364 
##    1    2    1    2    2    2    2    2    2    1    1    1    1    2    4    4 
##  365  366  367  368  369  370  371  372  373  374  376  377  378  379  380  381 
##    4    4    2    2    2    2    3    2    2    3    1    1    1    2    2    1 
##  382  383  384  385  386  387  388  389  390  391  392  393  394  395  396  397 
##    1    2    3    2    3    2    2    3    3    3    3    4    1    1    4    3 
##  398  399  400  401  402  403  404  405  406  407  408  409  410  411  412  413 
##    4    4    4    1    1    4    4    3    4    1    1    1    2    1    1    1 
##  414  415  416  417  418  419  422  423  424  425  426  427  428  429  430  431 
##    1    2    2    2    2    2    1    2    3    3    4    3    3    4    4    2 
##  432  433  434  435  436  437  438  439  441  442  443  444  445  446  447  448 
##    2    2    2    2    3    1    1    3    2    2    3    3    3    3    2    2 
##  449  450  451  452  453  454  455  456  457  458  459  460  461  462  463  464 
##    2    2    2    2    2    2    1    1    1    1    3    3    1    3    2    2 
##  465  466  467  468  469  470  471  472  473  474  475  476  477  478  479  480 
##    1    1    2    2    2    1    2    2    3    3    2    1    1    1    1    1 
##  481  483  485  486  487  488  489  490  491  492  493  494  495  496  497  498 
##    2    1    2    2    2    1    1    1    1    1    1    2    1    2    1    1 
##  499  500  501  502  503  504  505  506  507  508  509  510  511  512  513  514 
##    1    1    2    2    3    3    3    3    3    2    2    2    2    2    2    2 
##  515  516  517  518  519  520  521  522  523  524  525  526  527  528  529  530 
##    1    1    4    3    2    2    4    2    4    4    1    1    1    2    3    3 
##  531  533  534  535  536  537  538  539  540  541  542  543  544  545  546  548 
##    3    3    4    4    4    1    1    1    1    1    1    1    4    4    2    4 
##  549  550  551  552  553  554  555  556  557  558  559  560  561  562  563  564 
##    4    2    2    2    4    3    3    4    1    3    4    2    3    1    1    2 
##  565  566  567  568  569  570  571  572  573  574  575  576  577  578  579  580 
##    3    1    1    2    2    2    2    2    2    2    2    1    3    4    4    4 
##  581  582  583  584  585  586  587  588  589  590  591  592  593  594  595  596 
##    3    1    1    1    2    2    1    1    2    1    1    2    1    1    1    2 
##  597  598  599  601  602  603  604  605  606  607  609  610  611  612  613  614 
##    1    1    1    2    1    1    2    1    1    1    2    2    2    2    1    1 
##  615  616  617  618  619  620  621  622  623  624  625  626  628  629  630  631 
##    2    2    2    3    2    2    3    1    1    2    2    2    2    2    2    2 
##  632  633  634  635  636  637  638  639  640  641  642  643  644  645  646  647 
##    1    1    1    3    1    2    1    1    2    3    2    3    1    1    1    1 
##  648  649  650  651  652  653  654  655  656  657  658  659  660  661  662  663 
##    1    2    3    1    1    1    3    4    3    1    1    1    1    1    1    3 
##  664  665  666  667  668  669  670  671  672  673  674  675  676  677  678  679 
##    3    4    4    4    4    4    4    3    4    4    4    2    2    1    4    2 
##  680  681  682  684  685  686  687  688  689  690  691  692  693  694  696  697 
##    2    2    2    1    3    2    2    4    4    2    2    2    4    4    2    1 
##  698  699  700  701  702  703  704  705  706  707  708  709  710  711  712  713 
##    1    2    1    1    1    3    3    3    3    3    3    1    3    1    1    1 
##  714  715  716  717  719  720  721  722  723  724  725  726  727  728  731  735 
##    2    1    1    1    1    1    3    1    1    1    1    3    4    4    4    2 
##  736  737  738  739  740  741  742  743  744  745  746  747  748  749  750  751 
##    4    2    4    4    3    3    3    4    3    3    2    4    3    3    2    2 
##  752  753  754  755  757  758  759  760  761  762  763  764  765  766  767  768 
##    3    3    2    2    1    2    2    1    1    2    2    1    2    2    2    2 
##  769  770  771  772  773  774  775  776  777  778  779  780  781  782  783  784 
##    2    1    2    2    3    1    3    3    3    1    1    1    3    1    1    1 
##  785  786  787  788  789  790  791  792  793  794  795  796  797  798  799  800 
##    1    1    1    1    2    2    1    1    4    4    4    1    3    2    4    4 
##  801  802  803  804  805  806  807  808  809  810  811  812  813  814  815  816 
##    4    4    4    1    3    1    2    2    2    2    2    2    2    1    1    1 
##  817  819  820  821  822  823  824  825  826  827  828  829  830  831  832  833 
##    2    1    1    1    1    2    2    2    1    2    1    4    1    1    2    2 
##  834  835  836  837  838  839  840  841  842  843  844  845  846  847  848  849 
##    1    4    1    2    2    2    1    2    2    2    3    3    3    1    3    2 
##  850  851  852  853  854  855  856  857  858  859  860  861  862  863  864  866 
##    2    1    2    1    3    2    2    4    4    2    4    2    4    4    3    4 
##  867  868  869  871  872  873  874  875  876  877  878  879  880  881  882  883 
##    3    4    4    3    4    3    4    1    1    4    1    1    2    1    2    1 
##  884  885  886  887  888  889  890  891  892  893  894  895  896  897  898  899 
##    1    2    2    1    1    1    2    1    2    2    3    3    2    2    1    2 
##  900  901  902  903  904  905  906  907  908  909  910  911  912  913  914  915 
##    2    2    2    2    2    1    3    1    2    2    3    3    3    1    3    3 
##  916  917  918  919  920  921  922  923  924  925  926  927  928  929  930  931 
##    3    3    2    3    2    3    2    1    2    1    2    2    1    2    2    2 
##  932  933  934  935  936  937  938  940  942  943  944  945  946  947  948  949 
##    1    2    4    4    4    4    4    2    2    2    2    2    1    3    2    2 
##  950  951  952  953  956  957  958  959  960  961  962  963  964  965  966  967 
##    3    3    2    1    1    1    2    2    2    3    3    3    3    2    3    3 
##  968  969  970  971  972  973  974  976  977  978  979  980  982  983  984  985 
##    2    1    1    3    4    3    1    2    2    3    3    3    2    2    2    2 
##  986  987  988  989  990  991  992  993  994  995  996  997  998  999 1000 1001 
##    1    3    3    1    3    3    2    2    4    3    3    3    1    2    3    1 
## 1002 1003 1004 1005 1006 1007 1008 1009 1011 1012 1013 1014 1015 1016 1017 1018 
##    3    4    3    4    1    2    2    2    1    1    2    3    3    3    4    4 
## 1019 1020 1021 1022 1023 1024 1025 1026 1027 1028 1029 1030 1031 1032 1033 1034 
##    2    2    2    1    3    3    3    4    4    1    2    1    3    1    1    1 
## 1035 1036 1037 1038 1039 1040 1041 1042 1043 1044 1045 1046 1047 1048 1049 1050 
##    1    1    1    2    2    2    2    2    2    2    2    4    2    2    2    2 
## 1051 1052 1053 1054 1055 1056 1057 1058 1059 1060 1061 1062 1064 1065 1066 1067 
##    4    2    4    2    2    2    2    1    1    1    1    3    3    1    3    2 
## 1068 1069 1070 1071 1072 1073 1074 1075 1076 1077 1078 1079 1080 1081 1082 1083 
##    2    3    2    4    2    3    3    3    4    2    2    2    2    1    2    1 
## 1084 1085 1086 1087 1088 1089 1090 1091 1092 1093 1094 1095 1096 1097 1098 1099 
##    3    2    2    2    2    2    2    2    2    2    2    2    2    2    2    2 
## 1100 1101 1102 1103 1104 1105 1106 1107 1108 1109 1110 1111 1112 1113 1114 1115 
##    2    2    1    2    1    1    2    1    2    2    4    2    4    2    2    2 
## 1116 1117 1118 1119 1120 1121 1122 1123 1124 1125 1126 1127 1128 1129 1130 1131 
##    2    2    2    3    3    3    1    3    2    2    2    2    2    2    4    4 
## 1132 1133 1134 1135 1136 1137 1138 1139 1140 1141 1142 1143 1144 1145 1146 1147 
##    4    2    2    4    2    4    4    3    4    4    2    2    2    3    2    2 
## 1148 1149 1150 1151 1152 1153 1154 1156 1157 1158 1160 1161 1162 1163 1164 1165 
##    2    2    2    2    1    2    2    1    2    1    2    2    2    1    1    1 
## 1166 1167 1168 1169 1170 1171 1172 1173 1174 1175 1176 1177 1178 1179 1180 1181 
##    2    4    4    1    3    1    4    2    4    3    3    2    3    3    4    4 
## 1182 1183 1184 1185 1186 1187 1188 1189 1190 1191 1192 1193 1194 1195 1196 1197 
##    1    2    2    1    2    2    3    1    3    3    4    2    2    4    2    4 
## 1198 1199 1200 1201 1202 1203 1204 1205 1207 1208 1209 1210 1211 1212 1213 1215 
##    2    2    2    2    2    2    1    1    2    1    2    2    2    2    2    2 
## 1216 1217 1218 1219 1220 1221 1222 1223 1224 1225 1226 1227 1228 1229 1230 1231 
##    2    1    2    2    2    2    1    2    1    2    2    1    2    1    4    4 
## 1232 1233 1234 1235 1236 1237 1238 1239 1240 1241 1242 1243 1244 1245 1246 1247 
##    4    3    4    4    3    3    2    2    1    2    2    2    1    1    2    2 
## 1248 1249 1250 1251 1252 1253 1254 1255 1256 1257 1258 1259 1260 1261 1262 1263 
##    2    3    1    2    4    2    4    4    2    4    4    4    3    4    2    2 
## 1264 1265 1266 1267 1268 1269 1270 1271 1272 1273 1274 1275 1276 1277 1278 1279 
##    2    2    3    2    1    3    2    3    4    4    1    2    2    4    2    2 
## 1280 1281 1282 1283 1284 1285 1286 1287 1288 1289 1290 1291 1292 1293 1294 1295 
##    2    2    1    1    1    1    2    1    1    1    2    2    2    2    2    2 
## 1296 1297 1298 1299 1300 1301 1302 1304 1305 1306 1307 1308 1309 1310 1311 1312 
##    3    1    3    2    2    2    2    1    1    1    1    2    2    2    2    2 
## 1313 1314 1315 1316 1317 1318 1319 1320 1321 1322 1323 1324 1325 1326 1327 1328 
##    2    2    2    2    1    2    2    2    2    1    2    2    2    1    2    1 
## 1329 1330 1331 1332 1333 1334 1335 1336 1337 1338 1339 1340 1341 1342 1343 1344 
##    1    1    1    4    1    3    2    3    3    3    3    2    2    2    2    2 
## 1345 1346 1347 1348 1349 1350 1351 1352 1353 1354 1355 1356 1357 1358 1359 1360 
##    1    2    2    2    2    2    2    2    2    2    2    2    2    2    2    2 
## 1361 1362 1363 1364 1365 1366 1367 1368 1369 1370 1371 1372 1373 1374 1375 1376 
##    2    2    2    2    2    2    2    2    1    2    2    4    4    3    1    4 
## 1377 1378 1379 1380 1381 1382 1383 1384 1385 1386 1387 1388 1389 1390 1391 1392 
##    3    3    3    4    1    2    2    4    4    4    4    1    1    1    1    1 
## 1393 1394 1395 1396 1397 1398 1400 1401 1402 1403 1404 1405 1406 1407 1408 1409 
##    1    1    1    3    3    3    2    3    3    4    1    1    2    2    1    2 
## 1410 1411 1412 1413 1414 1415 1416 1417 1418 1419 1420 1421 1422 1423 1424 1425 
##    3    2    1    2    2    1    1    1    1    2    1    2    1    1    1    1 
## 1426 1427 1429 1430 1431 1432 1433 1434 1435 1436 1437 1438 1439 1440 1441 1442 
##    1    2    4    4    4    3    1    3    4    3    1    1    1    1    1    1 
## 1443 1444 1445 1446 1447 1448 1449 1450 1451 1452 1453 1454 1455 1456 1457 1458 
##    2    1    1    1    1    1    1    1    3    1    2    2    1    3    2    2 
## 
## Within cluster sum of squares by cluster:
## [1] 201.2980 329.1644 175.7229 180.1350
##  (between_SS / total_SS =  67.8 %)
## 
## Available components:
## 
## [1] &quot;cluster&quot;      &quot;centers&quot;      &quot;totss&quot;        &quot;withinss&quot;     &quot;tot.withinss&quot;
## [6] &quot;betweenss&quot;    &quot;size&quot;         &quot;iter&quot;         &quot;ifault&quot;</code></pre>
<p>That is a lot of output! - but pretty easy to walk through and understand. The algorithm even gives a within cluster sum of squares, which is a measure of the explained variance.</p>
<p>Lets extract the mean vectors and plot for a more intuitive understanding of the results.</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="14.8-applied-examples.html#cb552-1" aria-hidden="true" tabindex="-1"></a><span class="co">#getting centers</span></span>
<span id="cb552-2"><a href="14.8-applied-examples.html#cb552-2" aria-hidden="true" tabindex="-1"></a>model<span class="sc">$</span>centers</span></code></pre></div>
<pre><code>##         lteq     posaff
## 1 -0.6558537 -1.0705106
## 2 -0.4408363  0.6996343
## 3  0.7763740 -0.5678819
## 4  1.7443674  0.7485388</code></pre>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="14.8-applied-examples.html#cb554-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting clustered data points with k means</span></span>
<span id="cb554-2"><a href="14.8-applied-examples.html#cb554-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dailyscale,<span class="fu">aes</span>(<span class="at">x=</span>lteq,<span class="at">y=</span>posaff)) <span class="sc">+</span></span>
<span id="cb554-3"><a href="14.8-applied-examples.html#cb554-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span>model<span class="sc">$</span>cluster, <span class="at">alpha=</span>.<span class="dv">6</span>) <span class="sc">+</span><span class="co">#plotting all the points</span></span>
<span id="cb554-4"><a href="14.8-applied-examples.html#cb554-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#plotting the centroids</span></span>
<span id="cb554-5"><a href="14.8-applied-examples.html#cb554-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>model<span class="sc">$</span>centers[<span class="dv">1</span>,<span class="dv">1</span>],<span class="at">y=</span>model<span class="sc">$</span>centers[<span class="dv">1</span>,<span class="dv">2</span>]),<span class="at">color=</span><span class="dv">1</span>,<span class="at">size=</span><span class="dv">5</span>,<span class="at">shape=</span><span class="dv">18</span>) <span class="sc">+</span></span>
<span id="cb554-6"><a href="14.8-applied-examples.html#cb554-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>model<span class="sc">$</span>centers[<span class="dv">2</span>,<span class="dv">1</span>],<span class="at">y=</span>model<span class="sc">$</span>centers[<span class="dv">2</span>,<span class="dv">2</span>]),<span class="at">color=</span><span class="dv">2</span>,<span class="at">size=</span><span class="dv">5</span>,<span class="at">shape=</span><span class="dv">18</span>) <span class="sc">+</span></span>
<span id="cb554-7"><a href="14.8-applied-examples.html#cb554-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>model<span class="sc">$</span>centers[<span class="dv">3</span>,<span class="dv">1</span>],<span class="at">y=</span>model<span class="sc">$</span>centers[<span class="dv">3</span>,<span class="dv">2</span>]),<span class="at">color=</span><span class="dv">3</span>,<span class="at">size=</span><span class="dv">5</span>,<span class="at">shape=</span><span class="dv">18</span>) <span class="sc">+</span></span>
<span id="cb554-8"><a href="14.8-applied-examples.html#cb554-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>model<span class="sc">$</span>centers[<span class="dv">4</span>,<span class="dv">1</span>],<span class="at">y=</span>model<span class="sc">$</span>centers[<span class="dv">4</span>,<span class="dv">2</span>]),<span class="at">color=</span><span class="dv">4</span>,<span class="at">size=</span><span class="dv">5</span>,<span class="at">shape=</span><span class="dv">18</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-303-1.png" width="672" /></p>
<div id="evaluation-of-clustering-quality" class="section level4 hasAnchor" number="14.8.6.1">
<h4><span class="header-section-number">14.8.6.1</span> Evaluation of Clustering Quality<a href="14.8-applied-examples.html#evaluation-of-clustering-quality" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Numerous measures are available for evaluating a clustering. Many are stored within the model object returned by <code>kmeans()</code>.</p>
<p>A basic concept for evaluating the quality of the clusters is the <em>sum of squares</em>. This is typically a sum of the square of the distances between observations.</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="14.8-applied-examples.html#cb555-1" aria-hidden="true" tabindex="-1"></a>model<span class="sc">$</span>totss</span></code></pre></div>
<pre><code>## [1] 2750</code></pre>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="14.8-applied-examples.html#cb557-1" aria-hidden="true" tabindex="-1"></a>model<span class="sc">$</span>withinss</span></code></pre></div>
<pre><code>## [1] 201.2980 329.1644 175.7229 180.1350</code></pre>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="14.8-applied-examples.html#cb559-1" aria-hidden="true" tabindex="-1"></a>model<span class="sc">$</span>tot.withinss</span></code></pre></div>
<pre><code>## [1] 886.3203</code></pre>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="14.8-applied-examples.html#cb561-1" aria-hidden="true" tabindex="-1"></a>model<span class="sc">$</span>betweenss</span></code></pre></div>
<pre><code>## [1] 1863.68</code></pre>
<p>Evaluation of the sum of squares can help us both evaluate the quality of any given solution, as well as help us choose the number of clusters, <em>k</em>, needed to describe the data.</p>
<p><strong>Evaluation: Within Sum of Squares</strong></p>
<p>The within sum of squares is a measure of how <em>close</em> the observations are within the clusters. For a single cluster this is calculated as the average squared distance of each observation within the cluster from the cluster mean. Then the total within sum of squares is the sum of the within sum of squares over all clusters.</p>
<p>The total within sum of squares generally decreases as the number of clusters increases. As we increase the number of clusters they individually tend to become smaller and the observations closer together within the clusters. As <em>k</em> increases, the changes in the total within sum of squares would be expected to reduce, and so it flattens out. A good value of <em>k</em> might be where the reduction in the total weighted sum of squares begins to flatten.</p>
<p>General rule of thumb: Aim to minimize the total within sum of squares (achieve within-group similarity).</p>
<p><strong>Evaluation: Between Sum of Squares</strong></p>
<p>The between sum or squares is a measure of how <em>far</em> the clusters are from each other.</p>
<p>General rule of thumb: Aim to maximize the between sum of squares (achieve between-group dissimilarity).</p>
<p>A good clustering will have a small within sum of squares and a large between sum of squares.</p>
<p>So, we need to have a range of solutions to see how the within and between sum of squares looks with different <em>k</em>.</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="14.8-applied-examples.html#cb563-1" aria-hidden="true" tabindex="-1"></a><span class="co">#making a empty dataframe</span></span>
<span id="cb563-2"><a href="14.8-applied-examples.html#cb563-2" aria-hidden="true" tabindex="-1"></a>criteria <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb563-3"><a href="14.8-applied-examples.html#cb563-3" aria-hidden="true" tabindex="-1"></a><span class="co">#setting range of k                   </span></span>
<span id="cb563-4"><a href="14.8-applied-examples.html#cb563-4" aria-hidden="true" tabindex="-1"></a>nk <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb563-5"><a href="14.8-applied-examples.html#cb563-5" aria-hidden="true" tabindex="-1"></a><span class="co">#loop for range of clusters</span></span>
<span id="cb563-6"><a href="14.8-applied-examples.html#cb563-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> nk) {</span>
<span id="cb563-7"><a href="14.8-applied-examples.html#cb563-7" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(dailyscale[,<span class="fu">c</span>(<span class="st">&quot;lteq&quot;</span>,<span class="st">&quot;posaff&quot;</span>)], k)</span>
<span id="cb563-8"><a href="14.8-applied-examples.html#cb563-8" aria-hidden="true" tabindex="-1"></a>criteria <span class="ot">&lt;-</span> <span class="fu">rbind</span>(criteria,<span class="fu">c</span>(k,model<span class="sc">$</span>tot.withinss,model<span class="sc">$</span>betweenss,model<span class="sc">$</span>totss))</span>
<span id="cb563-9"><a href="14.8-applied-examples.html#cb563-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb563-10"><a href="14.8-applied-examples.html#cb563-10" aria-hidden="true" tabindex="-1"></a><span class="co">#renaming columns</span></span>
<span id="cb563-11"><a href="14.8-applied-examples.html#cb563-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(criteria) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;k&quot;</span>,<span class="st">&quot;tot.withinss&quot;</span>,<span class="st">&quot;betweenss&quot;</span>,<span class="st">&quot;totalss&quot;</span>)</span>
<span id="cb563-12"><a href="14.8-applied-examples.html#cb563-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb563-13"><a href="14.8-applied-examples.html#cb563-13" aria-hidden="true" tabindex="-1"></a><span class="co">#scree plot</span></span>
<span id="cb563-14"><a href="14.8-applied-examples.html#cb563-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(criteria, <span class="fu">aes</span>(<span class="at">x=</span>k)) <span class="sc">+</span></span>
<span id="cb563-15"><a href="14.8-applied-examples.html#cb563-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>tot.withinss),<span class="at">color=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb563-16"><a href="14.8-applied-examples.html#cb563-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>tot.withinss),<span class="at">color=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb563-17"><a href="14.8-applied-examples.html#cb563-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>betweenss),<span class="at">color=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb563-18"><a href="14.8-applied-examples.html#cb563-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>betweenss),<span class="at">color=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb563-19"><a href="14.8-applied-examples.html#cb563-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;k = number of clusters&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Sum of Squares (within = red, between = blue)&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-305-1.png" width="672" /></p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="14.8-applied-examples.html#cb564-1" aria-hidden="true" tabindex="-1"></a><span class="co">#looking at criteria</span></span>
<span id="cb564-2"><a href="14.8-applied-examples.html#cb564-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(criteria,<span class="dv">2</span>)</span></code></pre></div>
<pre><code>##     k tot.withinss betweenss totalss
## 1   1      2750.00      0.00    2750
## 2   2      1786.49    963.51    2750
## 3   3      1082.70   1667.30    2750
## 4   4       877.93   1872.07    2750
## 5   5       729.55   2020.45    2750
## 6   6       584.64   2165.36    2750
## 7   7       498.26   2251.74    2750
## 8   8       445.17   2304.83    2750
## 9   9       396.60   2353.40    2750
## 10 10       360.53   2389.47    2750
## 11 11       326.35   2423.65    2750
## 12 12       306.13   2443.87    2750
## 13 13       288.19   2461.81    2750
## 14 14       261.78   2488.22    2750
## 15 15       262.64   2487.36    2750
## 16 16       232.66   2517.34    2750
## 17 17       216.25   2533.75    2750
## 18 18       208.83   2541.17    2750
## 19 19       195.18   2554.82    2750
## 20 20       188.38   2561.62    2750</code></pre>
<p>From the scree plot, we might look for 6 clusters (but it is really hard to see any elbow).</p>
<p>There are also additional quantitative criteria that can be used to inform selection.</p>
<p>For example, the Calinski-Harabasz criterion, also known as the variance ratio criterion, is the ratio of the between sum of squares (divided by k - 1) to the within sum of squares (divided by n - k).</p>
<p>The relative values can be used to compare clusterings of a single dataset, with higher values being better clusterings. The criterion is said to work best for spherical clusters with compact centers (as with normally distributed data) using k-means with Euclidean distance.</p>
<p>And of course this is a well-trodden area of research so there are many criteria - and packages that calculate them for you - and make automated choices.</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="14.8-applied-examples.html#cb566-1" aria-hidden="true" tabindex="-1"></a><span class="co">#from library(fpc)</span></span>
<span id="cb566-2"><a href="14.8-applied-examples.html#cb566-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calinski-Harabasz</span></span>
<span id="cb566-3"><a href="14.8-applied-examples.html#cb566-3" aria-hidden="true" tabindex="-1"></a>model.manyCH <span class="ot">&lt;-</span> <span class="fu">kmeansruns</span>(dailyscale[,<span class="fu">c</span>(<span class="st">&quot;lteq&quot;</span>,<span class="st">&quot;posaff&quot;</span>)], <span class="at">krange=</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>), <span class="at">criterion=</span><span class="st">&quot;ch&quot;</span>,<span class="at">critout =</span> <span class="cn">TRUE</span>) </span></code></pre></div>
<pre><code>## 2  clusters  745.4072 
## 3  clusters  1057.359 
## 4  clusters  975.2011 
## 5  clusters  978.5366 
## 6  clusters  1019.07 
## 7  clusters  1033.765 
## 8  clusters  1016.999 
## 9  clusters  1015.787 
## 10  clusters  1010.407 
## 11  clusters  1016.261 
## 12  clusters  1025.676 
## 13  clusters  1016.533 
## 14  clusters  1010.001 
## 15  clusters  1007.922 
## 16  clusters  1010.128 
## 17  clusters  1010.531 
## 18  clusters  1019.647 
## 19  clusters  1025.941 
## 20  clusters  1023.964</code></pre>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="14.8-applied-examples.html#cb568-1" aria-hidden="true" tabindex="-1"></a>model.manyCH</span></code></pre></div>
<pre><code>## K-means clustering with 3 clusters of sizes 484, 261, 631
## 
## Cluster means:
##         lteq     posaff
## 1 -0.4338542 -1.0041922
## 2  1.6409244  0.1951617
## 3 -0.3459522  0.6895275
## 
## Clustering vector:
##    1    2    3    4    5    6    7    9   10   11   13   14   15   17   18   19 
##    1    1    3    3    3    2    2    3    3    3    3    3    1    3    3    3 
##   20   21   22   23   27   28   29   30   31   32   37   38   39   40   41   42 
##    1    1    1    3    1    1    1    1    3    3    3    3    3    3    1    3 
##   43   44   47   48   49   51   52   53   54   55   56   57   58   59   60   61 
##    3    1    3    3    3    3    3    3    3    1    2    1    1    1    1    1 
##   62   63   64   66   67   68   70   71   72   73   74   75   76   77   78   79 
##    2    3    3    1    1    3    3    3    3    3    3    3    3    1    3    3 
##   81   84   85   86   87   88   89   90   91   92   93   95   96   97   98   99 
##    3    1    1    1    3    3    3    2    2    2    2    3    3    3    3    2 
##  101  102  103  105  106  107  108  110  111  112  113  114  115  116  117  118 
##    2    2    3    1    2    2    2    3    2    2    2    2    2    3    2    2 
##  119  120  121  122  123  124  125  126  127  128  129  130  131  132  133  134 
##    2    1    1    1    1    1    1    1    1    3    3    3    3    3    3    3 
##  135  136  137  138  140  141  143  144  145  146  147  149  150  151  152  153 
##    3    2    2    3    2    3    2    2    3    2    2    2    2    2    1    2 
##  154  155  156  157  158  159  160  161  162  163  164  165  166  167  168  169 
##    3    3    3    2    3    3    3    3    3    3    3    3    3    1    3    3 
##  170  171  172  173  174  175  176  177  178  179  180  181  182  183  184  185 
##    1    3    3    1    1    1    1    1    1    1    1    3    3    3    1    3 
##  186  187  188  189  190  191  192  193  194  196  197  198  199  201  202  203 
##    3    2    2    2    1    2    2    1    1    3    3    3    3    3    2    2 
##  204  205  206  208  209  210  211  212  213  214  215  216  217  218  219  220 
##    3    3    2    2    2    3    3    3    3    3    3    1    3    1    1    1 
##  221  222  223  224  225  226  228  229  230  231  232  233  234  235  236  237 
##    1    2    1    1    1    3    3    3    1    1    3    3    3    3    1    1 
##  238  239  240  241  242  243  244  245  246  247  248  249  250  251  252  253 
##    3    1    1    1    3    3    3    2    2    3    2    3    2    1    2    2 
##  254  255  256  257  258  259  260  261  262  263  264  265  266  267  268  269 
##    1    2    2    2    3    3    3    3    1    3    3    3    3    1    3    1 
##  270  271  272  273  274  275  276  277  278  279  280  281  282  283  285  286 
##    2    3    3    3    3    3    1    1    1    3    1    1    1    1    1    1 
##  287  288  289  290  291  292  293  294  295  296  297  298  299  300  301  302 
##    1    1    3    1    1    1    1    1    1    3    3    3    1    1    3    1 
##  303  304  305  306  307  308  309  312  313  314  315  316  317  318  319  320 
##    3    3    3    3    3    3    1    3    3    3    3    3    2    1    1    3 
##  321  323  324  325  326  327  328  329  330  331  332  333  334  335  343  344 
##    3    3    3    3    3    3    3    3    3    3    3    3    3    3    1    3 
##  345  346  347  348  349  350  352  353  354  355  356  358  359  360  361  364 
##    1    3    1    3    3    3    3    3    3    1    1    1    1    3    3    2 
##  365  366  367  368  369  370  371  372  373  374  376  377  378  379  380  381 
##    2    2    3    3    3    3    3    3    3    3    1    1    1    3    3    1 
##  382  383  384  385  386  387  388  389  390  391  392  393  394  395  396  397 
##    1    3    1    3    2    3    3    1    1    3    2    2    1    1    2    2 
##  398  399  400  401  402  403  404  405  406  407  408  409  410  411  412  413 
##    2    2    2    1    1    2    2    1    2    1    1    1    3    1    1    1 
##  414  415  416  417  418  419  422  423  424  425  426  427  428  429  430  431 
##    1    3    3    3    3    3    1    3    2    3    2    2    3    2    2    3 
##  432  433  434  435  436  437  438  439  441  442  443  444  445  446  447  448 
##    3    3    3    3    3    1    1    2    3    3    1    1    2    2    3    3 
##  449  450  451  452  453  454  455  456  457  458  459  460  461  462  463  464 
##    3    3    3    3    3    3    1    1    1    1    1    1    1    1    3    3 
##  465  466  467  468  469  470  471  472  473  474  475  476  477  478  479  480 
##    1    1    3    3    3    1    3    3    2    3    3    1    1    1    1    1 
##  481  483  485  486  487  488  489  490  491  492  493  494  495  496  497  498 
##    3    1    3    3    3    1    1    1    1    1    1    3    1    3    1    1 
##  499  500  501  502  503  504  505  506  507  508  509  510  511  512  513  514 
##    1    1    3    3    1    1    1    1    1    3    3    3    3    3    3    3 
##  515  516  517  518  519  520  521  522  523  524  525  526  527  528  529  530 
##    1    1    3    2    3    3    2    3    2    2    1    1    1    3    2    1 
##  531  533  534  535  536  537  538  539  540  541  542  543  544  545  546  548 
##    2    1    2    2    2    1    1    1    1    1    1    1    3    2    3    2 
##  549  550  551  552  553  554  555  556  557  558  559  560  561  562  563  564 
##    2    3    3    3    2    2    2    2    1    2    2    3    3    1    1    3 
##  565  566  567  568  569  570  571  572  573  574  575  576  577  578  579  580 
##    2    1    1    3    3    3    3    3    3    3    3    1    2    2    2    2 
##  581  582  583  584  585  586  587  588  589  590  591  592  593  594  595  596 
##    1    1    1    1    3    3    1    1    3    1    1    3    1    1    1    3 
##  597  598  599  601  602  603  604  605  606  607  609  610  611  612  613  614 
##    1    1    1    3    1    1    3    1    1    1    3    3    3    3    1    1 
##  615  616  617  618  619  620  621  622  623  624  625  626  628  629  630  631 
##    3    3    3    3    3    3    1    1    1    3    3    3    3    3    3    3 
##  632  633  634  635  636  637  638  639  640  641  642  643  644  645  646  647 
##    1    1    1    1    1    3    1    1    3    3    3    1    1    1    1    1 
##  648  649  650  651  652  653  654  655  656  657  658  659  660  661  662  663 
##    1    3    1    1    1    1    3    2    2    1    1    1    1    1    1    1 
##  664  665  666  667  668  669  670  671  672  673  674  675  676  677  678  679 
##    2    2    2    2    2    2    2    2    2    2    2    3    3    1    2    3 
##  680  681  682  684  685  686  687  688  689  690  691  692  693  694  696  697 
##    3    3    3    1    1    3    3    2    2    3    3    3    2    2    3    1 
##  698  699  700  701  702  703  704  705  706  707  708  709  710  711  712  713 
##    1    3    1    1    1    1    2    2    2    2    1    1    2    1    1    1 
##  714  715  716  717  719  720  721  722  723  724  725  726  727  728  731  735 
##    3    1    1    1    1    1    3    1    1    1    1    1    2    2    2    3 
##  736  737  738  739  740  741  742  743  744  745  746  747  748  749  750  751 
##    2    3    3    2    1    1    1    2    3    3    3    2    1    2    3    3 
##  752  753  754  755  757  758  759  760  761  762  763  764  765  766  767  768 
##    1    1    3    3    1    3    1    1    1    3    3    1    3    3    3    3 
##  769  770  771  772  773  774  775  776  777  778  779  780  781  782  783  784 
##    3    1    3    3    1    1    2    1    2    1    1    1    1    1    1    1 
##  785  786  787  788  789  790  791  792  793  794  795  796  797  798  799  800 
##    1    1    1    1    3    3    1    1    2    2    2    1    2    3    2    2 
##  801  802  803  804  805  806  807  808  809  810  811  812  813  814  815  816 
##    2    2    2    1    2    1    3    3    3    3    3    3    3    1    1    1 
##  817  819  820  821  822  823  824  825  826  827  828  829  830  831  832  833 
##    3    1    1    1    1    3    3    3    1    3    1    2    1    1    3    3 
##  834  835  836  837  838  839  840  841  842  843  844  845  846  847  848  849 
##    1    2    1    3    3    3    1    3    3    3    3    1    1    1    2    3 
##  850  851  852  853  854  855  856  857  858  859  860  861  862  863  864  866 
##    3    1    3    1    2    3    3    3    2    3    2    3    2    2    2    2 
##  867  868  869  871  872  873  874  875  876  877  878  879  880  881  882  883 
##    3    2    2    3    2    2    2    1    1    2    1    1    3    1    3    1 
##  884  885  886  887  888  889  890  891  892  893  894  895  896  897  898  899 
##    1    3    3    1    1    1    3    1    3    3    3    1    3    3    1    3 
##  900  901  902  903  904  905  906  907  908  909  910  911  912  913  914  915 
##    3    3    3    3    3    1    1    1    3    3    1    3    1    1    2    2 
##  916  917  918  919  920  921  922  923  924  925  926  927  928  929  930  931 
##    1    2    3    3    3    3    1    1    3    1    3    3    1    3    3    3 
##  932  933  934  935  936  937  938  940  942  943  944  945  946  947  948  949 
##    1    3    2    2    2    2    2    3    3    3    3    3    1    1    1    3 
##  950  951  952  953  956  957  958  959  960  961  962  963  964  965  966  967 
##    2    3    3    1    1    1    3    3    3    1    1    1    1    3    2    2 
##  968  969  970  971  972  973  974  976  977  978  979  980  982  983  984  985 
##    3    1    1    2    2    2    1    3    3    2    1    1    3    3    3    1 
##  986  987  988  989  990  991  992  993  994  995  996  997  998  999 1000 1001 
##    1    2    1    1    3    2    3    3    2    1    2    1    1    3    2    1 
## 1002 1003 1004 1005 1006 1007 1008 1009 1011 1012 1013 1014 1015 1016 1017 1018 
##    2    2    1    2    1    3    3    3    1    1    3    1    1    2    2    2 
## 1019 1020 1021 1022 1023 1024 1025 1026 1027 1028 1029 1030 1031 1032 1033 1034 
##    3    3    3    1    2    1    3    2    2    1    3    1    1    1    1    1 
## 1035 1036 1037 1038 1039 1040 1041 1042 1043 1044 1045 1046 1047 1048 1049 1050 
##    1    1    1    3    3    3    3    3    3    3    3    3    3    3    3    3 
## 1051 1052 1053 1054 1055 1056 1057 1058 1059 1060 1061 1062 1064 1065 1066 1067 
##    2    3    2    3    3    3    3    1    1    1    1    3    2    1    1    3 
## 1068 1069 1070 1071 1072 1073 1074 1075 1076 1077 1078 1079 1080 1081 1082 1083 
##    3    3    3    2    3    2    1    2    2    3    3    3    3    1    3    1 
## 1084 1085 1086 1087 1088 1089 1090 1091 1092 1093 1094 1095 1096 1097 1098 1099 
##    3    3    3    3    3    3    3    3    3    3    3    3    3    3    3    3 
## 1100 1101 1102 1103 1104 1105 1106 1107 1108 1109 1110 1111 1112 1113 1114 1115 
##    3    3    1    3    1    1    3    1    3    3    2    3    3    3    3    3 
## 1116 1117 1118 1119 1120 1121 1122 1123 1124 1125 1126 1127 1128 1129 1130 1131 
##    3    3    3    3    2    2    1    2    3    1    3    3    3    3    2    2 
## 1132 1133 1134 1135 1136 1137 1138 1139 1140 1141 1142 1143 1144 1145 1146 1147 
##    2    3    3    2    3    2    2    2    2    2    3    3    3    3    3    3 
## 1148 1149 1150 1151 1152 1153 1154 1156 1157 1158 1160 1161 1162 1163 1164 1165 
##    3    3    3    3    1    3    3    1    3    1    3    3    3    1    1    1 
## 1166 1167 1168 1169 1170 1171 1172 1173 1174 1175 1176 1177 1178 1179 1180 1181 
##    3    2    2    1    1    1    2    3    2    2    1    3    1    3    2    3 
## 1182 1183 1184 1185 1186 1187 1188 1189 1190 1191 1192 1193 1194 1195 1196 1197 
##    1    3    3    1    3    3    1    1    1    2    2    1    3    2    3    2 
## 1198 1199 1200 1201 1202 1203 1204 1205 1207 1208 1209 1210 1211 1212 1213 1215 
##    3    3    3    3    3    3    1    1    3    1    3    3    3    3    3    3 
## 1216 1217 1218 1219 1220 1221 1222 1223 1224 1225 1226 1227 1228 1229 1230 1231 
##    3    1    3    3    3    3    1    3    1    3    3    1    3    1    2    2 
## 1232 1233 1234 1235 1236 1237 1238 1239 1240 1241 1242 1243 1244 1245 1246 1247 
##    2    2    2    2    1    1    3    3    1    3    3    3    1    1    1    3 
## 1248 1249 1250 1251 1252 1253 1254 1255 1256 1257 1258 1259 1260 1261 1262 1263 
##    3    3    1    3    2    3    2    3    3    2    2    2    2    2    3    3 
## 1264 1265 1266 1267 1268 1269 1270 1271 1272 1273 1274 1275 1276 1277 1278 1279 
##    3    3    1    3    1    3    3    3    2    2    1    3    3    2    3    3 
## 1280 1281 1282 1283 1284 1285 1286 1287 1288 1289 1290 1291 1292 1293 1294 1295 
##    3    3    1    1    1    1    3    1    1    1    3    3    3    3    3    3 
## 1296 1297 1298 1299 1300 1301 1302 1304 1305 1306 1307 1308 1309 1310 1311 1312 
##    1    1    1    3    3    3    3    1    1    1    1    3    3    3    3    3 
## 1313 1314 1315 1316 1317 1318 1319 1320 1321 1322 1323 1324 1325 1326 1327 1328 
##    3    1    3    3    1    3    3    3    3    1    3    3    3    1    3    1 
## 1329 1330 1331 1332 1333 1334 1335 1336 1337 1338 1339 1340 1341 1342 1343 1344 
##    1    1    1    2    1    2    3    1    2    2    2    3    3    3    3    3 
## 1345 1346 1347 1348 1349 1350 1351 1352 1353 1354 1355 1356 1357 1358 1359 1360 
##    1    3    3    3    3    3    3    3    3    3    3    3    3    3    3    3 
## 1361 1362 1363 1364 1365 1366 1367 1368 1369 1370 1371 1372 1373 1374 1375 1376 
##    3    3    3    3    3    3    3    3    1    3    3    2    2    1    1    2 
## 1377 1378 1379 1380 1381 1382 1383 1384 1385 1386 1387 1388 1389 1390 1391 1392 
##    2    2    2    2    1    3    3    2    3    2    3    1    1    1    1    1 
## 1393 1394 1395 1396 1397 1398 1400 1401 1402 1403 1404 1405 1406 1407 1408 1409 
##    1    1    1    2    1    2    3    2    1    2    1    1    3    3    1    3 
## 1410 1411 1412 1413 1414 1415 1416 1417 1418 1419 1420 1421 1422 1423 1424 1425 
##    1    3    1    3    3    1    1    1    1    3    1    3    1    1    1    1 
## 1426 1427 1429 1430 1431 1432 1433 1434 1435 1436 1437 1438 1439 1440 1441 1442 
##    1    3    2    2    2    2    1    2    2    3    1    1    1    1    1    1 
## 1443 1444 1445 1446 1447 1448 1449 1450 1451 1452 1453 1454 1455 1456 1457 1458 
##    3    1    1    1    1    1    1    1    2    1    3    3    1    1    3    3 
## 
## Within cluster sum of squares by cluster:
## [1] 334.8595 334.4631 413.2618
##  (between_SS / total_SS =  60.6 %)
## 
## Available components:
## 
##  [1] &quot;cluster&quot;      &quot;centers&quot;      &quot;totss&quot;        &quot;withinss&quot;     &quot;tot.withinss&quot;
##  [6] &quot;betweenss&quot;    &quot;size&quot;         &quot;iter&quot;         &quot;ifault&quot;       &quot;crit&quot;        
## [11] &quot;bestk&quot;</code></pre>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="14.8-applied-examples.html#cb570-1" aria-hidden="true" tabindex="-1"></a><span class="co">#another criteria </span></span>
<span id="cb570-2"><a href="14.8-applied-examples.html#cb570-2" aria-hidden="true" tabindex="-1"></a><span class="co"># average silhouette width</span></span>
<span id="cb570-3"><a href="14.8-applied-examples.html#cb570-3" aria-hidden="true" tabindex="-1"></a>model.manyASW <span class="ot">&lt;-</span> <span class="fu">kmeansruns</span>(dailyscale[,<span class="fu">c</span>(<span class="st">&quot;lteq&quot;</span>,<span class="st">&quot;posaff&quot;</span>)], <span class="at">krange=</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>), <span class="at">criterion=</span><span class="st">&quot;asw&quot;</span>,<span class="at">critout =</span> <span class="cn">TRUE</span>) </span></code></pre></div>
<pre><code>## 2  clusters  0.3315195 
## 3  clusters  0.3884696 
## 4  clusters  0.3543075 
## 5  clusters  0.3425395 
## 6  clusters  0.3502535 
## 7  clusters  0.3569903 
## 8  clusters  0.3417595 
## 9  clusters  0.347614 
## 10  clusters  0.3521761 
## 11  clusters  0.3606332 
## 12  clusters  0.3620871 
## 13  clusters  0.3577258 
## 14  clusters  0.3577506 
## 15  clusters  0.3558161 
## 16  clusters  0.3615249 
## 17  clusters  0.360369 
## 18  clusters  0.3470803 
## 19  clusters  0.3568075 
## 20  clusters  0.3531087</code></pre>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="14.8-applied-examples.html#cb572-1" aria-hidden="true" tabindex="-1"></a>model.manyASW</span></code></pre></div>
<pre><code>## K-means clustering with 3 clusters of sizes 631, 484, 261
## 
## Cluster means:
##         lteq     posaff
## 1 -0.3459522  0.6895275
## 2 -0.4338542 -1.0041922
## 3  1.6409244  0.1951617
## 
## Clustering vector:
##    1    2    3    4    5    6    7    9   10   11   13   14   15   17   18   19 
##    2    2    1    1    1    3    3    1    1    1    1    1    2    1    1    1 
##   20   21   22   23   27   28   29   30   31   32   37   38   39   40   41   42 
##    2    2    2    1    2    2    2    2    1    1    1    1    1    1    2    1 
##   43   44   47   48   49   51   52   53   54   55   56   57   58   59   60   61 
##    1    2    1    1    1    1    1    1    1    2    3    2    2    2    2    2 
##   62   63   64   66   67   68   70   71   72   73   74   75   76   77   78   79 
##    3    1    1    2    2    1    1    1    1    1    1    1    1    2    1    1 
##   81   84   85   86   87   88   89   90   91   92   93   95   96   97   98   99 
##    1    2    2    2    1    1    1    3    3    3    3    1    1    1    1    3 
##  101  102  103  105  106  107  108  110  111  112  113  114  115  116  117  118 
##    3    3    1    2    3    3    3    1    3    3    3    3    3    1    3    3 
##  119  120  121  122  123  124  125  126  127  128  129  130  131  132  133  134 
##    3    2    2    2    2    2    2    2    2    1    1    1    1    1    1    1 
##  135  136  137  138  140  141  143  144  145  146  147  149  150  151  152  153 
##    1    3    3    1    3    1    3    3    1    3    3    3    3    3    2    3 
##  154  155  156  157  158  159  160  161  162  163  164  165  166  167  168  169 
##    1    1    1    3    1    1    1    1    1    1    1    1    1    2    1    1 
##  170  171  172  173  174  175  176  177  178  179  180  181  182  183  184  185 
##    2    1    1    2    2    2    2    2    2    2    2    1    1    1    2    1 
##  186  187  188  189  190  191  192  193  194  196  197  198  199  201  202  203 
##    1    3    3    3    2    3    3    2    2    1    1    1    1    1    3    3 
##  204  205  206  208  209  210  211  212  213  214  215  216  217  218  219  220 
##    1    1    3    3    3    1    1    1    1    1    1    2    1    2    2    2 
##  221  222  223  224  225  226  228  229  230  231  232  233  234  235  236  237 
##    2    3    2    2    2    1    1    1    2    2    1    1    1    1    2    2 
##  238  239  240  241  242  243  244  245  246  247  248  249  250  251  252  253 
##    1    2    2    2    1    1    1    3    3    1    3    1    3    2    3    3 
##  254  255  256  257  258  259  260  261  262  263  264  265  266  267  268  269 
##    2    3    3    3    1    1    1    1    2    1    1    1    1    2    1    2 
##  270  271  272  273  274  275  276  277  278  279  280  281  282  283  285  286 
##    3    1    1    1    1    1    2    2    2    1    2    2    2    2    2    2 
##  287  288  289  290  291  292  293  294  295  296  297  298  299  300  301  302 
##    2    2    1    2    2    2    2    2    2    1    1    1    2    2    1    2 
##  303  304  305  306  307  308  309  312  313  314  315  316  317  318  319  320 
##    1    1    1    1    1    1    2    1    1    1    1    1    3    2    2    1 
##  321  323  324  325  326  327  328  329  330  331  332  333  334  335  343  344 
##    1    1    1    1    1    1    1    1    1    1    1    1    1    1    2    1 
##  345  346  347  348  349  350  352  353  354  355  356  358  359  360  361  364 
##    2    1    2    1    1    1    1    1    1    2    2    2    2    1    1    3 
##  365  366  367  368  369  370  371  372  373  374  376  377  378  379  380  381 
##    3    3    1    1    1    1    1    1    1    1    2    2    2    1    1    2 
##  382  383  384  385  386  387  388  389  390  391  392  393  394  395  396  397 
##    2    1    2    1    3    1    1    2    2    1    3    3    2    2    3    3 
##  398  399  400  401  402  403  404  405  406  407  408  409  410  411  412  413 
##    3    3    3    2    2    3    3    2    3    2    2    2    1    2    2    2 
##  414  415  416  417  418  419  422  423  424  425  426  427  428  429  430  431 
##    2    1    1    1    1    1    2    1    3    1    3    3    1    3    3    1 
##  432  433  434  435  436  437  438  439  441  442  443  444  445  446  447  448 
##    1    1    1    1    1    2    2    3    1    1    2    2    3    3    1    1 
##  449  450  451  452  453  454  455  456  457  458  459  460  461  462  463  464 
##    1    1    1    1    1    1    2    2    2    2    2    2    2    2    1    1 
##  465  466  467  468  469  470  471  472  473  474  475  476  477  478  479  480 
##    2    2    1    1    1    2    1    1    3    1    1    2    2    2    2    2 
##  481  483  485  486  487  488  489  490  491  492  493  494  495  496  497  498 
##    1    2    1    1    1    2    2    2    2    2    2    1    2    1    2    2 
##  499  500  501  502  503  504  505  506  507  508  509  510  511  512  513  514 
##    2    2    1    1    2    2    2    2    2    1    1    1    1    1    1    1 
##  515  516  517  518  519  520  521  522  523  524  525  526  527  528  529  530 
##    2    2    1    3    1    1    3    1    3    3    2    2    2    1    3    2 
##  531  533  534  535  536  537  538  539  540  541  542  543  544  545  546  548 
##    3    2    3    3    3    2    2    2    2    2    2    2    1    3    1    3 
##  549  550  551  552  553  554  555  556  557  558  559  560  561  562  563  564 
##    3    1    1    1    3    3    3    3    2    3    3    1    1    2    2    1 
##  565  566  567  568  569  570  571  572  573  574  575  576  577  578  579  580 
##    3    2    2    1    1    1    1    1    1    1    1    2    3    3    3    3 
##  581  582  583  584  585  586  587  588  589  590  591  592  593  594  595  596 
##    2    2    2    2    1    1    2    2    1    2    2    1    2    2    2    1 
##  597  598  599  601  602  603  604  605  606  607  609  610  611  612  613  614 
##    2    2    2    1    2    2    1    2    2    2    1    1    1    1    2    2 
##  615  616  617  618  619  620  621  622  623  624  625  626  628  629  630  631 
##    1    1    1    1    1    1    2    2    2    1    1    1    1    1    1    1 
##  632  633  634  635  636  637  638  639  640  641  642  643  644  645  646  647 
##    2    2    2    2    2    1    2    2    1    1    1    2    2    2    2    2 
##  648  649  650  651  652  653  654  655  656  657  658  659  660  661  662  663 
##    2    1    2    2    2    2    1    3    3    2    2    2    2    2    2    2 
##  664  665  666  667  668  669  670  671  672  673  674  675  676  677  678  679 
##    3    3    3    3    3    3    3    3    3    3    3    1    1    2    3    1 
##  680  681  682  684  685  686  687  688  689  690  691  692  693  694  696  697 
##    1    1    1    2    2    1    1    3    3    1    1    1    3    3    1    2 
##  698  699  700  701  702  703  704  705  706  707  708  709  710  711  712  713 
##    2    1    2    2    2    2    3    3    3    3    2    2    3    2    2    2 
##  714  715  716  717  719  720  721  722  723  724  725  726  727  728  731  735 
##    1    2    2    2    2    2    1    2    2    2    2    2    3    3    3    1 
##  736  737  738  739  740  741  742  743  744  745  746  747  748  749  750  751 
##    3    1    1    3    2    2    2    3    1    1    1    3    2    3    1    1 
##  752  753  754  755  757  758  759  760  761  762  763  764  765  766  767  768 
##    2    2    1    1    2    1    2    2    2    1    1    2    1    1    1    1 
##  769  770  771  772  773  774  775  776  777  778  779  780  781  782  783  784 
##    1    2    1    1    2    2    3    2    3    2    2    2    2    2    2    2 
##  785  786  787  788  789  790  791  792  793  794  795  796  797  798  799  800 
##    2    2    2    2    1    1    2    2    3    3    3    2    3    1    3    3 
##  801  802  803  804  805  806  807  808  809  810  811  812  813  814  815  816 
##    3    3    3    2    3    2    1    1    1    1    1    1    1    2    2    2 
##  817  819  820  821  822  823  824  825  826  827  828  829  830  831  832  833 
##    1    2    2    2    2    1    1    1    2    1    2    3    2    2    1    1 
##  834  835  836  837  838  839  840  841  842  843  844  845  846  847  848  849 
##    2    3    2    1    1    1    2    1    1    1    1    2    2    2    3    1 
##  850  851  852  853  854  855  856  857  858  859  860  861  862  863  864  866 
##    1    2    1    2    3    1    1    1    3    1    3    1    3    3    3    3 
##  867  868  869  871  872  873  874  875  876  877  878  879  880  881  882  883 
##    1    3    3    1    3    3    3    2    2    3    2    2    1    2    1    2 
##  884  885  886  887  888  889  890  891  892  893  894  895  896  897  898  899 
##    2    1    1    2    2    2    1    2    1    1    1    2    1    1    2    1 
##  900  901  902  903  904  905  906  907  908  909  910  911  912  913  914  915 
##    1    1    1    1    1    2    2    2    1    1    2    1    2    2    3    3 
##  916  917  918  919  920  921  922  923  924  925  926  927  928  929  930  931 
##    2    3    1    1    1    1    2    2    1    2    1    1    2    1    1    1 
##  932  933  934  935  936  937  938  940  942  943  944  945  946  947  948  949 
##    2    1    3    3    3    3    3    1    1    1    1    1    2    2    2    1 
##  950  951  952  953  956  957  958  959  960  961  962  963  964  965  966  967 
##    3    1    1    2    2    2    1    1    1    2    2    2    2    1    3    3 
##  968  969  970  971  972  973  974  976  977  978  979  980  982  983  984  985 
##    1    2    2    3    3    3    2    1    1    3    2    2    1    1    1    2 
##  986  987  988  989  990  991  992  993  994  995  996  997  998  999 1000 1001 
##    2    3    2    2    1    3    1    1    3    2    3    2    2    1    3    2 
## 1002 1003 1004 1005 1006 1007 1008 1009 1011 1012 1013 1014 1015 1016 1017 1018 
##    3    3    2    3    2    1    1    1    2    2    1    2    2    3    3    3 
## 1019 1020 1021 1022 1023 1024 1025 1026 1027 1028 1029 1030 1031 1032 1033 1034 
##    1    1    1    2    3    2    1    3    3    2    1    2    2    2    2    2 
## 1035 1036 1037 1038 1039 1040 1041 1042 1043 1044 1045 1046 1047 1048 1049 1050 
##    2    2    2    1    1    1    1    1    1    1    1    1    1    1    1    1 
## 1051 1052 1053 1054 1055 1056 1057 1058 1059 1060 1061 1062 1064 1065 1066 1067 
##    3    1    3    1    1    1    1    2    2    2    2    1    3    2    2    1 
## 1068 1069 1070 1071 1072 1073 1074 1075 1076 1077 1078 1079 1080 1081 1082 1083 
##    1    1    1    3    1    3    2    3    3    1    1    1    1    2    1    2 
## 1084 1085 1086 1087 1088 1089 1090 1091 1092 1093 1094 1095 1096 1097 1098 1099 
##    1    1    1    1    1    1    1    1    1    1    1    1    1    1    1    1 
## 1100 1101 1102 1103 1104 1105 1106 1107 1108 1109 1110 1111 1112 1113 1114 1115 
##    1    1    2    1    2    2    1    2    1    1    3    1    1    1    1    1 
## 1116 1117 1118 1119 1120 1121 1122 1123 1124 1125 1126 1127 1128 1129 1130 1131 
##    1    1    1    1    3    3    2    3    1    2    1    1    1    1    3    3 
## 1132 1133 1134 1135 1136 1137 1138 1139 1140 1141 1142 1143 1144 1145 1146 1147 
##    3    1    1    3    1    3    3    3    3    3    1    1    1    1    1    1 
## 1148 1149 1150 1151 1152 1153 1154 1156 1157 1158 1160 1161 1162 1163 1164 1165 
##    1    1    1    1    2    1    1    2    1    2    1    1    1    2    2    2 
## 1166 1167 1168 1169 1170 1171 1172 1173 1174 1175 1176 1177 1178 1179 1180 1181 
##    1    3    3    2    2    2    3    1    3    3    2    1    2    1    3    1 
## 1182 1183 1184 1185 1186 1187 1188 1189 1190 1191 1192 1193 1194 1195 1196 1197 
##    2    1    1    2    1    1    2    2    2    3    3    2    1    3    1    3 
## 1198 1199 1200 1201 1202 1203 1204 1205 1207 1208 1209 1210 1211 1212 1213 1215 
##    1    1    1    1    1    1    2    2    1    2    1    1    1    1    1    1 
## 1216 1217 1218 1219 1220 1221 1222 1223 1224 1225 1226 1227 1228 1229 1230 1231 
##    1    2    1    1    1    1    2    1    2    1    1    2    1    2    3    3 
## 1232 1233 1234 1235 1236 1237 1238 1239 1240 1241 1242 1243 1244 1245 1246 1247 
##    3    3    3    3    2    2    1    1    2    1    1    1    2    2    2    1 
## 1248 1249 1250 1251 1252 1253 1254 1255 1256 1257 1258 1259 1260 1261 1262 1263 
##    1    1    2    1    3    1    3    1    1    3    3    3    3    3    1    1 
## 1264 1265 1266 1267 1268 1269 1270 1271 1272 1273 1274 1275 1276 1277 1278 1279 
##    1    1    2    1    2    1    1    1    3    3    2    1    1    3    1    1 
## 1280 1281 1282 1283 1284 1285 1286 1287 1288 1289 1290 1291 1292 1293 1294 1295 
##    1    1    2    2    2    2    1    2    2    2    1    1    1    1    1    1 
## 1296 1297 1298 1299 1300 1301 1302 1304 1305 1306 1307 1308 1309 1310 1311 1312 
##    2    2    2    1    1    1    1    2    2    2    2    1    1    1    1    1 
## 1313 1314 1315 1316 1317 1318 1319 1320 1321 1322 1323 1324 1325 1326 1327 1328 
##    1    2    1    1    2    1    1    1    1    2    1    1    1    2    1    2 
## 1329 1330 1331 1332 1333 1334 1335 1336 1337 1338 1339 1340 1341 1342 1343 1344 
##    2    2    2    3    2    3    1    2    3    3    3    1    1    1    1    1 
## 1345 1346 1347 1348 1349 1350 1351 1352 1353 1354 1355 1356 1357 1358 1359 1360 
##    2    1    1    1    1    1    1    1    1    1    1    1    1    1    1    1 
## 1361 1362 1363 1364 1365 1366 1367 1368 1369 1370 1371 1372 1373 1374 1375 1376 
##    1    1    1    1    1    1    1    1    2    1    1    3    3    2    2    3 
## 1377 1378 1379 1380 1381 1382 1383 1384 1385 1386 1387 1388 1389 1390 1391 1392 
##    3    3    3    3    2    1    1    3    1    3    1    2    2    2    2    2 
## 1393 1394 1395 1396 1397 1398 1400 1401 1402 1403 1404 1405 1406 1407 1408 1409 
##    2    2    2    3    2    3    1    3    2    3    2    2    1    1    2    1 
## 1410 1411 1412 1413 1414 1415 1416 1417 1418 1419 1420 1421 1422 1423 1424 1425 
##    2    1    2    1    1    2    2    2    2    1    2    1    2    2    2    2 
## 1426 1427 1429 1430 1431 1432 1433 1434 1435 1436 1437 1438 1439 1440 1441 1442 
##    2    1    3    3    3    3    2    3    3    1    2    2    2    2    2    2 
## 1443 1444 1445 1446 1447 1448 1449 1450 1451 1452 1453 1454 1455 1456 1457 1458 
##    1    2    2    2    2    2    2    2    3    2    1    1    2    2    1    1 
## 
## Within cluster sum of squares by cluster:
## [1] 413.2618 334.8595 334.4631
##  (between_SS / total_SS =  60.6 %)
## 
## Available components:
## 
##  [1] &quot;cluster&quot;      &quot;centers&quot;      &quot;totss&quot;        &quot;withinss&quot;     &quot;tot.withinss&quot;
##  [6] &quot;betweenss&quot;    &quot;size&quot;         &quot;iter&quot;         &quot;ifault&quot;       &quot;crit&quot;        
## [11] &quot;bestk&quot;</code></pre>
<p>Dont just pick an index that shows your solution but check out the next point that talks about the stability of the solution. There is not standard reporting of cluster analysis results in the psychological literature. Different authors report different things - but all are using some metrics to justify the choice of <em>k</em>, and to support why the chosen cluster solution is a good description of the data.</p>
</div>
<div id="obtaining-a-stable-solution" class="section level4 hasAnchor" number="14.8.6.2">
<h4><span class="header-section-number">14.8.6.2</span> Obtaining a Stable Solution<a href="14.8-applied-examples.html#obtaining-a-stable-solution" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Recall that k-means begins the iterations with a random cluster assignment. Different starting points may lead to different solutions. So, it may be useful to start many times to locate a stable solution. This is automated within the <code>kmeans()</code> function.</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="14.8-applied-examples.html#cb574-1" aria-hidden="true" tabindex="-1"></a><span class="co">#kmeans with nstart = 1</span></span>
<span id="cb574-2"><a href="14.8-applied-examples.html#cb574-2" aria-hidden="true" tabindex="-1"></a>km.res <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(dailyscale[,<span class="fu">c</span>(<span class="st">&quot;lteq&quot;</span>,<span class="st">&quot;posaff&quot;</span>)], <span class="at">centers=</span><span class="dv">4</span>, <span class="at">nstart =</span> <span class="dv">1</span>)</span>
<span id="cb574-3"><a href="14.8-applied-examples.html#cb574-3" aria-hidden="true" tabindex="-1"></a>km.res<span class="sc">$</span>tot.withinss</span></code></pre></div>
<pre><code>## [1] 887.3456</code></pre>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="14.8-applied-examples.html#cb576-1" aria-hidden="true" tabindex="-1"></a><span class="co">#kmeans with nstart = 25</span></span>
<span id="cb576-2"><a href="14.8-applied-examples.html#cb576-2" aria-hidden="true" tabindex="-1"></a>km.res <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(dailyscale[,<span class="fu">c</span>(<span class="st">&quot;lteq&quot;</span>,<span class="st">&quot;posaff&quot;</span>)], <span class="at">centers=</span><span class="dv">4</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb576-3"><a href="14.8-applied-examples.html#cb576-3" aria-hidden="true" tabindex="-1"></a>km.res<span class="sc">$</span>tot.withinss</span></code></pre></div>
<pre><code>## [1] 877.9312</code></pre>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="14.8-applied-examples.html#cb578-1" aria-hidden="true" tabindex="-1"></a><span class="co">#kmeans with nstart = 50</span></span>
<span id="cb578-2"><a href="14.8-applied-examples.html#cb578-2" aria-hidden="true" tabindex="-1"></a>km.res <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(dailyscale[,<span class="fu">c</span>(<span class="st">&quot;lteq&quot;</span>,<span class="st">&quot;posaff&quot;</span>)], <span class="at">centers=</span><span class="dv">4</span>, <span class="at">nstart =</span> <span class="dv">50</span>)</span>
<span id="cb578-3"><a href="14.8-applied-examples.html#cb578-3" aria-hidden="true" tabindex="-1"></a>km.res<span class="sc">$</span>tot.withinss</span></code></pre></div>
<pre><code>## [1] 877.9312</code></pre>
<p>The improvement can be seen over the single random start.</p>
<p>Recommended to do 25+ or 50 for stable solutions.</p>
<p><strong>Replication</strong></p>
<p>It may also be informative to repeat the procedure on randomly selected portions of the sample. If the cluster solution replicates in (random) subsets of the data - that would be strong evidence that the typology is pervasive and meaningful.</p>
</div>
<div id="after-clustering" class="section level4 hasAnchor" number="14.8.6.3">
<h4><span class="header-section-number">14.8.6.3</span> After Clustering<a href="14.8-applied-examples.html#after-clustering" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>After finding a suitable cluster solution, each individual is placed in a cluster. Formally, we obtain a vector of cluster assignments - a new categorical, grouping variable.</p>
<p>Whats next?</p>
<p>Well, we can both describe the clusters and use this new cluster variable in some other analysis - ANOVAs to test group differences, Chi-square tests, Multinomial regressions  the cluster variable can be used as a predictor, a correlate, an outcome (e.g., check whether those clusters are for example differ across personality variables etc.)</p>
</div>
<div id="describing-clusters" class="section level4 hasAnchor" number="14.8.6.4">
<h4><span class="header-section-number">14.8.6.4</span> Describing Clusters<a href="14.8-applied-examples.html#describing-clusters" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>First we merge the vector of cluster assignments back into the data set.</p>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="14.8-applied-examples.html#cb580-1" aria-hidden="true" tabindex="-1"></a>dailyscale.clus <span class="ot">&lt;-</span> <span class="fu">cbind</span>(km.res<span class="sc">$</span>cluster,dailyscale)</span>
<span id="cb580-2"><a href="14.8-applied-examples.html#cb580-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dailyscale.clus)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;cluster&quot;</span></span>
<span id="cb580-3"><a href="14.8-applied-examples.html#cb580-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dailyscale.clus[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">6</span>)],<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##   cluster   id     slphrs         weath        pss
## 1       2 1010 -0.6623479 -0.7732500468 -0.1732048
## 2       2 1011 -2.8774184 -0.0005615469  0.1923317
## 3       3 1012  0.9989549  0.7721269531  1.2889411
## 4       3 1013  0.1683035 -0.0005615469  0.5578682</code></pre>
<p>We can describe the different clusters - and potentially name the clusters.</p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="14.8-applied-examples.html#cb582-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>##  Attaching packages  tidyverse 1.3.1 </code></pre>
<pre><code>##  tibble  3.1.6      dplyr   1.0.7
##  tidyr   1.1.3      stringr 1.4.0
##  readr   1.4.0      forcats 0.5.1
##  purrr   0.3.4</code></pre>
<pre><code>##  Conflicts  tidyverse_conflicts() 
## x psych::%+%()       masks ggplot2::%+%()
## x psych::alpha()     masks ggplot2::alpha()
## x dplyr::arrange()   masks plyr::arrange()
## x dplyr::between()   masks data.table::between()
## x dplyr::collapse()  masks nlme::collapse()
## x purrr::compact()   masks plyr::compact()
## x dplyr::count()     masks plyr::count()
## x tidyr::expand()    masks reshape::expand(), Matrix::expand()
## x dplyr::failwith()  masks plyr::failwith()
## x dplyr::filter()    masks stats::filter()
## x dplyr::first()     masks data.table::first()
## x dplyr::id()        masks plyr::id()
## x dplyr::lag()       masks stats::lag()
## x dplyr::last()      masks data.table::last()
## x dplyr::mutate()    masks plyr::mutate()
## x tidyr::pack()      masks Matrix::pack()
## x dplyr::rename()    masks reshape::rename(), plyr::rename()
## x dplyr::summarise() masks plyr::summarise()
## x dplyr::summarize() masks plyr::summarize()
## x purrr::transpose() masks data.table::transpose()
## x tidyr::unpack()    masks Matrix::unpack()</code></pre>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb586-1"><a href="14.8-applied-examples.html#cb586-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gather the data to &#39;long&#39; format so the clustering variables are all in one column</span></span>
<span id="cb586-2"><a href="14.8-applied-examples.html#cb586-2" aria-hidden="true" tabindex="-1"></a><span class="co">#gather() has been replaced by pivot_longer()</span></span>
<span id="cb586-3"><a href="14.8-applied-examples.html#cb586-3" aria-hidden="true" tabindex="-1"></a>longdata <span class="ot">&lt;-</span> dailyscale.clus <span class="sc">%&gt;%</span></span>
<span id="cb586-4"><a href="14.8-applied-examples.html#cb586-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(lteq, posaff), <span class="at">names_to =</span> <span class="st">&quot;variable&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb586-5"><a href="14.8-applied-examples.html#cb586-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb586-6"><a href="14.8-applied-examples.html#cb586-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the summary statistics seperately for cluster and variable (i.e. lteq, posaff)</span></span>
<span id="cb586-7"><a href="14.8-applied-examples.html#cb586-7" aria-hidden="true" tabindex="-1"></a>summary <span class="ot">&lt;-</span> longdata <span class="sc">%&gt;%</span></span>
<span id="cb586-8"><a href="14.8-applied-examples.html#cb586-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">group_by</span>(cluster, variable) <span class="sc">%&gt;%</span></span>
<span id="cb586-9"><a href="14.8-applied-examples.html#cb586-9" aria-hidden="true" tabindex="-1"></a>             <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(value), <span class="at">se =</span> <span class="fu">sd</span>(value) <span class="sc">/</span> <span class="fu">length</span>(value))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;cluster&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="14.8-applied-examples.html#cb588-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb588-2"><a href="14.8-applied-examples.html#cb588-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> mean, <span class="at">fill =</span> variable)) <span class="sc">+</span> </span>
<span id="cb588-3"><a href="14.8-applied-examples.html#cb588-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>) <span class="sc">+</span></span>
<span id="cb588-4"><a href="14.8-applied-examples.html#cb588-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> se, <span class="at">ymax =</span> mean <span class="sc">+</span> se),                            </span>
<span id="cb588-5"><a href="14.8-applied-examples.html#cb588-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>,</span>
<span id="cb588-6"><a href="14.8-applied-examples.html#cb588-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb588-7"><a href="14.8-applied-examples.html#cb588-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>cluster) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-309-1.png" width="672" /></p>
<p>From this plot we can see the multivariate profile of each cluster - and use that to name the clusters. There can be some label switching, depending on random starting values, in terms of the cluster membership identifiers.</p>
<p>There are 4 profiles:</p>
<ul>
<li><p>Vigorous Exercisers</p></li>
<li><p>Happy Sedentary</p></li>
<li><p>Happy Exercisers</p></li>
<li><p>Unhappy Sedentary</p></li>
</ul>
</div>
<div id="analyzing-clusters" class="section level4 hasAnchor" number="14.8.6.5">
<h4><span class="header-section-number">14.8.6.5</span> Analyzing Clusters<a href="14.8-applied-examples.html#analyzing-clusters" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now that we have clusters = groups, we can analyze them. For example, we can take our 4-cluster solution and see if the clusters differ on another variable.</p>
<p>Lets see how the cluster groups differ on perceived stress (<code>pss</code>).</p>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="14.8-applied-examples.html#cb589-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(pss <span class="sc">~</span> <span class="fu">factor</span>(km.res<span class="sc">$</span>cluster), <span class="at">data=</span>dailyscale.clus)</span>
<span id="cb589-2"><a href="14.8-applied-examples.html#cb589-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code></pre></div>
<pre><code>##                          Df Sum Sq Mean Sq F value Pr(&gt;F)    
## factor(km.res$cluster)    3    247   82.35   100.2 &lt;2e-16 ***
## Residuals              1372   1128    0.82                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="14.8-applied-examples.html#cb591-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(fit1) </span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = pss ~ factor(km.res$cluster), data = dailyscale.clus)
## 
## $`factor(km.res$cluster)`
##             diff        lwr        upr     p adj
## 2-1 -0.937568465 -1.1029011 -0.7722358 0.0000000
## 3-1 -0.007666659 -0.1785830  0.1632497 0.9994508
## 4-1 -0.493702753 -0.7060229 -0.2813826 0.0000000
## 3-2  0.929901806  0.7681609  1.0916427 0.0000000
## 4-2  0.443865711  0.2388594  0.6488720 0.0000002
## 4-3 -0.486036094 -0.6955715 -0.2765007 0.0000000</code></pre>
<p>We see that clusters differ from each other on pss, except clusters 3 and 4 (or 3 and 2 if there was label switching).</p>
<p>Differences on <strong>non-clustering</strong> variables provide evidence that, indeed, the cluster solution is providing a meaningful distinction. The typology has value.</p>
<p>In sum, there are variety of ways to justify a cluster solution (e.g., selection of <em>k</em>)</p>
<ol style="list-style-type: decimal">
<li>Conceptual arguments<br />
</li>
<li>Internal statistical criteria<br />
</li>
<li>replication of clusters in random halves<br />
</li>
<li>cluster differentiation on external variables</li>
</ol>
<p><em>A practical benefit of subgroup-oriented interpretation emerges when considering potential interventions. Multivariate profiles may point toward tailoring diagnostic and intervention efforts to individual needs.</em></p>
</div>
</div>
<div id="hierarchical-clustering-2" class="section level3 hasAnchor" number="14.8.7">
<h3><span class="header-section-number">14.8.7</span> Hierarchical Clustering<a href="14.8-applied-examples.html#hierarchical-clustering-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>cluster</code> package provides a whole set of options  including both hierarchical and non-hierarchical methods.</p>
<p>Lets look at a hierarchical method - more explanations can be found here <a href="http://www.econ.upf.edu/~michael/stanford/maeb7.pdf" class="uri">http://www.econ.upf.edu/~michael/stanford/maeb7.pdf</a> .</p>
<p>Prelim: we make distance matrix (not totally necessary, but we do here for conceptual value)</p>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb593-1"><a href="14.8-applied-examples.html#cb593-1" aria-hidden="true" tabindex="-1"></a>dist.all <span class="ot">&lt;-</span> <span class="fu">daisy</span>(dailyscale[,<span class="fu">c</span>(<span class="st">&quot;lteq&quot;</span>,<span class="st">&quot;posaff&quot;</span>)],<span class="at">metric=</span><span class="st">&quot;euclidean&quot;</span>,<span class="at">stand=</span><span class="cn">FALSE</span>)</span>
<span id="cb593-2"><a href="14.8-applied-examples.html#cb593-2" aria-hidden="true" tabindex="-1"></a><span class="co">#loking at distances among first 5 persons</span></span>
<span id="cb593-3"><a href="14.8-applied-examples.html#cb593-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(dist.all)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>##            1          2         3         4         5
## 1 0.00000000 0.09088348 1.0906017 1.5479960 0.8493762
## 2 0.09088348 0.00000000 1.1814852 1.6387144 0.8920640
## 3 1.09060171 1.18148519 0.0000000 0.4644381 1.0573130
## 4 1.54799598 1.63871436 0.4644381 0.0000000 1.4634612
## 5 0.84937623 0.89206403 1.0573130 1.4634612 0.0000000</code></pre>
<p>Note that <code>daisy()</code> does include some treatments for missing data. Be careful!</p>
<p>Engage the hierarchical clustering  we use the <code>agnes()</code> (agglomerative nesting, aka hierarchical clustering, Wards method, ) function (which also allows for other linkage options)</p>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb595-1"><a href="14.8-applied-examples.html#cb595-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute Ward clusters </span></span>
<span id="cb595-2"><a href="14.8-applied-examples.html#cb595-2" aria-hidden="true" tabindex="-1"></a>clusterward.papa <span class="ot">&lt;-</span> <span class="fu">agnes</span>(dist.all, <span class="at">diss =</span> <span class="cn">TRUE</span>, <span class="at">method =</span> <span class="st">&quot;ward&quot;</span>)</span></code></pre></div>
<p>There are many choices for the <em>linkage method</em>. We have chosen Ward here, as a classic. Again, this is a well-trodden research area, and one can find recommendations of all types. Read widely to find the best for your specific purpose and data.</p>
<p>Then we visualize it!</p>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="14.8-applied-examples.html#cb596-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb596-2"><a href="14.8-applied-examples.html#cb596-2" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span>))</span>
<span id="cb596-3"><a href="14.8-applied-examples.html#cb596-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(clusterward.papa, <span class="at">which.plot =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">&quot;Ward clustering of PAPA&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-313-1.png" width="672" /></p>
<p>This is a <strong>Dendrogram</strong> (basically an organized plot of the distance matrix) that indicates how far apart objects are and when they might be merged together.
The y-axis indicates the distance between the clusters. Long vertical lines indicate that there is a lot of between-cluster distance. We determine a level at which to cut the tree. Generally we are looking for a level above which the lines are long (between-group heterogeneity) and below which the leaves are close (within-group homogeneity).</p>
<p>We see that 4 clusters seems to be a good tradeoff for parsimony.</p>
<p>Lets cut the tree and make cluster assignments.</p>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="14.8-applied-examples.html#cb597-1" aria-hidden="true" tabindex="-1"></a>wardcluster4 <span class="ot">&lt;-</span> <span class="fu">cutree</span>(clusterward.papa, <span class="at">k =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>And look at some statistical criteria</p>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="14.8-applied-examples.html#cb598-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cluster.stats</span>(dist.all, <span class="at">clustering=</span>wardcluster4,</span>
<span id="cb598-2"><a href="14.8-applied-examples.html#cb598-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">silhouette =</span> <span class="cn">TRUE</span>, <span class="at">sepindex =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## $n
## [1] 1376
## 
## $cluster.number
## [1] 4
## 
## $cluster.size
## [1] 437 443 229 267
## 
## $min.cluster.size
## [1] 229
## 
## $noisen
## [1] 0
## 
## $diameter
## [1] 4.710322 3.033785 4.361416 2.844837
## 
## $average.distance
## [1] 1.0705832 0.8725114 1.2911304 0.8755665
## 
## $median.distance
## [1] 0.9638540 0.8580223 1.2044112 0.8146296
## 
## $separation
## [1] 0.09088348 0.09088348 0.09088348 0.09088348
## 
## $average.toother
## [1] 1.778935 1.969837 2.398617 2.164384
## 
## $separation.matrix
##            [,1]       [,2]       [,3]       [,4]
## [1,] 0.00000000 0.09088348 0.09088348 0.09088348
## [2,] 0.09088348 0.00000000 0.09595597 0.09088348
## [3,] 0.09088348 0.09595597 0.00000000 1.65318945
## [4,] 0.09088348 0.09088348 1.65318945 0.00000000
## 
## $ave.between.matrix
##          [,1]     [,2]     [,3]     [,4]
## [1,] 0.000000 1.724896 2.024155 1.658275
## [2,] 1.724896 0.000000 2.268755 2.114358
## [3,] 2.024155 2.268755 0.000000 3.226963
## [4,] 1.658275 2.114358 3.226963 0.000000
## 
## $average.between
## [1] 2.036311
## 
## $average.within
## [1] 1.005678
## 
## $n.between
## [1] 691214
## 
## $n.within
## [1] 254786
## 
## $max.diameter
## [1] 4.710322
## 
## $min.separation
## [1] 0.09088348
## 
## $within.cluster.ss
## [1] 948.389
## 
## $clus.avg.silwidths
##         1         2         3         4 
## 0.1784037 0.4533402 0.2833088 0.4524960 
## 
## $avg.silwidth
## [1] 0.3375627
## 
## $g2
## NULL
## 
## $g3
## NULL
## 
## $pearsongamma
## [1] 0.4834923
## 
## $dunn
## [1] 0.01929453
## 
## $dunn2
## [1] 1.284359
## 
## $entropy
## [1] 1.345759
## 
## $wb.ratio
## [1] 0.4938724
## 
## $ch
## [1] 868.775
## 
## $cwidegap
## [1] 0.7249194 0.6166206 0.9088348 0.4544174
## 
## $widestgap
## [1] 0.9088348
## 
## $sindex
## [1] 0.1292593
## 
## $corrected.rand
## NULL
## 
## $vi
## NULL</code></pre>
</div>
<div id="two-step-approach" class="section level3 hasAnchor" number="14.8.8">
<h3><span class="header-section-number">14.8.8</span> Two-step Approach<a href="14.8-applied-examples.html#two-step-approach" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Often times, researchers are using a two-step approach </p>
<ol style="list-style-type: decimal">
<li>Hierarchical Wards method to <br />
evaluate optimal number of clusters<br />
produce starting seeds for subsequent step<br />
</li>
<li>Non-hierarchical k-means method to <br />
determine final case location in the separate subgroups</li>
</ol>
<p>The two-step approach circumvents some drawbacks of each procedure<br />
Wards method does not allow revising assigned membership in later steps tends to produce clusters of similar size
k-means method produces optimal clusters only if starting seeds are pre-specified</p>
<div id="k-medoids" class="section level4 hasAnchor" number="14.8.8.1">
<h4><span class="header-section-number">14.8.8.1</span> K-Medoids<a href="14.8-applied-examples.html#k-medoids" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>An alternative hierarchical clustering method  we use the <code>pam()</code> (partitioning around mediods) which is like k-means, but a bit more robust.</p>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="14.8-applied-examples.html#cb600-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute PAM clustering solution for k=4</span></span>
<span id="cb600-2"><a href="14.8-applied-examples.html#cb600-2" aria-hidden="true" tabindex="-1"></a>clusterpam.papa <span class="ot">&lt;-</span> <span class="fu">pam</span>(dist.all, <span class="at">k=</span><span class="dv">4</span>, <span class="at">diss =</span> <span class="cn">TRUE</span>)</span>
<span id="cb600-3"><a href="14.8-applied-examples.html#cb600-3" aria-hidden="true" tabindex="-1"></a>clusterpam.papa</span></code></pre></div>
<pre><code>## Medoids:
##      ID         
## [1,] &quot;129&quot; &quot;154&quot;
## [2,] &quot;108&quot; &quot;130&quot;
## [3,] &quot;676&quot; &quot;739&quot;
## [4,] &quot;233&quot; &quot;262&quot;
## Clustering vector:
##    1    2    3    4    5    6    7    9   10   11   13   14   15   17   18   19 
##    1    1    2    2    3    3    3    2    2    2    2    2    4    2    1    2 
##   20   21   22   23   27   28   29   30   31   32   37   38   39   40   41   42 
##    1    4    4    2    4    4    4    4    2    1    1    1    2    2    4    2 
##   43   44   47   48   49   51   52   53   54   55   56   57   58   59   60   61 
##    2    1    1    1    1    1    2    1    1    4    3    4    4    4    4    4 
##   62   63   64   66   67   68   70   71   72   73   74   75   76   77   78   79 
##    3    1    2    3    4    1    2    2    2    1    2    2    1    1    2    1 
##   81   84   85   86   87   88   89   90   91   92   93   95   96   97   98   99 
##    1    1    4    1    1    2    2    3    3    3    3    2    2    2    2    3 
##  101  102  103  105  106  107  108  110  111  112  113  114  115  116  117  118 
##    3    3    2    4    3    3    3    2    3    3    3    3    3    3    3    3 
##  119  120  121  122  123  124  125  126  127  128  129  130  131  132  133  134 
##    3    4    1    4    4    4    4    4    1    2    2    2    2    1    2    2 
##  135  136  137  138  140  141  143  144  145  146  147  149  150  151  152  153 
##    2    3    3    2    3    1    3    3    1    3    3    3    3    3    4    3 
##  154  155  156  157  158  159  160  161  162  163  164  165  166  167  168  169 
##    1    1    1    3    3    2    2    2    2    2    2    2    1    1    2    2 
##  170  171  172  173  174  175  176  177  178  179  180  181  182  183  184  185 
##    1    1    1    4    1    4    4    4    4    1    1    1    2    2    4    1 
##  186  187  188  189  190  191  192  193  194  196  197  198  199  201  202  203 
##    1    3    3    3    1    3    3    4    4    2    1    1    1    1    3    3 
##  204  205  206  208  209  210  211  212  213  214  215  216  217  218  219  220 
##    2    2    3    3    3    1    2    2    1    1    1    1    2    4    4    4 
##  221  222  223  224  225  226  228  229  230  231  232  233  234  235  236  237 
##    4    3    4    4    4    2    2    2    4    4    1    3    1    1    1    4 
##  238  239  240  241  242  243  244  245  246  247  248  249  250  251  252  253 
##    1    1    1    4    1    1    2    3    3    1    3    2    3    1    3    3 
##  254  255  256  257  258  259  260  261  262  263  264  265  266  267  268  269 
##    4    3    3    3    2    1    2    2    4    1    1    2    1    1    1    1 
##  270  271  272  273  274  275  276  277  278  279  280  281  282  283  285  286 
##    3    1    1    1    1    2    1    1    1    1    1    1    4    1    4    4 
##  287  288  289  290  291  292  293  294  295  296  297  298  299  300  301  302 
##    4    1    2    1    1    1    4    1    4    2    2    2    1    1    1    4 
##  303  304  305  306  307  308  309  312  313  314  315  316  317  318  319  320 
##    1    2    2    2    1    2    1    1    2    2    1    1    3    4    4    2 
##  321  323  324  325  326  327  328  329  330  331  332  333  334  335  343  344 
##    2    2    2    2    2    2    2    2    2    2    2    2    2    2    4    2 
##  345  346  347  348  349  350  352  353  354  355  356  358  359  360  361  364 
##    1    1    1    1    1    2    1    2    1    1    1    1    1    2    2    3 
##  365  366  367  368  369  370  371  372  373  374  376  377  378  379  380  381 
##    3    3    2    1    1    1    1    1    1    1    4    4    4    2    2    4 
##  382  383  384  385  386  387  388  389  390  391  392  393  394  395  396  397 
##    4    1    4    1    3    1    1    1    1    1    3    3    4    4    3    3 
##  398  399  400  401  402  403  404  405  406  407  408  409  410  411  412  413 
##    3    3    3    1    4    3    3    1    3    4    4    1    1    4    4    4 
##  414  415  416  417  418  419  422  423  424  425  426  427  428  429  430  431 
##    4    2    1    2    2    2    1    2    3    1    3    3    3    3    3    2 
##  432  433  434  435  436  437  438  439  441  442  443  444  445  446  447  448 
##    2    2    1    1    1    1    1    3    2    1    1    4    3    3    2    2 
##  449  450  451  452  453  454  455  456  457  458  459  460  461  462  463  464 
##    2    2    2    1    2    2    4    4    4    4    4    4    4    4    1    2 
##  465  466  467  468  469  470  471  472  473  474  475  476  477  478  479  480 
##    1    1    1    1    1    4    2    1    3    3    1    1    1    4    4    4 
##  481  483  485  486  487  488  489  490  491  492  493  494  495  496  497  498 
##    2    4    2    1    2    4    4    1    4    4    4    2    1    2    1    1 
##  499  500  501  502  503  504  505  506  507  508  509  510  511  512  513  514 
##    4    4    1    3    1    4    4    4    4    1    2    2    2    2    2    2 
##  515  516  517  518  519  520  521  522  523  524  525  526  527  528  529  530 
##    4    1    2    3    2    2    3    2    3    3    4    1    1    2    3    1 
##  531  533  534  535  536  537  538  539  540  541  542  543  544  545  546  548 
##    3    4    3    3    3    4    4    4    4    4    4    4    2    3    2    3 
##  549  550  551  552  553  554  555  556  557  558  559  560  561  562  563  564 
##    3    2    2    1    3    3    3    3    4    3    3    2    3    4    1    2 
##  565  566  567  568  569  570  571  572  573  574  575  576  577  578  579  580 
##    3    4    1    2    2    2    2    2    2    2    2    4    3    3    3    3 
##  581  582  583  584  585  586  587  588  589  590  591  592  593  594  595  596 
##    4    4    4    1    2    1    1    1    1    1    1    2    1    4    4    1 
##  597  598  599  601  602  603  604  605  606  607  609  610  611  612  613  614 
##    1    4    4    1    1    4    1    4    4    4    2    1    1    2    1    4 
##  615  616  617  618  619  620  621  622  623  624  625  626  628  629  630  631 
##    1    2    1    1    2    2    1    4    1    2    2    1    2    2    1    1 
##  632  633  634  635  636  637  638  639  640  641  642  643  644  645  646  647 
##    4    1    4    4    1    2    4    4    1    3    1    4    4    4    4    4 
##  648  649  650  651  652  653  654  655  656  657  658  659  660  661  662  663 
##    4    1    1    4    4    4    1    3    3    4    4    4    4    4    4    4 
##  664  665  666  667  668  669  670  671  672  673  674  675  676  677  678  679 
##    3    3    3    3    3    3    3    3    3    3    3    2    1    4    3    2 
##  680  681  682  684  685  686  687  688  689  690  691  692  693  694  696  697 
##    2    2    1    4    1    2    2    3    3    2    2    2    3    3    2    4 
##  698  699  700  701  702  703  704  705  706  707  708  709  710  711  712  713 
##    4    2    4    4    4    3    3    3    3    3    1    4    3    4    1    4 
##  714  715  716  717  719  720  721  722  723  724  725  726  727  728  731  735 
##    1    1    1    1    4    1    1    4    4    4    4    4    3    3    3    1 
##  736  737  738  739  740  741  742  743  744  745  746  747  748  749  750  751 
##    3    1    2    3    4    4    1    3    3    3    2    3    1    3    2    2 
##  752  753  754  755  757  758  759  760  761  762  763  764  765  766  767  768 
##    1    4    3    1    4    1    1    4    4    1    2    1    2    2    1    1 
##  769  770  771  772  773  774  775  776  777  778  779  780  781  782  783  784 
##    1    1    2    1    1    1    3    1    3    4    4    4    4    4    4    4 
##  785  786  787  788  789  790  791  792  793  794  795  796  797  798  799  800 
##    4    1    4    4    1    1    4    4    3    3    3    4    3    2    3    3 
##  801  802  803  804  805  806  807  808  809  810  811  812  813  814  815  816 
##    3    3    3    4    3    4    2    2    2    2    1    1    1    4    4    4 
##  817  819  820  821  822  823  824  825  826  827  828  829  830  831  832  833 
##    1    4    4    1    4    2    1    1    4    2    1    3    4    4    2    2 
##  834  835  836  837  838  839  840  841  842  843  844  845  846  847  848  849 
##    4    3    1    2    1    2    1    1    1    2    3    4    1    1    3    1 
##  850  851  852  853  854  855  856  857  858  859  860  861  862  863  864  866 
##    1    4    1    1    3    2    2    2    3    2    3    2    3    3    3    3 
##  867  868  869  871  872  873  874  875  876  877  878  879  880  881  882  883 
##    3    3    3    3    3    3    3    4    1    3    1    4    1    1    1    1 
##  884  885  886  887  888  889  890  891  892  893  894  895  896  897  898  899 
##    4    2    1    4    4    4    1    4    1    1    1    1    1    1    1    1 
##  900  901  902  903  904  905  906  907  908  909  910  911  912  913  914  915 
##    1    1    1    1    2    1    1    1    1    3    4    1    4    4    3    3 
##  916  917  918  919  920  921  922  923  924  925  926  927  928  929  930  931 
##    4    3    2    1    2    1    1    4    1    4    2    2    1    1    1    1 
##  932  933  934  935  936  937  938  940  942  943  944  945  946  947  948  949 
##    1    2    3    3    3    3    3    2    2    2    1    2    4    4    1    1 
##  950  951  952  953  956  957  958  959  960  961  962  963  964  965  966  967 
##    3    1    1    1    4    1    2    1    2    1    1    1    1    1    3    3 
##  968  969  970  971  972  973  974  976  977  978  979  980  982  983  984  985 
##    2    4    4    3    3    3    4    2    1    3    4    4    2    2    2    1 
##  986  987  988  989  990  991  992  993  994  995  996  997  998  999 1000 1001 
##    4    3    4    1    1    3    1    2    3    1    3    1    4    2    3    4 
## 1002 1003 1004 1005 1006 1007 1008 1009 1011 1012 1013 1014 1015 1016 1017 1018 
##    3    3    1    3    1    1    1    1    4    4    1    4    1    3    3    3 
## 1019 1020 1021 1022 1023 1024 1025 1026 1027 1028 1029 1030 1031 1032 1033 1034 
##    2    2    2    4    3    4    1    3    3    4    1    1    1    4    4    1 
## 1035 1036 1037 1038 1039 1040 1041 1042 1043 1044 1045 1046 1047 1048 1049 1050 
##    4    4    4    2    2    2    2    2    2    2    2    2    2    2    2    2 
## 1051 1052 1053 1054 1055 1056 1057 1058 1059 1060 1061 1062 1064 1065 1066 1067 
##    3    2    3    2    2    1    1    1    1    1    1    1    3    4    1    2 
## 1068 1069 1070 1071 1072 1073 1074 1075 1076 1077 1078 1079 1080 1081 1082 1083 
##    2    1    2    3    2    3    4    3    3    2    2    2    2    1    1    1 
## 1084 1085 1086 1087 1088 1089 1090 1091 1092 1093 1094 1095 1096 1097 1098 1099 
##    1    2    2    2    2    2    2    1    2    2    2    2    2    2    2    2 
## 1100 1101 1102 1103 1104 1105 1106 1107 1108 1109 1110 1111 1112 1113 1114 1115 
##    2    2    4    2    1    4    1    1    1    2    3    2    2    2    2    2 
## 1116 1117 1118 1119 1120 1121 1122 1123 1124 1125 1126 1127 1128 1129 1130 1131 
##    2    2    1    1    3    3    1    3    2    1    1    1    2    2    3    3 
## 1132 1133 1134 1135 1136 1137 1138 1139 1140 1141 1142 1143 1144 1145 1146 1147 
##    3    2    2    3    2    3    3    3    3    3    1    2    2    1    1    2 
## 1148 1149 1150 1151 1152 1153 1154 1156 1157 1158 1160 1161 1162 1163 1164 1165 
##    2    2    2    2    4    1    2    4    2    4    2    1    1    1    4    4 
## 1166 1167 1168 1169 1170 1171 1172 1173 1174 1175 1176 1177 1178 1179 1180 1181 
##    2    3    3    4    4    1    3    2    3    3    4    1    1    3    3    2 
## 1182 1183 1184 1185 1186 1187 1188 1189 1190 1191 1192 1193 1194 1195 1196 1197 
##    4    2    2    4    1    1    1    4    1    3    3    1    2    3    3    3 
## 1198 1199 1200 1201 1202 1203 1204 1205 1207 1208 1209 1210 1211 1212 1213 1215 
##    1    2    2    2    1    2    4    1    2    4    2    1    2    2    2    1 
## 1216 1217 1218 1219 1220 1221 1222 1223 1224 1225 1226 1227 1228 1229 1230 1231 
##    1    1    2    2    1    2    4    1    1    2    2    1    1    4    3    3 
## 1232 1233 1234 1235 1236 1237 1238 1239 1240 1241 1242 1243 1244 1245 1246 1247 
##    3    3    3    3    4    4    2    2    1    2    2    1    4    4    1    1 
## 1248 1249 1250 1251 1252 1253 1254 1255 1256 1257 1258 1259 1260 1261 1262 1263 
##    2    3    4    2    3    1    3    2    2    3    3    3    3    3    2    1 
## 1264 1265 1266 1267 1268 1269 1270 1271 1272 1273 1274 1275 1276 1277 1278 1279 
##    2    2    1    1    4    1    2    1    3    3    4    1    2    3    2    2 
## 1280 1281 1282 1283 1284 1285 1286 1287 1288 1289 1290 1291 1292 1293 1294 1295 
##    1    2    1    4    1    1    1    1    4    4    1    1    2    2    2    2 
## 1296 1297 1298 1299 1300 1301 1302 1304 1305 1306 1307 1308 1309 1310 1311 1312 
##    4    4    4    2    1    2    2    1    4    4    4    2    1    1    1    2 
## 1313 1314 1315 1316 1317 1318 1319 1320 1321 1322 1323 1324 1325 1326 1327 1328 
##    1    1    2    1    4    2    1    2    1    4    1    2    1    4    1    4 
## 1329 1330 1331 1332 1333 1334 1335 1336 1337 1338 1339 1340 1341 1342 1343 1344 
##    4    4    1    3    4    3    2    1    3    3    4    2    2    2    2    2 
## 1345 1346 1347 1348 1349 1350 1351 1352 1353 1354 1355 1356 1357 1358 1359 1360 
##    1    1    2    2    2    2    2    2    2    2    1    2    2    2    2    2 
## 1361 1362 1363 1364 1365 1366 1367 1368 1369 1370 1371 1372 1373 1374 1375 1376 
##    1    2    2    2    2    2    2    2    4    2    2    3    3    1    4    3 
## 1377 1378 1379 1380 1381 1382 1383 1384 1385 1386 1387 1388 1389 1390 1391 1392 
##    3    3    3    3    1    2    2    3    2    3    2    1    4    4    4    4 
## 1393 1394 1395 1396 1397 1398 1400 1401 1402 1403 1404 1405 1406 1407 1408 1409 
##    4    4    4    3    4    3    2    3    4    3    4    1    1    2    4    1 
## 1410 1411 1412 1413 1414 1415 1416 1417 1418 1419 1420 1421 1422 1423 1424 1425 
##    1    1    1    2    2    4    1    1    4    1    1    2    1    4    4    4 
## 1426 1427 1429 1430 1431 1432 1433 1434 1435 1436 1437 1438 1439 1440 1441 1442 
##    4    1    3    3    3    3    4    3    3    1    1    4    4    4    1    4 
## 1443 1444 1445 1446 1447 1448 1449 1450 1451 1452 1453 1454 1455 1456 1457 1458 
##    1    1    4    4    4    4    4    1    3    1    2    2    4    4    1    1 
## Objective function:
##     build      swap 
## 0.7176465 0.7049830 
## 
## Available components:
## [1] &quot;medoids&quot;    &quot;id.med&quot;     &quot;clustering&quot; &quot;objective&quot;  &quot;isolation&quot; 
## [6] &quot;clusinfo&quot;   &quot;silinfo&quot;    &quot;diss&quot;       &quot;call&quot;</code></pre>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="14.8-applied-examples.html#cb602-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking length</span></span>
<span id="cb602-2"><a href="14.8-applied-examples.html#cb602-2" aria-hidden="true" tabindex="-1"></a>pamcluster <span class="ot">&lt;-</span> clusterpam.papa<span class="sc">$</span>clustering</span>
<span id="cb602-3"><a href="14.8-applied-examples.html#cb602-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(pamcluster)</span></code></pre></div>
<pre><code>## [1] 1376</code></pre>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="14.8-applied-examples.html#cb604-1" aria-hidden="true" tabindex="-1"></a><span class="co">#binding to originaldata</span></span>
<span id="cb604-2"><a href="14.8-applied-examples.html#cb604-2" aria-hidden="true" tabindex="-1"></a>dailyscale.pam <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dailyscale,pamcluster)</span>
<span id="cb604-3"><a href="14.8-applied-examples.html#cb604-3" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting clustered data points </span></span>
<span id="cb604-4"><a href="14.8-applied-examples.html#cb604-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dailyscale.pam,<span class="fu">aes</span>(<span class="at">x=</span>lteq,<span class="at">y=</span>posaff)) <span class="sc">+</span></span>
<span id="cb604-5"><a href="14.8-applied-examples.html#cb604-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span>.<span class="dv">6</span>, <span class="at">color=</span><span class="fu">factor</span>(pamcluster))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-316-1.png" width="672" /></p>
<p>Lets run the autosearch and see what comes out </p>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="14.8-applied-examples.html#cb605-1" aria-hidden="true" tabindex="-1"></a>pamauto <span class="ot">&lt;-</span> <span class="fu">pamk</span>(dist.all,<span class="at">krange=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>,<span class="at">criterion=</span><span class="st">&quot;asw&quot;</span>, <span class="at">usepam=</span><span class="cn">TRUE</span>,</span>
<span id="cb605-2"><a href="14.8-applied-examples.html#cb605-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">scaling=</span><span class="cn">FALSE</span>, <span class="at">alpha=</span><span class="fl">0.001</span>, <span class="at">diss=</span><span class="cn">TRUE</span>,</span>
<span id="cb605-3"><a href="14.8-applied-examples.html#cb605-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">critout=</span><span class="cn">FALSE</span>, <span class="at">ns=</span><span class="dv">10</span>, <span class="at">seed=</span><span class="cn">NULL</span>)</span>
<span id="cb605-4"><a href="14.8-applied-examples.html#cb605-4" aria-hidden="true" tabindex="-1"></a>pamauto</span></code></pre></div>
<pre><code>## $pamobject
## Medoids:
##      ID         
## [1,] &quot;598&quot; &quot;653&quot;
## [2,] &quot;63&quot;  &quot;78&quot; 
## [3,] &quot;738&quot; &quot;802&quot;
## Clustering vector:
##    1    2    3    4    5    6    7    9   10   11   13   14   15   17   18   19 
##    1    1    2    2    3    3    3    2    2    2    2    2    1    2    2    2 
##   20   21   22   23   27   28   29   30   31   32   37   38   39   40   41   42 
##    1    1    1    2    1    1    1    1    2    2    2    2    2    2    1    2 
##   43   44   47   48   49   51   52   53   54   55   56   57   58   59   60   61 
##    2    1    2    2    2    2    2    2    2    1    3    1    1    1    1    1 
##   62   63   64   66   67   68   70   71   72   73   74   75   76   77   78   79 
##    3    2    3    3    1    3    2    2    2    2    2    2    2    1    2    3 
##   81   84   85   86   87   88   89   90   91   92   93   95   96   97   98   99 
##    2    1    1    1    2    2    2    3    3    3    3    2    2    2    2    3 
##  101  102  103  105  106  107  108  110  111  112  113  114  115  116  117  118 
##    3    3    2    1    3    3    3    2    3    3    3    3    3    3    3    3 
##  119  120  121  122  123  124  125  126  127  128  129  130  131  132  133  134 
##    3    1    1    1    1    1    1    1    1    2    2    2    2    2    2    2 
##  135  136  137  138  140  141  143  144  145  146  147  149  150  151  152  153 
##    2    3    3    2    3    3    3    3    3    3    3    3    3    3    1    3 
##  154  155  156  157  158  159  160  161  162  163  164  165  166  167  168  169 
##    2    2    2    3    3    2    2    2    2    2    2    2    2    1    2    2 
##  170  171  172  173  174  175  176  177  178  179  180  181  182  183  184  185 
##    1    2    3    1    1    1    1    1    1    1    1    2    3    3    1    3 
##  186  187  188  189  190  191  192  193  194  196  197  198  199  201  202  203 
##    2    3    3    3    1    3    3    1    1    2    2    2    2    3    3    3 
##  204  205  206  208  209  210  211  212  213  214  215  216  217  218  219  220 
##    2    2    3    3    3    2    2    2    2    2    2    1    2    1    1    1 
##  221  222  223  224  225  226  228  229  230  231  232  233  234  235  236  237 
##    1    3    1    1    3    2    2    2    1    1    2    3    2    2    1    1 
##  238  239  240  241  242  243  244  245  246  247  248  249  250  251  252  253 
##    2    1    1    1    3    2    2    3    3    2    3    2    3    1    3    3 
##  254  255  256  257  258  259  260  261  262  263  264  265  266  267  268  269 
##    1    3    3    3    2    2    2    2    1    2    2    2    2    1    2    1 
##  270  271  272  273  274  275  276  277  278  279  280  281  282  283  285  286 
##    3    2    2    2    2    2    1    1    1    2    1    1    1    1    1    1 
##  287  288  289  290  291  292  293  294  295  296  297  298  299  300  301  302 
##    1    1    2    1    1    1    1    1    1    2    2    2    1    1    2    1 
##  303  304  305  306  307  308  309  312  313  314  315  316  317  318  319  320 
##    3    2    2    2    2    2    1    2    2    2    2    3    3    1    1    2 
##  321  323  324  325  326  327  328  329  330  331  332  333  334  335  343  344 
##    2    2    2    2    2    2    2    3    2    2    2    2    2    2    1    2 
##  345  346  347  348  349  350  352  353  354  355  356  358  359  360  361  364 
##    1    2    1    2    2    2    2    2    2    1    1    1    1    2    3    3 
##  365  366  367  368  369  370  371  372  373  374  376  377  378  379  380  381 
##    3    3    2    2    2    2    3    2    2    3    1    1    1    2    2    1 
##  382  383  384  385  386  387  388  389  390  391  392  393  394  395  396  397 
##    1    2    3    2    3    2    2    1    1    3    3    3    1    1    3    3 
##  398  399  400  401  402  403  404  405  406  407  408  409  410  411  412  413 
##    3    3    3    1    1    3    3    1    3    1    1    1    2    1    1    1 
##  414  415  416  417  418  419  422  423  424  425  426  427  428  429  430  431 
##    1    2    2    2    2    2    1    2    3    3    3    3    3    3    3    2 
##  432  433  434  435  436  437  438  439  441  442  443  444  445  446  447  448 
##    2    2    2    2    3    1    1    3    2    2    3    1    3    3    2    2 
##  449  450  451  452  453  454  455  456  457  458  459  460  461  462  463  464 
##    2    2    2    2    2    2    1    1    1    1    3    1    1    1    2    2 
##  465  466  467  468  469  470  471  472  473  474  475  476  477  478  479  480 
##    1    1    2    2    2    1    2    2    3    3    2    1    1    1    1    1 
##  481  483  485  486  487  488  489  490  491  492  493  494  495  496  497  498 
##    2    1    2    2    2    1    1    1    1    1    1    2    1    2    1    1 
##  499  500  501  502  503  504  505  506  507  508  509  510  511  512  513  514 
##    1    1    2    3    1    1    1    1    1    2    2    2    2    2    2    2 
##  515  516  517  518  519  520  521  522  523  524  525  526  527  528  529  530 
##    1    1    3    3    2    2    3    2    3    3    1    1    1    2    3    3 
##  531  533  534  535  536  537  538  539  540  541  542  543  544  545  546  548 
##    3    1    3    3    3    1    1    1    1    1    1    1    2    3    2    3 
##  549  550  551  552  553  554  555  556  557  558  559  560  561  562  563  564 
##    3    3    3    2    3    3    3    3    1    3    3    2    3    1    1    2 
##  565  566  567  568  569  570  571  572  573  574  575  576  577  578  579  580 
##    3    1    1    2    2    2    2    2    2    2    2    1    3    3    3    3 
##  581  582  583  584  585  586  587  588  589  590  591  592  593  594  595  596 
##    1    1    1    1    2    2    1    1    2    1    1    2    1    1    1    2 
##  597  598  599  601  602  603  604  605  606  607  609  610  611  612  613  614 
##    1    1    1    2    1    1    2    1    1    1    2    2    2    2    1    1 
##  615  616  617  618  619  620  621  622  623  624  625  626  628  629  630  631 
##    2    2    2    2    2    2    1    1    1    2    2    2    2    2    2    2 
##  632  633  634  635  636  637  638  639  640  641  642  643  644  645  646  647 
##    1    1    1    1    1    2    1    1    2    3    2    1    1    1    1    1 
##  648  649  650  651  652  653  654  655  656  657  658  659  660  661  662  663 
##    1    2    1    1    1    1    3    3    3    1    1    1    1    1    1    1 
##  664  665  666  667  668  669  670  671  672  673  674  675  676  677  678  679 
##    3    3    3    3    3    3    3    3    3    3    3    2    2    1    3    2 
##  680  681  682  684  685  686  687  688  689  690  691  692  693  694  696  697 
##    2    2    2    1    1    2    2    3    3    2    2    2    3    3    2    1 
##  698  699  700  701  702  703  704  705  706  707  708  709  710  711  712  713 
##    1    2    1    1    1    3    3    3    3    3    1    1    3    1    1    1 
##  714  715  716  717  719  720  721  722  723  724  725  726  727  728  731  735 
##    2    1    1    1    1    1    3    1    1    1    1    1    3    3    3    2 
##  736  737  738  739  740  741  742  743  744  745  746  747  748  749  750  751 
##    3    2    3    3    1    1    3    3    3    3    2    3    1    3    2    2 
##  752  753  754  755  757  758  759  760  761  762  763  764  765  766  767  768 
##    1    1    3    2    1    2    1    1    1    2    2    1    2    2    2    2 
##  769  770  771  772  773  774  775  776  777  778  779  780  781  782  783  784 
##    2    1    2    2    1    1    3    1    3    1    1    1    1    1    1    1 
##  785  786  787  788  789  790  791  792  793  794  795  796  797  798  799  800 
##    1    1    1    1    2    2    1    1    3    3    3    1    3    2    3    3 
##  801  802  803  804  805  806  807  808  809  810  811  812  813  814  815  816 
##    3    3    3    1    3    1    2    2    2    2    2    2    2    1    1    1 
##  817  819  820  821  822  823  824  825  826  827  828  829  830  831  832  833 
##    2    1    1    1    1    2    2    2    1    2    1    3    1    1    2    2 
##  834  835  836  837  838  839  840  841  842  843  844  845  846  847  848  849 
##    1    3    1    3    2    2    1    2    2    2    3    1    1    1    3    2 
##  850  851  852  853  854  855  856  857  858  859  860  861  862  863  864  866 
##    2    1    2    1    3    2    2    3    3    2    3    2    3    3    3    3 
##  867  868  869  871  872  873  874  875  876  877  878  879  880  881  882  883 
##    3    3    3    3    3    3    3    1    1    3    1    1    2    1    2    1 
##  884  885  886  887  888  889  890  891  892  893  894  895  896  897  898  899 
##    1    2    2    1    1    1    2    1    2    2    2    3    2    2    1    2 
##  900  901  902  903  904  905  906  907  908  909  910  911  912  913  914  915 
##    2    2    2    2    2    1    1    1    2    3    1    3    1    1    3    3 
##  916  917  918  919  920  921  922  923  924  925  926  927  928  929  930  931 
##    1    3    2    3    3    3    1    1    2    1    2    2    1    2    2    2 
##  932  933  934  935  936  937  938  940  942  943  944  945  946  947  948  949 
##    1    2    3    3    3    3    3    2    2    2    2    2    1    1    1    2 
##  950  951  952  953  956  957  958  959  960  961  962  963  964  965  966  967 
##    3    3    2    1    1    1    2    2    2    1    1    1    1    2    3    3 
##  968  969  970  971  972  973  974  976  977  978  979  980  982  983  984  985 
##    2    1    1    3    3    3    1    2    2    3    1    1    2    2    2    1 
##  986  987  988  989  990  991  992  993  994  995  996  997  998  999 1000 1001 
##    1    3    1    1    3    3    2    2    3    3    3    1    1    3    3    1 
## 1002 1003 1004 1005 1006 1007 1008 1009 1011 1012 1013 1014 1015 1016 1017 1018 
##    3    3    3    3    1    2    2    2    1    1    2    1    3    3    3    3 
## 1019 1020 1021 1022 1023 1024 1025 1026 1027 1028 1029 1030 1031 1032 1033 1034 
##    2    2    2    1    3    1    3    3    3    1    2    1    1    1    1    1 
## 1035 1036 1037 1038 1039 1040 1041 1042 1043 1044 1045 1046 1047 1048 1049 1050 
##    1    1    1    2    2    2    2    2    2    2    2    3    2    2    2    2 
## 1051 1052 1053 1054 1055 1056 1057 1058 1059 1060 1061 1062 1064 1065 1066 1067 
##    3    2    3    2    2    2    2    1    1    1    1    3    3    1    3    3 
## 1068 1069 1070 1071 1072 1073 1074 1075 1076 1077 1078 1079 1080 1081 1082 1083 
##    2    3    2    3    2    3    1    3    3    3    2    2    2    1    2    1 
## 1084 1085 1086 1087 1088 1089 1090 1091 1092 1093 1094 1095 1096 1097 1098 1099 
##    2    2    2    2    2    2    2    2    2    2    2    2    2    2    2    2 
## 1100 1101 1102 1103 1104 1105 1106 1107 1108 1109 1110 1111 1112 1113 1114 1115 
##    2    2    1    2    1    1    2    1    2    2    3    2    3    2    2    2 
## 1116 1117 1118 1119 1120 1121 1122 1123 1124 1125 1126 1127 1128 1129 1130 1131 
##    2    2    2    3    3    3    1    3    2    1    2    2    3    2    3    3 
## 1132 1133 1134 1135 1136 1137 1138 1139 1140 1141 1142 1143 1144 1145 1146 1147 
##    3    2    2    3    2    3    3    3    3    3    2    2    2    3    2    2 
## 1148 1149 1150 1151 1152 1153 1154 1156 1157 1158 1160 1161 1162 1163 1164 1165 
##    2    2    2    2    1    2    2    1    2    1    2    2    2    1    1    1 
## 1166 1167 1168 1169 1170 1171 1172 1173 1174 1175 1176 1177 1178 1179 1180 1181 
##    2    3    3    1    1    1    3    2    3    3    1    2    1    3    3    3 
## 1182 1183 1184 1185 1186 1187 1188 1189 1190 1191 1192 1193 1194 1195 1196 1197 
##    1    2    2    1    2    3    3    1    1    3    3    1    3    3    3    3 
## 1198 1199 1200 1201 1202 1203 1204 1205 1207 1208 1209 1210 1211 1212 1213 1215 
##    2    2    2    2    2    2    1    1    2    1    2    2    2    2    2    2 
## 1216 1217 1218 1219 1220 1221 1222 1223 1224 1225 1226 1227 1228 1229 1230 1231 
##    2    1    2    2    2    2    1    2    1    2    2    1    2    1    3    3 
## 1232 1233 1234 1235 1236 1237 1238 1239 1240 1241 1242 1243 1244 1245 1246 1247 
##    3    3    3    3    1    1    2    2    1    2    2    2    1    1    1    2 
## 1248 1249 1250 1251 1252 1253 1254 1255 1256 1257 1258 1259 1260 1261 1262 1263 
##    2    3    1    2    3    2    3    3    2    3    3    3    3    3    2    2 
## 1264 1265 1266 1267 1268 1269 1270 1271 1272 1273 1274 1275 1276 1277 1278 1279 
##    2    2    3    2    1    2    2    3    3    3    1    2    3    3    2    2 
## 1280 1281 1282 1283 1284 1285 1286 1287 1288 1289 1290 1291 1292 1293 1294 1295 
##    2    2    1    1    1    1    2    1    1    1    2    2    2    2    2    2 
## 1296 1297 1298 1299 1300 1301 1302 1304 1305 1306 1307 1308 1309 1310 1311 1312 
##    1    1    1    2    2    2    2    1    1    1    1    2    2    2    2    2 
## 1313 1314 1315 1316 1317 1318 1319 1320 1321 1322 1323 1324 1325 1326 1327 1328 
##    2    1    2    2    1    2    2    2    2    1    2    2    2    1    2    1 
## 1329 1330 1331 1332 1333 1334 1335 1336 1337 1338 1339 1340 1341 1342 1343 1344 
##    1    1    1    3    1    3    2    3    3    3    3    2    2    2    2    2 
## 1345 1346 1347 1348 1349 1350 1351 1352 1353 1354 1355 1356 1357 1358 1359 1360 
##    1    2    2    2    2    2    2    2    2    2    2    2    2    2    2    2 
## 1361 1362 1363 1364 1365 1366 1367 1368 1369 1370 1371 1372 1373 1374 1375 1376 
##    2    2    2    2    2    2    2    2    1    2    2    3    3    1    1    3 
## 1377 1378 1379 1380 1381 1382 1383 1384 1385 1386 1387 1388 1389 1390 1391 1392 
##    3    3    3    3    1    2    2    3    3    3    3    1    1    1    1    1 
## 1393 1394 1395 1396 1397 1398 1400 1401 1402 1403 1404 1405 1406 1407 1408 1409 
##    1    1    1    3    1    3    2    3    1    3    1    1    2    2    1    2 
## 1410 1411 1412 1413 1414 1415 1416 1417 1418 1419 1420 1421 1422 1423 1424 1425 
##    3    2    1    2    2    1    1    1    1    2    1    2    1    1    1    1 
## 1426 1427 1429 1430 1431 1432 1433 1434 1435 1436 1437 1438 1439 1440 1441 1442 
##    1    2    3    3    3    3    1    3    3    2    1    1    1    1    1    1 
## 1443 1444 1445 1446 1447 1448 1449 1450 1451 1452 1453 1454 1455 1456 1457 1458 
##    2    1    1    1    1    1    1    1    3    1    2    2    1    1    2    2 
## Objective function:
##     build      swap 
## 0.8498193 0.7869947 
## 
## Available components:
## [1] &quot;medoids&quot;    &quot;id.med&quot;     &quot;clustering&quot; &quot;objective&quot;  &quot;isolation&quot; 
## [6] &quot;clusinfo&quot;   &quot;silinfo&quot;    &quot;diss&quot;       &quot;call&quot;      
## 
## $nc
## [1] 3
## 
## $crit
##  [1] 0.0000000 0.3345128 0.3808428 0.3165995 0.3264280 0.3362667 0.3489111
##  [8] 0.3348566 0.3340303 0.3330956</code></pre>
<p>Here, the suggestion is for <em>k</em> = 3. Only three clusters.</p>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="14.8-applied-examples.html#cb607-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Obtain medoids</span></span>
<span id="cb607-2"><a href="14.8-applied-examples.html#cb607-2" aria-hidden="true" tabindex="-1"></a>pamauto<span class="sc">$</span>pamobject<span class="sc">$</span>id.med</span></code></pre></div>
<pre><code>## [1] 598  63 738</code></pre>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="14.8-applied-examples.html#cb609-1" aria-hidden="true" tabindex="-1"></a><span class="co">#binding new cluster assignment to originaldata</span></span>
<span id="cb609-2"><a href="14.8-applied-examples.html#cb609-2" aria-hidden="true" tabindex="-1"></a>dailyscale.pam<span class="sc">$</span>pamnew <span class="ot">&lt;-</span> pamauto<span class="sc">$</span>pamobject<span class="sc">$</span>clustering</span>
<span id="cb609-3"><a href="14.8-applied-examples.html#cb609-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb609-4"><a href="14.8-applied-examples.html#cb609-4" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting clustered data points with the medoids</span></span>
<span id="cb609-5"><a href="14.8-applied-examples.html#cb609-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dailyscale.pam,<span class="fu">aes</span>(<span class="at">x=</span>lteq,<span class="at">y=</span>posaff)) <span class="sc">+</span></span>
<span id="cb609-6"><a href="14.8-applied-examples.html#cb609-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span>.<span class="dv">6</span>, <span class="at">color=</span><span class="fu">factor</span>(dailyscale.pam<span class="sc">$</span>pamnew)) <span class="sc">+</span></span>
<span id="cb609-7"><a href="14.8-applied-examples.html#cb609-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>dailyscale.pam[<span class="dv">598</span>,],<span class="fu">aes</span>(<span class="at">x=</span>lteq,<span class="at">y=</span>posaff),<span class="at">color=</span><span class="dv">2</span>,<span class="at">size=</span><span class="dv">5</span>,<span class="at">shape=</span><span class="dv">18</span>) <span class="sc">+</span></span>
<span id="cb609-8"><a href="14.8-applied-examples.html#cb609-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>dailyscale.pam[<span class="dv">63</span>,],<span class="fu">aes</span>(<span class="at">x=</span>lteq,<span class="at">y=</span>posaff),<span class="at">color=</span><span class="dv">1</span>,<span class="at">size=</span><span class="dv">5</span>,<span class="at">shape=</span><span class="dv">18</span>) <span class="sc">+</span></span>
<span id="cb609-9"><a href="14.8-applied-examples.html#cb609-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>dailyscale.pam[<span class="dv">738</span>,],<span class="fu">aes</span>(<span class="at">x=</span>lteq,<span class="at">y=</span>posaff),<span class="at">color=</span><span class="dv">4</span>,<span class="at">size=</span><span class="dv">5</span>,<span class="at">shape=</span><span class="dv">18</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-318-1.png" width="672" /></p>
<p>Now we have a zone to play in.</p>
</div>
</div>
<div id="final-thoughts" class="section level3 hasAnchor" number="14.8.9">
<h3><span class="header-section-number">14.8.9</span> Final Thoughts<a href="14.8-applied-examples.html#final-thoughts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Please remember the usual caution. Our intention here has been simple exposure. When using these methods for a paper or project, do the research necessary to engage the method precisely and with good form.</strong></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="14.7-issues-in-clustering.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="14.9-reference-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/zackfisher/HDFS523/edit/master/14_cluster_analysis.Rmd",
"text": "Suggest an edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
